(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Jv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ng={exports:{}},Jl={},bg={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uo=Symbol.for("react.element"),Zv=Symbol.for("react.portal"),ew=Symbol.for("react.fragment"),tw=Symbol.for("react.strict_mode"),nw=Symbol.for("react.profiler"),rw=Symbol.for("react.provider"),sw=Symbol.for("react.context"),iw=Symbol.for("react.forward_ref"),ow=Symbol.for("react.suspense"),aw=Symbol.for("react.memo"),lw=Symbol.for("react.lazy"),Yf=Symbol.iterator;function cw(t){return t===null||typeof t!="object"?null:(t=Yf&&t[Yf]||t["@@iterator"],typeof t=="function"?t:null)}var Sg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Cg=Object.assign,Eg={};function mi(t,e,n){this.props=t,this.context=e,this.refs=Eg,this.updater=n||Sg}mi.prototype.isReactComponent={};mi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};mi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kg(){}kg.prototype=mi.prototype;function qd(t,e,n){this.props=t,this.context=e,this.refs=Eg,this.updater=n||Sg}var Gd=qd.prototype=new kg;Gd.constructor=qd;Cg(Gd,mi.prototype);Gd.isPureReactComponent=!0;var Xf=Array.isArray,jg=Object.prototype.hasOwnProperty,Kd={current:null},Tg={key:!0,ref:!0,__self:!0,__source:!0};function Pg(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)jg.call(e,r)&&!Tg.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Uo,type:t,key:i,ref:a,props:s,_owner:Kd.current}}function uw(t,e){return{$$typeof:Uo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qd(t){return typeof t=="object"&&t!==null&&t.$$typeof===Uo}function dw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Jf=/\/+/g;function Fc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?dw(""+t.key):e.toString(36)}function Ia(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Uo:case Zv:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Fc(a,0):r,Xf(s)?(n="",t!=null&&(n=t.replace(Jf,"$&/")+"/"),Ia(s,e,n,"",function(u){return u})):s!=null&&(Qd(s)&&(s=uw(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Jf,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Xf(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Fc(i,l);a+=Ia(i,e,n,c,s)}else if(c=cw(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Fc(i,l++),a+=Ia(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function la(t,e,n){if(t==null)return t;var r=[],s=0;return Ia(t,r,"","",function(i){return e.call(n,i,s++)}),r}function hw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Et={current:null},Ra={transition:null},fw={ReactCurrentDispatcher:Et,ReactCurrentBatchConfig:Ra,ReactCurrentOwner:Kd};function Ig(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:la,forEach:function(t,e,n){la(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return la(t,function(){e++}),e},toArray:function(t){return la(t,function(e){return e})||[]},only:function(t){if(!Qd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};de.Component=mi;de.Fragment=ew;de.Profiler=nw;de.PureComponent=qd;de.StrictMode=tw;de.Suspense=ow;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fw;de.act=Ig;de.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Cg({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Kd.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)jg.call(e,c)&&!Tg.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Uo,type:t.type,key:s,ref:i,props:r,_owner:a}};de.createContext=function(t){return t={$$typeof:sw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:rw,_context:t},t.Consumer=t};de.createElement=Pg;de.createFactory=function(t){var e=Pg.bind(null,t);return e.type=t,e};de.createRef=function(){return{current:null}};de.forwardRef=function(t){return{$$typeof:iw,render:t}};de.isValidElement=Qd;de.lazy=function(t){return{$$typeof:lw,_payload:{_status:-1,_result:t},_init:hw}};de.memo=function(t,e){return{$$typeof:aw,type:t,compare:e===void 0?null:e}};de.startTransition=function(t){var e=Ra.transition;Ra.transition={};try{t()}finally{Ra.transition=e}};de.unstable_act=Ig;de.useCallback=function(t,e){return Et.current.useCallback(t,e)};de.useContext=function(t){return Et.current.useContext(t)};de.useDebugValue=function(){};de.useDeferredValue=function(t){return Et.current.useDeferredValue(t)};de.useEffect=function(t,e){return Et.current.useEffect(t,e)};de.useId=function(){return Et.current.useId()};de.useImperativeHandle=function(t,e,n){return Et.current.useImperativeHandle(t,e,n)};de.useInsertionEffect=function(t,e){return Et.current.useInsertionEffect(t,e)};de.useLayoutEffect=function(t,e){return Et.current.useLayoutEffect(t,e)};de.useMemo=function(t,e){return Et.current.useMemo(t,e)};de.useReducer=function(t,e,n){return Et.current.useReducer(t,e,n)};de.useRef=function(t){return Et.current.useRef(t)};de.useState=function(t){return Et.current.useState(t)};de.useSyncExternalStore=function(t,e,n){return Et.current.useSyncExternalStore(t,e,n)};de.useTransition=function(){return Et.current.useTransition()};de.version="18.3.1";bg.exports=de;var x=bg.exports;const Rg=Jv(x);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pw=x,mw=Symbol.for("react.element"),gw=Symbol.for("react.fragment"),yw=Object.prototype.hasOwnProperty,xw=pw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_w={key:!0,ref:!0,__self:!0,__source:!0};function Ag(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)yw.call(e,r)&&!_w.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:mw,type:t,key:i,ref:a,props:s,_owner:xw.current}}Jl.Fragment=gw;Jl.jsx=Ag;Jl.jsxs=Ag;Ng.exports=Jl;var o=Ng.exports,Dg={exports:{}},Vt={},Lg={exports:{}},Og={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(E,H){var M=E.length;E.push(H);e:for(;0<M;){var fe=M-1>>>1,D=E[fe];if(0<s(D,H))E[fe]=H,E[M]=D,M=fe;else break e}}function n(E){return E.length===0?null:E[0]}function r(E){if(E.length===0)return null;var H=E[0],M=E.pop();if(M!==H){E[0]=M;e:for(var fe=0,D=E.length,jt=D>>>1;fe<jt;){var O=2*(fe+1)-1,U=E[O],$=O+1,Ne=E[$];if(0>s(U,M))$<D&&0>s(Ne,U)?(E[fe]=Ne,E[$]=M,fe=$):(E[fe]=U,E[O]=M,fe=O);else if($<D&&0>s(Ne,M))E[fe]=Ne,E[$]=M,fe=$;else break e}}return H}function s(E,H){var M=E.sortIndex-H.sortIndex;return M!==0?M:E.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,y=!1,_=!1,v=!1,S=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(E){for(var H=n(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=E)r(u),H.sortIndex=H.expirationTime,e(c,H);else break;H=n(u)}}function w(E){if(v=!1,m(E),!_)if(n(c)!==null)_=!0,Le(N);else{var H=n(u);H!==null&&Q(w,H.startTime-E)}}function N(E,H){_=!1,v&&(v=!1,g(T),T=-1),y=!0;var M=f;try{for(m(H),h=n(c);h!==null&&(!(h.expirationTime>H)||E&&!G());){var fe=h.callback;if(typeof fe=="function"){h.callback=null,f=h.priorityLevel;var D=fe(h.expirationTime<=H);H=t.unstable_now(),typeof D=="function"?h.callback=D:h===n(c)&&r(c),m(H)}else r(c);h=n(c)}if(h!==null)var jt=!0;else{var O=n(u);O!==null&&Q(w,O.startTime-H),jt=!1}return jt}finally{h=null,f=M,y=!1}}var C=!1,k=null,T=-1,R=5,I=-1;function G(){return!(t.unstable_now()-I<R)}function re(){if(k!==null){var E=t.unstable_now();I=E;var H=!0;try{H=k(!0,E)}finally{H?ne():(C=!1,k=null)}}else C=!1}var ne;if(typeof p=="function")ne=function(){p(re)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,K=ge.port2;ge.port1.onmessage=re,ne=function(){K.postMessage(null)}}else ne=function(){S(re,0)};function Le(E){k=E,C||(C=!0,ne())}function Q(E,H){T=S(function(){E(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(E){E.callback=null},t.unstable_continueExecution=function(){_||y||(_=!0,Le(N))},t.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<E?Math.floor(1e3/E):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(E){switch(f){case 1:case 2:case 3:var H=3;break;default:H=f}var M=f;f=H;try{return E()}finally{f=M}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(E,H){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var M=f;f=E;try{return H()}finally{f=M}},t.unstable_scheduleCallback=function(E,H,M){var fe=t.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?fe+M:fe):M=fe,E){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=M+D,E={id:d++,callback:H,priorityLevel:E,startTime:M,expirationTime:D,sortIndex:-1},M>fe?(E.sortIndex=M,e(u,E),n(c)===null&&E===n(u)&&(v?(g(T),T=-1):v=!0,Q(w,M-fe))):(E.sortIndex=D,e(c,E),_||y||(_=!0,Le(N))),E},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(E){var H=f;return function(){var M=f;f=H;try{return E.apply(this,arguments)}finally{f=M}}}})(Og);Lg.exports=Og;var vw=Lg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ww=x,Wt=vw;function P(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mg=new Set,uo={};function ys(t,e){Js(t,e),Js(t+"Capture",e)}function Js(t,e){for(uo[t]=e,t=0;t<e.length;t++)Mg.add(e[t])}var qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Eu=Object.prototype.hasOwnProperty,Nw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zf={},ep={};function bw(t){return Eu.call(ep,t)?!0:Eu.call(Zf,t)?!1:Nw.test(t)?ep[t]=!0:(Zf[t]=!0,!1)}function Sw(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Cw(t,e,n,r){if(e===null||typeof e>"u"||Sw(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function kt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){dt[t]=new kt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];dt[e]=new kt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){dt[t]=new kt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){dt[t]=new kt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){dt[t]=new kt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){dt[t]=new kt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){dt[t]=new kt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){dt[t]=new kt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){dt[t]=new kt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Yd=/[\-:]([a-z])/g;function Xd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Yd,Xd);dt[e]=new kt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Yd,Xd);dt[e]=new kt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Yd,Xd);dt[e]=new kt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){dt[t]=new kt(t,1,!1,t.toLowerCase(),null,!1,!1)});dt.xlinkHref=new kt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){dt[t]=new kt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Jd(t,e,n,r){var s=dt.hasOwnProperty(e)?dt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Cw(e,n,s,r)&&(n=null),r||s===null?bw(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var nr=ww.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ca=Symbol.for("react.element"),ks=Symbol.for("react.portal"),js=Symbol.for("react.fragment"),Zd=Symbol.for("react.strict_mode"),ku=Symbol.for("react.profiler"),Fg=Symbol.for("react.provider"),$g=Symbol.for("react.context"),eh=Symbol.for("react.forward_ref"),ju=Symbol.for("react.suspense"),Tu=Symbol.for("react.suspense_list"),th=Symbol.for("react.memo"),ar=Symbol.for("react.lazy"),Ug=Symbol.for("react.offscreen"),tp=Symbol.iterator;function Ti(t){return t===null||typeof t!="object"?null:(t=tp&&t[tp]||t["@@iterator"],typeof t=="function"?t:null)}var He=Object.assign,$c;function Hi(t){if($c===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);$c=e&&e[1]||""}return`
`+$c+t}var Uc=!1;function zc(t,e){if(!t||Uc)return"";Uc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{Uc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Hi(t):""}function Ew(t){switch(t.tag){case 5:return Hi(t.type);case 16:return Hi("Lazy");case 13:return Hi("Suspense");case 19:return Hi("SuspenseList");case 0:case 2:case 15:return t=zc(t.type,!1),t;case 11:return t=zc(t.type.render,!1),t;case 1:return t=zc(t.type,!0),t;default:return""}}function Pu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case js:return"Fragment";case ks:return"Portal";case ku:return"Profiler";case Zd:return"StrictMode";case ju:return"Suspense";case Tu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case $g:return(t.displayName||"Context")+".Consumer";case Fg:return(t._context.displayName||"Context")+".Provider";case eh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case th:return e=t.displayName||null,e!==null?e:Pu(t.type)||"Memo";case ar:e=t._payload,t=t._init;try{return Pu(t(e))}catch{}}return null}function kw(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pu(e);case 8:return e===Zd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ar(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function zg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function jw(t){var e=zg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ua(t){t._valueTracker||(t._valueTracker=jw(t))}function Bg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=zg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ja(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Iu(t,e){var n=e.checked;return He({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function np(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ar(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Hg(t,e){e=e.checked,e!=null&&Jd(t,"checked",e,!1)}function Ru(t,e){Hg(t,e);var n=Ar(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Au(t,e.type,n):e.hasOwnProperty("defaultValue")&&Au(t,e.type,Ar(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Au(t,e,n){(e!=="number"||Ja(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Wi=Array.isArray;function zs(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ar(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Du(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(P(91));return He({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function sp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(P(92));if(Wi(n)){if(1<n.length)throw Error(P(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ar(n)}}function Wg(t,e){var n=Ar(e.value),r=Ar(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ip(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Vg(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Vg(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var da,qg=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(da=da||document.createElement("div"),da.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=da.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ho(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ki={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tw=["Webkit","ms","Moz","O"];Object.keys(Ki).forEach(function(t){Tw.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ki[e]=Ki[t]})});function Gg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ki.hasOwnProperty(t)&&Ki[t]?(""+e).trim():e+"px"}function Kg(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Gg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Pw=He({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ou(t,e){if(e){if(Pw[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(P(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(P(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(P(61))}if(e.style!=null&&typeof e.style!="object")throw Error(P(62))}}function Mu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fu=null;function nh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $u=null,Bs=null,Hs=null;function op(t){if(t=Ho(t)){if(typeof $u!="function")throw Error(P(280));var e=t.stateNode;e&&(e=rc(e),$u(t.stateNode,t.type,e))}}function Qg(t){Bs?Hs?Hs.push(t):Hs=[t]:Bs=t}function Yg(){if(Bs){var t=Bs,e=Hs;if(Hs=Bs=null,op(t),e)for(t=0;t<e.length;t++)op(e[t])}}function Xg(t,e){return t(e)}function Jg(){}var Bc=!1;function Zg(t,e,n){if(Bc)return t(e,n);Bc=!0;try{return Xg(t,e,n)}finally{Bc=!1,(Bs!==null||Hs!==null)&&(Jg(),Yg())}}function fo(t,e){var n=t.stateNode;if(n===null)return null;var r=rc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(P(231,e,typeof n));return n}var Uu=!1;if(qn)try{var Pi={};Object.defineProperty(Pi,"passive",{get:function(){Uu=!0}}),window.addEventListener("test",Pi,Pi),window.removeEventListener("test",Pi,Pi)}catch{Uu=!1}function Iw(t,e,n,r,s,i,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Qi=!1,Za=null,el=!1,zu=null,Rw={onError:function(t){Qi=!0,Za=t}};function Aw(t,e,n,r,s,i,a,l,c){Qi=!1,Za=null,Iw.apply(Rw,arguments)}function Dw(t,e,n,r,s,i,a,l,c){if(Aw.apply(this,arguments),Qi){if(Qi){var u=Za;Qi=!1,Za=null}else throw Error(P(198));el||(el=!0,zu=u)}}function xs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function e0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ap(t){if(xs(t)!==t)throw Error(P(188))}function Lw(t){var e=t.alternate;if(!e){if(e=xs(t),e===null)throw Error(P(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return ap(s),t;if(i===r)return ap(s),e;i=i.sibling}throw Error(P(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(P(189))}}if(n.alternate!==r)throw Error(P(190))}if(n.tag!==3)throw Error(P(188));return n.stateNode.current===n?t:e}function t0(t){return t=Lw(t),t!==null?n0(t):null}function n0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=n0(t);if(e!==null)return e;t=t.sibling}return null}var r0=Wt.unstable_scheduleCallback,lp=Wt.unstable_cancelCallback,Ow=Wt.unstable_shouldYield,Mw=Wt.unstable_requestPaint,Qe=Wt.unstable_now,Fw=Wt.unstable_getCurrentPriorityLevel,rh=Wt.unstable_ImmediatePriority,s0=Wt.unstable_UserBlockingPriority,tl=Wt.unstable_NormalPriority,$w=Wt.unstable_LowPriority,i0=Wt.unstable_IdlePriority,Zl=null,bn=null;function Uw(t){if(bn&&typeof bn.onCommitFiberRoot=="function")try{bn.onCommitFiberRoot(Zl,t,void 0,(t.current.flags&128)===128)}catch{}}var mn=Math.clz32?Math.clz32:Hw,zw=Math.log,Bw=Math.LN2;function Hw(t){return t>>>=0,t===0?32:31-(zw(t)/Bw|0)|0}var ha=64,fa=4194304;function Vi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function nl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Vi(l):(i&=a,i!==0&&(r=Vi(i)))}else a=n&~s,a!==0?r=Vi(a):i!==0&&(r=Vi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-mn(e),s=1<<n,r|=t[n],e&=~s;return r}function Ww(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vw(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-mn(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=Ww(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Bu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function o0(){var t=ha;return ha<<=1,!(ha&4194240)&&(ha=64),t}function Hc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function zo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mn(e),t[e]=n}function qw(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-mn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function sh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-mn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var _e=0;function a0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var l0,ih,c0,u0,d0,Hu=!1,pa=[],_r=null,vr=null,wr=null,po=new Map,mo=new Map,cr=[],Gw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cp(t,e){switch(t){case"focusin":case"focusout":_r=null;break;case"dragenter":case"dragleave":vr=null;break;case"mouseover":case"mouseout":wr=null;break;case"pointerover":case"pointerout":po.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":mo.delete(e.pointerId)}}function Ii(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ho(e),e!==null&&ih(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Kw(t,e,n,r,s){switch(e){case"focusin":return _r=Ii(_r,t,e,n,r,s),!0;case"dragenter":return vr=Ii(vr,t,e,n,r,s),!0;case"mouseover":return wr=Ii(wr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return po.set(i,Ii(po.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,mo.set(i,Ii(mo.get(i)||null,t,e,n,r,s)),!0}return!1}function h0(t){var e=Zr(t.target);if(e!==null){var n=xs(e);if(n!==null){if(e=n.tag,e===13){if(e=e0(n),e!==null){t.blockedOn=e,d0(t.priority,function(){c0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Aa(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Wu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Fu=r,n.target.dispatchEvent(r),Fu=null}else return e=Ho(n),e!==null&&ih(e),t.blockedOn=n,!1;e.shift()}return!0}function up(t,e,n){Aa(t)&&n.delete(e)}function Qw(){Hu=!1,_r!==null&&Aa(_r)&&(_r=null),vr!==null&&Aa(vr)&&(vr=null),wr!==null&&Aa(wr)&&(wr=null),po.forEach(up),mo.forEach(up)}function Ri(t,e){t.blockedOn===e&&(t.blockedOn=null,Hu||(Hu=!0,Wt.unstable_scheduleCallback(Wt.unstable_NormalPriority,Qw)))}function go(t){function e(s){return Ri(s,t)}if(0<pa.length){Ri(pa[0],t);for(var n=1;n<pa.length;n++){var r=pa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(_r!==null&&Ri(_r,t),vr!==null&&Ri(vr,t),wr!==null&&Ri(wr,t),po.forEach(e),mo.forEach(e),n=0;n<cr.length;n++)r=cr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<cr.length&&(n=cr[0],n.blockedOn===null);)h0(n),n.blockedOn===null&&cr.shift()}var Ws=nr.ReactCurrentBatchConfig,rl=!0;function Yw(t,e,n,r){var s=_e,i=Ws.transition;Ws.transition=null;try{_e=1,oh(t,e,n,r)}finally{_e=s,Ws.transition=i}}function Xw(t,e,n,r){var s=_e,i=Ws.transition;Ws.transition=null;try{_e=4,oh(t,e,n,r)}finally{_e=s,Ws.transition=i}}function oh(t,e,n,r){if(rl){var s=Wu(t,e,n,r);if(s===null)Zc(t,e,r,sl,n),cp(t,r);else if(Kw(s,t,e,n,r))r.stopPropagation();else if(cp(t,r),e&4&&-1<Gw.indexOf(t)){for(;s!==null;){var i=Ho(s);if(i!==null&&l0(i),i=Wu(t,e,n,r),i===null&&Zc(t,e,r,sl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Zc(t,e,r,null,n)}}var sl=null;function Wu(t,e,n,r){if(sl=null,t=nh(r),t=Zr(t),t!==null)if(e=xs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=e0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return sl=t,null}function f0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Fw()){case rh:return 1;case s0:return 4;case tl:case $w:return 16;case i0:return 536870912;default:return 16}default:return 16}}var gr=null,ah=null,Da=null;function p0(){if(Da)return Da;var t,e=ah,n=e.length,r,s="value"in gr?gr.value:gr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Da=s.slice(t,1<r?1-r:void 0)}function La(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ma(){return!0}function dp(){return!1}function qt(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ma:dp,this.isPropagationStopped=dp,this}return He(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ma)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ma)},persist:function(){},isPersistent:ma}),e}var gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lh=qt(gi),Bo=He({},gi,{view:0,detail:0}),Jw=qt(Bo),Wc,Vc,Ai,ec=He({},Bo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ch,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ai&&(Ai&&t.type==="mousemove"?(Wc=t.screenX-Ai.screenX,Vc=t.screenY-Ai.screenY):Vc=Wc=0,Ai=t),Wc)},movementY:function(t){return"movementY"in t?t.movementY:Vc}}),hp=qt(ec),Zw=He({},ec,{dataTransfer:0}),e1=qt(Zw),t1=He({},Bo,{relatedTarget:0}),qc=qt(t1),n1=He({},gi,{animationName:0,elapsedTime:0,pseudoElement:0}),r1=qt(n1),s1=He({},gi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),i1=qt(s1),o1=He({},gi,{data:0}),fp=qt(o1),a1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},l1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},c1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=c1[t])?!!e[t]:!1}function ch(){return u1}var d1=He({},Bo,{key:function(t){if(t.key){var e=a1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=La(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?l1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ch,charCode:function(t){return t.type==="keypress"?La(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?La(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),h1=qt(d1),f1=He({},ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pp=qt(f1),p1=He({},Bo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ch}),m1=qt(p1),g1=He({},gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),y1=qt(g1),x1=He({},ec,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),_1=qt(x1),v1=[9,13,27,32],uh=qn&&"CompositionEvent"in window,Yi=null;qn&&"documentMode"in document&&(Yi=document.documentMode);var w1=qn&&"TextEvent"in window&&!Yi,m0=qn&&(!uh||Yi&&8<Yi&&11>=Yi),mp=" ",gp=!1;function g0(t,e){switch(t){case"keyup":return v1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function y0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ts=!1;function N1(t,e){switch(t){case"compositionend":return y0(e);case"keypress":return e.which!==32?null:(gp=!0,mp);case"textInput":return t=e.data,t===mp&&gp?null:t;default:return null}}function b1(t,e){if(Ts)return t==="compositionend"||!uh&&g0(t,e)?(t=p0(),Da=ah=gr=null,Ts=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return m0&&e.locale!=="ko"?null:e.data;default:return null}}var S1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!S1[t.type]:e==="textarea"}function x0(t,e,n,r){Qg(r),e=il(e,"onChange"),0<e.length&&(n=new lh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xi=null,yo=null;function C1(t){T0(t,0)}function tc(t){var e=Rs(t);if(Bg(e))return t}function E1(t,e){if(t==="change")return e}var _0=!1;if(qn){var Gc;if(qn){var Kc="oninput"in document;if(!Kc){var xp=document.createElement("div");xp.setAttribute("oninput","return;"),Kc=typeof xp.oninput=="function"}Gc=Kc}else Gc=!1;_0=Gc&&(!document.documentMode||9<document.documentMode)}function _p(){Xi&&(Xi.detachEvent("onpropertychange",v0),yo=Xi=null)}function v0(t){if(t.propertyName==="value"&&tc(yo)){var e=[];x0(e,yo,t,nh(t)),Zg(C1,e)}}function k1(t,e,n){t==="focusin"?(_p(),Xi=e,yo=n,Xi.attachEvent("onpropertychange",v0)):t==="focusout"&&_p()}function j1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return tc(yo)}function T1(t,e){if(t==="click")return tc(e)}function P1(t,e){if(t==="input"||t==="change")return tc(e)}function I1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xn=typeof Object.is=="function"?Object.is:I1;function xo(t,e){if(xn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Eu.call(e,s)||!xn(t[s],e[s]))return!1}return!0}function vp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function wp(t,e){var n=vp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=vp(n)}}function w0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?w0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function N0(){for(var t=window,e=Ja();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ja(t.document)}return e}function dh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function R1(t){var e=N0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&w0(n.ownerDocument.documentElement,n)){if(r!==null&&dh(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=wp(n,i);var a=wp(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var A1=qn&&"documentMode"in document&&11>=document.documentMode,Ps=null,Vu=null,Ji=null,qu=!1;function Np(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qu||Ps==null||Ps!==Ja(r)||(r=Ps,"selectionStart"in r&&dh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ji&&xo(Ji,r)||(Ji=r,r=il(Vu,"onSelect"),0<r.length&&(e=new lh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ps)))}function ga(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Is={animationend:ga("Animation","AnimationEnd"),animationiteration:ga("Animation","AnimationIteration"),animationstart:ga("Animation","AnimationStart"),transitionend:ga("Transition","TransitionEnd")},Qc={},b0={};qn&&(b0=document.createElement("div").style,"AnimationEvent"in window||(delete Is.animationend.animation,delete Is.animationiteration.animation,delete Is.animationstart.animation),"TransitionEvent"in window||delete Is.transitionend.transition);function nc(t){if(Qc[t])return Qc[t];if(!Is[t])return t;var e=Is[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in b0)return Qc[t]=e[n];return t}var S0=nc("animationend"),C0=nc("animationiteration"),E0=nc("animationstart"),k0=nc("transitionend"),j0=new Map,bp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $r(t,e){j0.set(t,e),ys(e,[t])}for(var Yc=0;Yc<bp.length;Yc++){var Xc=bp[Yc],D1=Xc.toLowerCase(),L1=Xc[0].toUpperCase()+Xc.slice(1);$r(D1,"on"+L1)}$r(S0,"onAnimationEnd");$r(C0,"onAnimationIteration");$r(E0,"onAnimationStart");$r("dblclick","onDoubleClick");$r("focusin","onFocus");$r("focusout","onBlur");$r(k0,"onTransitionEnd");Js("onMouseEnter",["mouseout","mouseover"]);Js("onMouseLeave",["mouseout","mouseover"]);Js("onPointerEnter",["pointerout","pointerover"]);Js("onPointerLeave",["pointerout","pointerover"]);ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ys("onBeforeInput",["compositionend","keypress","textInput","paste"]);ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O1=new Set("cancel close invalid load scroll toggle".split(" ").concat(qi));function Sp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Dw(r,e,void 0,t),t.currentTarget=null}function T0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Sp(s,l,u),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Sp(s,l,u),i=c}}}if(el)throw t=zu,el=!1,zu=null,t}function Te(t,e){var n=e[Xu];n===void 0&&(n=e[Xu]=new Set);var r=t+"__bubble";n.has(r)||(P0(e,t,2,!1),n.add(r))}function Jc(t,e,n){var r=0;e&&(r|=4),P0(n,t,r,e)}var ya="_reactListening"+Math.random().toString(36).slice(2);function _o(t){if(!t[ya]){t[ya]=!0,Mg.forEach(function(n){n!=="selectionchange"&&(O1.has(n)||Jc(n,!1,t),Jc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ya]||(e[ya]=!0,Jc("selectionchange",!1,e))}}function P0(t,e,n,r){switch(f0(e)){case 1:var s=Yw;break;case 4:s=Xw;break;default:s=oh}n=s.bind(null,e,n,t),s=void 0,!Uu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Zc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Zr(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}Zg(function(){var u=i,d=nh(n),h=[];e:{var f=j0.get(t);if(f!==void 0){var y=lh,_=t;switch(t){case"keypress":if(La(n)===0)break e;case"keydown":case"keyup":y=h1;break;case"focusin":_="focus",y=qc;break;case"focusout":_="blur",y=qc;break;case"beforeblur":case"afterblur":y=qc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=e1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=m1;break;case S0:case C0:case E0:y=r1;break;case k0:y=y1;break;case"scroll":y=Jw;break;case"wheel":y=_1;break;case"copy":case"cut":case"paste":y=i1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=pp}var v=(e&4)!==0,S=!v&&t==="scroll",g=v?f!==null?f+"Capture":null:f;v=[];for(var p=u,m;p!==null;){m=p;var w=m.stateNode;if(m.tag===5&&w!==null&&(m=w,g!==null&&(w=fo(p,g),w!=null&&v.push(vo(p,w,m)))),S)break;p=p.return}0<v.length&&(f=new y(f,_,null,n,d),h.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",f&&n!==Fu&&(_=n.relatedTarget||n.fromElement)&&(Zr(_)||_[Gn]))break e;if((y||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,y?(_=n.relatedTarget||n.toElement,y=u,_=_?Zr(_):null,_!==null&&(S=xs(_),_!==S||_.tag!==5&&_.tag!==6)&&(_=null)):(y=null,_=u),y!==_)){if(v=hp,w="onMouseLeave",g="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(v=pp,w="onPointerLeave",g="onPointerEnter",p="pointer"),S=y==null?f:Rs(y),m=_==null?f:Rs(_),f=new v(w,p+"leave",y,n,d),f.target=S,f.relatedTarget=m,w=null,Zr(d)===u&&(v=new v(g,p+"enter",_,n,d),v.target=m,v.relatedTarget=S,w=v),S=w,y&&_)t:{for(v=y,g=_,p=0,m=v;m;m=Ss(m))p++;for(m=0,w=g;w;w=Ss(w))m++;for(;0<p-m;)v=Ss(v),p--;for(;0<m-p;)g=Ss(g),m--;for(;p--;){if(v===g||g!==null&&v===g.alternate)break t;v=Ss(v),g=Ss(g)}v=null}else v=null;y!==null&&Cp(h,f,y,v,!1),_!==null&&S!==null&&Cp(h,S,_,v,!0)}}e:{if(f=u?Rs(u):window,y=f.nodeName&&f.nodeName.toLowerCase(),y==="select"||y==="input"&&f.type==="file")var N=E1;else if(yp(f))if(_0)N=P1;else{N=j1;var C=k1}else(y=f.nodeName)&&y.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(N=T1);if(N&&(N=N(t,u))){x0(h,N,n,d);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Au(f,"number",f.value)}switch(C=u?Rs(u):window,t){case"focusin":(yp(C)||C.contentEditable==="true")&&(Ps=C,Vu=u,Ji=null);break;case"focusout":Ji=Vu=Ps=null;break;case"mousedown":qu=!0;break;case"contextmenu":case"mouseup":case"dragend":qu=!1,Np(h,n,d);break;case"selectionchange":if(A1)break;case"keydown":case"keyup":Np(h,n,d)}var k;if(uh)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Ts?g0(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(m0&&n.locale!=="ko"&&(Ts||T!=="onCompositionStart"?T==="onCompositionEnd"&&Ts&&(k=p0()):(gr=d,ah="value"in gr?gr.value:gr.textContent,Ts=!0)),C=il(u,T),0<C.length&&(T=new fp(T,t,null,n,d),h.push({event:T,listeners:C}),k?T.data=k:(k=y0(n),k!==null&&(T.data=k)))),(k=w1?N1(t,n):b1(t,n))&&(u=il(u,"onBeforeInput"),0<u.length&&(d=new fp("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=k))}T0(h,e)})}function vo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function il(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=fo(t,n),i!=null&&r.unshift(vo(t,i,s)),i=fo(t,e),i!=null&&r.push(vo(t,i,s))),t=t.return}return r}function Ss(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Cp(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=fo(n,i),c!=null&&a.unshift(vo(n,c,l))):s||(c=fo(n,i),c!=null&&a.push(vo(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var M1=/\r\n?/g,F1=/\u0000|\uFFFD/g;function Ep(t){return(typeof t=="string"?t:""+t).replace(M1,`
`).replace(F1,"")}function xa(t,e,n){if(e=Ep(e),Ep(t)!==e&&n)throw Error(P(425))}function ol(){}var Gu=null,Ku=null;function Qu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Yu=typeof setTimeout=="function"?setTimeout:void 0,$1=typeof clearTimeout=="function"?clearTimeout:void 0,kp=typeof Promise=="function"?Promise:void 0,U1=typeof queueMicrotask=="function"?queueMicrotask:typeof kp<"u"?function(t){return kp.resolve(null).then(t).catch(z1)}:Yu;function z1(t){setTimeout(function(){throw t})}function eu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),go(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);go(e)}function Nr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function jp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var yi=Math.random().toString(36).slice(2),Nn="__reactFiber$"+yi,wo="__reactProps$"+yi,Gn="__reactContainer$"+yi,Xu="__reactEvents$"+yi,B1="__reactListeners$"+yi,H1="__reactHandles$"+yi;function Zr(t){var e=t[Nn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Gn]||n[Nn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=jp(t);t!==null;){if(n=t[Nn])return n;t=jp(t)}return e}t=n,n=t.parentNode}return null}function Ho(t){return t=t[Nn]||t[Gn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Rs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(P(33))}function rc(t){return t[wo]||null}var Ju=[],As=-1;function Ur(t){return{current:t}}function Pe(t){0>As||(t.current=Ju[As],Ju[As]=null,As--)}function ke(t,e){As++,Ju[As]=t.current,t.current=e}var Dr={},yt=Ur(Dr),Ot=Ur(!1),os=Dr;function Zs(t,e){var n=t.type.contextTypes;if(!n)return Dr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Mt(t){return t=t.childContextTypes,t!=null}function al(){Pe(Ot),Pe(yt)}function Tp(t,e,n){if(yt.current!==Dr)throw Error(P(168));ke(yt,e),ke(Ot,n)}function I0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(P(108,kw(t)||"Unknown",s));return He({},n,r)}function ll(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Dr,os=yt.current,ke(yt,t),ke(Ot,Ot.current),!0}function Pp(t,e,n){var r=t.stateNode;if(!r)throw Error(P(169));n?(t=I0(t,e,os),r.__reactInternalMemoizedMergedChildContext=t,Pe(Ot),Pe(yt),ke(yt,t)):Pe(Ot),ke(Ot,n)}var On=null,sc=!1,tu=!1;function R0(t){On===null?On=[t]:On.push(t)}function W1(t){sc=!0,R0(t)}function zr(){if(!tu&&On!==null){tu=!0;var t=0,e=_e;try{var n=On;for(_e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}On=null,sc=!1}catch(s){throw On!==null&&(On=On.slice(t+1)),r0(rh,zr),s}finally{_e=e,tu=!1}}return null}var Ds=[],Ls=0,cl=null,ul=0,Gt=[],Kt=0,as=null,Mn=1,Fn="";function Gr(t,e){Ds[Ls++]=ul,Ds[Ls++]=cl,cl=t,ul=e}function A0(t,e,n){Gt[Kt++]=Mn,Gt[Kt++]=Fn,Gt[Kt++]=as,as=t;var r=Mn;t=Fn;var s=32-mn(r)-1;r&=~(1<<s),n+=1;var i=32-mn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Mn=1<<32-mn(e)+s|n<<s|r,Fn=i+t}else Mn=1<<i|n<<s|r,Fn=t}function hh(t){t.return!==null&&(Gr(t,1),A0(t,1,0))}function fh(t){for(;t===cl;)cl=Ds[--Ls],Ds[Ls]=null,ul=Ds[--Ls],Ds[Ls]=null;for(;t===as;)as=Gt[--Kt],Gt[Kt]=null,Fn=Gt[--Kt],Gt[Kt]=null,Mn=Gt[--Kt],Gt[Kt]=null}var Ht=null,Bt=null,De=!1,un=null;function D0(t,e){var n=Qt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ip(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ht=t,Bt=Nr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ht=t,Bt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=as!==null?{id:Mn,overflow:Fn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Qt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ht=t,Bt=null,!0):!1;default:return!1}}function Zu(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ed(t){if(De){var e=Bt;if(e){var n=e;if(!Ip(t,e)){if(Zu(t))throw Error(P(418));e=Nr(n.nextSibling);var r=Ht;e&&Ip(t,e)?D0(r,n):(t.flags=t.flags&-4097|2,De=!1,Ht=t)}}else{if(Zu(t))throw Error(P(418));t.flags=t.flags&-4097|2,De=!1,Ht=t}}}function Rp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ht=t}function _a(t){if(t!==Ht)return!1;if(!De)return Rp(t),De=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Qu(t.type,t.memoizedProps)),e&&(e=Bt)){if(Zu(t))throw L0(),Error(P(418));for(;e;)D0(t,e),e=Nr(e.nextSibling)}if(Rp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(P(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Bt=Nr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Bt=null}}else Bt=Ht?Nr(t.stateNode.nextSibling):null;return!0}function L0(){for(var t=Bt;t;)t=Nr(t.nextSibling)}function ei(){Bt=Ht=null,De=!1}function ph(t){un===null?un=[t]:un.push(t)}var V1=nr.ReactCurrentBatchConfig;function Di(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(P(309));var r=n.stateNode}if(!r)throw Error(P(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(P(284));if(!n._owner)throw Error(P(290,t))}return t}function va(t,e){throw t=Object.prototype.toString.call(e),Error(P(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ap(t){var e=t._init;return e(t._payload)}function O0(t){function e(g,p){if(t){var m=g.deletions;m===null?(g.deletions=[p],g.flags|=16):m.push(p)}}function n(g,p){if(!t)return null;for(;p!==null;)e(g,p),p=p.sibling;return null}function r(g,p){for(g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function s(g,p){return g=Er(g,p),g.index=0,g.sibling=null,g}function i(g,p,m){return g.index=m,t?(m=g.alternate,m!==null?(m=m.index,m<p?(g.flags|=2,p):m):(g.flags|=2,p)):(g.flags|=1048576,p)}function a(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,p,m,w){return p===null||p.tag!==6?(p=lu(m,g.mode,w),p.return=g,p):(p=s(p,m),p.return=g,p)}function c(g,p,m,w){var N=m.type;return N===js?d(g,p,m.props.children,w,m.key):p!==null&&(p.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===ar&&Ap(N)===p.type)?(w=s(p,m.props),w.ref=Di(g,p,m),w.return=g,w):(w=Ba(m.type,m.key,m.props,null,g.mode,w),w.ref=Di(g,p,m),w.return=g,w)}function u(g,p,m,w){return p===null||p.tag!==4||p.stateNode.containerInfo!==m.containerInfo||p.stateNode.implementation!==m.implementation?(p=cu(m,g.mode,w),p.return=g,p):(p=s(p,m.children||[]),p.return=g,p)}function d(g,p,m,w,N){return p===null||p.tag!==7?(p=ss(m,g.mode,w,N),p.return=g,p):(p=s(p,m),p.return=g,p)}function h(g,p,m){if(typeof p=="string"&&p!==""||typeof p=="number")return p=lu(""+p,g.mode,m),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case ca:return m=Ba(p.type,p.key,p.props,null,g.mode,m),m.ref=Di(g,null,p),m.return=g,m;case ks:return p=cu(p,g.mode,m),p.return=g,p;case ar:var w=p._init;return h(g,w(p._payload),m)}if(Wi(p)||Ti(p))return p=ss(p,g.mode,m,null),p.return=g,p;va(g,p)}return null}function f(g,p,m,w){var N=p!==null?p.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return N!==null?null:l(g,p,""+m,w);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ca:return m.key===N?c(g,p,m,w):null;case ks:return m.key===N?u(g,p,m,w):null;case ar:return N=m._init,f(g,p,N(m._payload),w)}if(Wi(m)||Ti(m))return N!==null?null:d(g,p,m,w,null);va(g,m)}return null}function y(g,p,m,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(m)||null,l(p,g,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ca:return g=g.get(w.key===null?m:w.key)||null,c(p,g,w,N);case ks:return g=g.get(w.key===null?m:w.key)||null,u(p,g,w,N);case ar:var C=w._init;return y(g,p,m,C(w._payload),N)}if(Wi(w)||Ti(w))return g=g.get(m)||null,d(p,g,w,N,null);va(p,w)}return null}function _(g,p,m,w){for(var N=null,C=null,k=p,T=p=0,R=null;k!==null&&T<m.length;T++){k.index>T?(R=k,k=null):R=k.sibling;var I=f(g,k,m[T],w);if(I===null){k===null&&(k=R);break}t&&k&&I.alternate===null&&e(g,k),p=i(I,p,T),C===null?N=I:C.sibling=I,C=I,k=R}if(T===m.length)return n(g,k),De&&Gr(g,T),N;if(k===null){for(;T<m.length;T++)k=h(g,m[T],w),k!==null&&(p=i(k,p,T),C===null?N=k:C.sibling=k,C=k);return De&&Gr(g,T),N}for(k=r(g,k);T<m.length;T++)R=y(k,g,T,m[T],w),R!==null&&(t&&R.alternate!==null&&k.delete(R.key===null?T:R.key),p=i(R,p,T),C===null?N=R:C.sibling=R,C=R);return t&&k.forEach(function(G){return e(g,G)}),De&&Gr(g,T),N}function v(g,p,m,w){var N=Ti(m);if(typeof N!="function")throw Error(P(150));if(m=N.call(m),m==null)throw Error(P(151));for(var C=N=null,k=p,T=p=0,R=null,I=m.next();k!==null&&!I.done;T++,I=m.next()){k.index>T?(R=k,k=null):R=k.sibling;var G=f(g,k,I.value,w);if(G===null){k===null&&(k=R);break}t&&k&&G.alternate===null&&e(g,k),p=i(G,p,T),C===null?N=G:C.sibling=G,C=G,k=R}if(I.done)return n(g,k),De&&Gr(g,T),N;if(k===null){for(;!I.done;T++,I=m.next())I=h(g,I.value,w),I!==null&&(p=i(I,p,T),C===null?N=I:C.sibling=I,C=I);return De&&Gr(g,T),N}for(k=r(g,k);!I.done;T++,I=m.next())I=y(k,g,T,I.value,w),I!==null&&(t&&I.alternate!==null&&k.delete(I.key===null?T:I.key),p=i(I,p,T),C===null?N=I:C.sibling=I,C=I);return t&&k.forEach(function(re){return e(g,re)}),De&&Gr(g,T),N}function S(g,p,m,w){if(typeof m=="object"&&m!==null&&m.type===js&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case ca:e:{for(var N=m.key,C=p;C!==null;){if(C.key===N){if(N=m.type,N===js){if(C.tag===7){n(g,C.sibling),p=s(C,m.props.children),p.return=g,g=p;break e}}else if(C.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===ar&&Ap(N)===C.type){n(g,C.sibling),p=s(C,m.props),p.ref=Di(g,C,m),p.return=g,g=p;break e}n(g,C);break}else e(g,C);C=C.sibling}m.type===js?(p=ss(m.props.children,g.mode,w,m.key),p.return=g,g=p):(w=Ba(m.type,m.key,m.props,null,g.mode,w),w.ref=Di(g,p,m),w.return=g,g=w)}return a(g);case ks:e:{for(C=m.key;p!==null;){if(p.key===C)if(p.tag===4&&p.stateNode.containerInfo===m.containerInfo&&p.stateNode.implementation===m.implementation){n(g,p.sibling),p=s(p,m.children||[]),p.return=g,g=p;break e}else{n(g,p);break}else e(g,p);p=p.sibling}p=cu(m,g.mode,w),p.return=g,g=p}return a(g);case ar:return C=m._init,S(g,p,C(m._payload),w)}if(Wi(m))return _(g,p,m,w);if(Ti(m))return v(g,p,m,w);va(g,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,p!==null&&p.tag===6?(n(g,p.sibling),p=s(p,m),p.return=g,g=p):(n(g,p),p=lu(m,g.mode,w),p.return=g,g=p),a(g)):n(g,p)}return S}var ti=O0(!0),M0=O0(!1),dl=Ur(null),hl=null,Os=null,mh=null;function gh(){mh=Os=hl=null}function yh(t){var e=dl.current;Pe(dl),t._currentValue=e}function td(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Vs(t,e){hl=t,mh=Os=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Dt=!0),t.firstContext=null)}function Zt(t){var e=t._currentValue;if(mh!==t)if(t={context:t,memoizedValue:e,next:null},Os===null){if(hl===null)throw Error(P(308));Os=t,hl.dependencies={lanes:0,firstContext:t}}else Os=Os.next=t;return e}var es=null;function xh(t){es===null?es=[t]:es.push(t)}function F0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,xh(e)):(n.next=s.next,s.next=n),e.interleaved=n,Kn(t,r)}function Kn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var lr=!1;function _h(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Bn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function br(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,me&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Kn(t,n)}return s=r.interleaved,s===null?(e.next=e,xh(r)):(e.next=s.next,s.next=e),r.interleaved=e,Kn(t,n)}function Oa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sh(t,n)}}function Dp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function fl(t,e,n,r){var s=t.updateQueue;lr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;a=0,d=u=c=null,l=i;do{var f=l.lane,y=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=t,v=l;switch(f=e,y=n,v.tag){case 1:if(_=v.payload,typeof _=="function"){h=_.call(y,h,f);break e}h=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=v.payload,f=typeof _=="function"?_.call(y,h,f):_,f==null)break e;h=He({},h,f);break e;case 2:lr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else y={eventTime:y,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=y,c=h):d=d.next=y,a|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);cs|=a,t.lanes=a,t.memoizedState=h}}function Lp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(P(191,s));s.call(r)}}}var Wo={},Sn=Ur(Wo),No=Ur(Wo),bo=Ur(Wo);function ts(t){if(t===Wo)throw Error(P(174));return t}function vh(t,e){switch(ke(bo,e),ke(No,t),ke(Sn,Wo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Lu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Lu(e,t)}Pe(Sn),ke(Sn,e)}function ni(){Pe(Sn),Pe(No),Pe(bo)}function U0(t){ts(bo.current);var e=ts(Sn.current),n=Lu(e,t.type);e!==n&&(ke(No,t),ke(Sn,n))}function wh(t){No.current===t&&(Pe(Sn),Pe(No))}var Ue=Ur(0);function pl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var nu=[];function Nh(){for(var t=0;t<nu.length;t++)nu[t]._workInProgressVersionPrimary=null;nu.length=0}var Ma=nr.ReactCurrentDispatcher,ru=nr.ReactCurrentBatchConfig,ls=0,ze=null,Ze=null,it=null,ml=!1,Zi=!1,So=0,q1=0;function pt(){throw Error(P(321))}function bh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!xn(t[n],e[n]))return!1;return!0}function Sh(t,e,n,r,s,i){if(ls=i,ze=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ma.current=t===null||t.memoizedState===null?Y1:X1,t=n(r,s),Zi){i=0;do{if(Zi=!1,So=0,25<=i)throw Error(P(301));i+=1,it=Ze=null,e.updateQueue=null,Ma.current=J1,t=n(r,s)}while(Zi)}if(Ma.current=gl,e=Ze!==null&&Ze.next!==null,ls=0,it=Ze=ze=null,ml=!1,e)throw Error(P(300));return t}function Ch(){var t=So!==0;return So=0,t}function wn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return it===null?ze.memoizedState=it=t:it=it.next=t,it}function en(){if(Ze===null){var t=ze.alternate;t=t!==null?t.memoizedState:null}else t=Ze.next;var e=it===null?ze.memoizedState:it.next;if(e!==null)it=e,Ze=t;else{if(t===null)throw Error(P(310));Ze=t,t={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},it===null?ze.memoizedState=it=t:it=it.next=t}return it}function Co(t,e){return typeof e=="function"?e(t):e}function su(t){var e=en(),n=e.queue;if(n===null)throw Error(P(311));n.lastRenderedReducer=t;var r=Ze,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,u=i;do{var d=u.lane;if((ls&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,a=r):c=c.next=h,ze.lanes|=d,cs|=d}u=u.next}while(u!==null&&u!==i);c===null?a=r:c.next=l,xn(r,e.memoizedState)||(Dt=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ze.lanes|=i,cs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function iu(t){var e=en(),n=e.queue;if(n===null)throw Error(P(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);xn(i,e.memoizedState)||(Dt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function z0(){}function B0(t,e){var n=ze,r=en(),s=e(),i=!xn(r.memoizedState,s);if(i&&(r.memoizedState=s,Dt=!0),r=r.queue,Eh(V0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||it!==null&&it.memoizedState.tag&1){if(n.flags|=2048,Eo(9,W0.bind(null,n,r,s,e),void 0,null),at===null)throw Error(P(349));ls&30||H0(n,e,s)}return s}function H0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function W0(t,e,n,r){e.value=n,e.getSnapshot=r,q0(e)&&G0(t)}function V0(t,e,n){return n(function(){q0(e)&&G0(t)})}function q0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!xn(t,n)}catch{return!0}}function G0(t){var e=Kn(t,1);e!==null&&gn(e,t,1,-1)}function Op(t){var e=wn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:t},e.queue=t,t=t.dispatch=Q1.bind(null,ze,t),[e.memoizedState,t]}function Eo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function K0(){return en().memoizedState}function Fa(t,e,n,r){var s=wn();ze.flags|=t,s.memoizedState=Eo(1|e,n,void 0,r===void 0?null:r)}function ic(t,e,n,r){var s=en();r=r===void 0?null:r;var i=void 0;if(Ze!==null){var a=Ze.memoizedState;if(i=a.destroy,r!==null&&bh(r,a.deps)){s.memoizedState=Eo(e,n,i,r);return}}ze.flags|=t,s.memoizedState=Eo(1|e,n,i,r)}function Mp(t,e){return Fa(8390656,8,t,e)}function Eh(t,e){return ic(2048,8,t,e)}function Q0(t,e){return ic(4,2,t,e)}function Y0(t,e){return ic(4,4,t,e)}function X0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function J0(t,e,n){return n=n!=null?n.concat([t]):null,ic(4,4,X0.bind(null,e,t),n)}function kh(){}function Z0(t,e){var n=en();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&bh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ey(t,e){var n=en();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&bh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function ty(t,e,n){return ls&21?(xn(n,e)||(n=o0(),ze.lanes|=n,cs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Dt=!0),t.memoizedState=n)}function G1(t,e){var n=_e;_e=n!==0&&4>n?n:4,t(!0);var r=ru.transition;ru.transition={};try{t(!1),e()}finally{_e=n,ru.transition=r}}function ny(){return en().memoizedState}function K1(t,e,n){var r=Cr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ry(t))sy(e,n);else if(n=F0(t,e,n,r),n!==null){var s=Nt();gn(n,t,r,s),iy(n,e,r)}}function Q1(t,e,n){var r=Cr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ry(t))sy(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,xn(l,a)){var c=e.interleaved;c===null?(s.next=s,xh(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=F0(t,e,s,r),n!==null&&(s=Nt(),gn(n,t,r,s),iy(n,e,r))}}function ry(t){var e=t.alternate;return t===ze||e!==null&&e===ze}function sy(t,e){Zi=ml=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function iy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sh(t,n)}}var gl={readContext:Zt,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useInsertionEffect:pt,useLayoutEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useMutableSource:pt,useSyncExternalStore:pt,useId:pt,unstable_isNewReconciler:!1},Y1={readContext:Zt,useCallback:function(t,e){return wn().memoizedState=[t,e===void 0?null:e],t},useContext:Zt,useEffect:Mp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Fa(4194308,4,X0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Fa(4194308,4,t,e)},useInsertionEffect:function(t,e){return Fa(4,2,t,e)},useMemo:function(t,e){var n=wn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=wn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=K1.bind(null,ze,t),[r.memoizedState,t]},useRef:function(t){var e=wn();return t={current:t},e.memoizedState=t},useState:Op,useDebugValue:kh,useDeferredValue:function(t){return wn().memoizedState=t},useTransition:function(){var t=Op(!1),e=t[0];return t=G1.bind(null,t[1]),wn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ze,s=wn();if(De){if(n===void 0)throw Error(P(407));n=n()}else{if(n=e(),at===null)throw Error(P(349));ls&30||H0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Mp(V0.bind(null,r,i,t),[t]),r.flags|=2048,Eo(9,W0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=wn(),e=at.identifierPrefix;if(De){var n=Fn,r=Mn;n=(r&~(1<<32-mn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=So++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=q1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},X1={readContext:Zt,useCallback:Z0,useContext:Zt,useEffect:Eh,useImperativeHandle:J0,useInsertionEffect:Q0,useLayoutEffect:Y0,useMemo:ey,useReducer:su,useRef:K0,useState:function(){return su(Co)},useDebugValue:kh,useDeferredValue:function(t){var e=en();return ty(e,Ze.memoizedState,t)},useTransition:function(){var t=su(Co)[0],e=en().memoizedState;return[t,e]},useMutableSource:z0,useSyncExternalStore:B0,useId:ny,unstable_isNewReconciler:!1},J1={readContext:Zt,useCallback:Z0,useContext:Zt,useEffect:Eh,useImperativeHandle:J0,useInsertionEffect:Q0,useLayoutEffect:Y0,useMemo:ey,useReducer:iu,useRef:K0,useState:function(){return iu(Co)},useDebugValue:kh,useDeferredValue:function(t){var e=en();return Ze===null?e.memoizedState=t:ty(e,Ze.memoizedState,t)},useTransition:function(){var t=iu(Co)[0],e=en().memoizedState;return[t,e]},useMutableSource:z0,useSyncExternalStore:B0,useId:ny,unstable_isNewReconciler:!1};function ln(t,e){if(t&&t.defaultProps){e=He({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function nd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:He({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var oc={isMounted:function(t){return(t=t._reactInternals)?xs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Nt(),s=Cr(t),i=Bn(r,s);i.payload=e,n!=null&&(i.callback=n),e=br(t,i,s),e!==null&&(gn(e,t,s,r),Oa(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Nt(),s=Cr(t),i=Bn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=br(t,i,s),e!==null&&(gn(e,t,s,r),Oa(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Nt(),r=Cr(t),s=Bn(n,r);s.tag=2,e!=null&&(s.callback=e),e=br(t,s,r),e!==null&&(gn(e,t,r,n),Oa(e,t,r))}};function Fp(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!xo(n,r)||!xo(s,i):!0}function oy(t,e,n){var r=!1,s=Dr,i=e.contextType;return typeof i=="object"&&i!==null?i=Zt(i):(s=Mt(e)?os:yt.current,r=e.contextTypes,i=(r=r!=null)?Zs(t,s):Dr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=oc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function $p(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&oc.enqueueReplaceState(e,e.state,null)}function rd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},_h(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Zt(i):(i=Mt(e)?os:yt.current,s.context=Zs(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(nd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&oc.enqueueReplaceState(s,s.state,null),fl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ri(t,e){try{var n="",r=e;do n+=Ew(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ou(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Z1=typeof WeakMap=="function"?WeakMap:Map;function ay(t,e,n){n=Bn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){xl||(xl=!0,pd=r),sd(t,e)},n}function ly(t,e,n){n=Bn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){sd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){sd(t,e),typeof r!="function"&&(Sr===null?Sr=new Set([this]):Sr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Up(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Z1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=fN.bind(null,t,e,n),e.then(t,t))}function zp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Bp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Bn(-1,1),e.tag=2,br(n,e,1))),n.lanes|=1),t)}var eN=nr.ReactCurrentOwner,Dt=!1;function vt(t,e,n,r){e.child=t===null?M0(e,null,n,r):ti(e,t.child,n,r)}function Hp(t,e,n,r,s){n=n.render;var i=e.ref;return Vs(e,s),r=Sh(t,e,n,r,i,s),n=Ch(),t!==null&&!Dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qn(t,e,s)):(De&&n&&hh(e),e.flags|=1,vt(t,e,r,s),e.child)}function Wp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Lh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,cy(t,e,i,r,s)):(t=Ba(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:xo,n(a,r)&&t.ref===e.ref)return Qn(t,e,s)}return e.flags|=1,t=Er(i,r),t.ref=e.ref,t.return=e,e.child=t}function cy(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(xo(i,r)&&t.ref===e.ref)if(Dt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Dt=!0);else return e.lanes=t.lanes,Qn(t,e,s)}return id(t,e,n,r,s)}function uy(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(Fs,zt),zt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ke(Fs,zt),zt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ke(Fs,zt),zt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ke(Fs,zt),zt|=r;return vt(t,e,s,n),e.child}function dy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function id(t,e,n,r,s){var i=Mt(n)?os:yt.current;return i=Zs(e,i),Vs(e,s),n=Sh(t,e,n,r,i,s),r=Ch(),t!==null&&!Dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qn(t,e,s)):(De&&r&&hh(e),e.flags|=1,vt(t,e,n,s),e.child)}function Vp(t,e,n,r,s){if(Mt(n)){var i=!0;ll(e)}else i=!1;if(Vs(e,s),e.stateNode===null)$a(t,e),oy(e,n,r),rd(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=Zt(u):(u=Mt(n)?os:yt.current,u=Zs(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==u)&&$p(e,a,r,u),lr=!1;var f=e.memoizedState;a.state=f,fl(e,r,a,s),c=e.memoizedState,l!==r||f!==c||Ot.current||lr?(typeof d=="function"&&(nd(e,n,d,r),c=e.memoizedState),(l=lr||Fp(e,n,l,r,f,c,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=u,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,$0(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:ln(e.type,l),a.props=u,h=e.pendingProps,f=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=Zt(c):(c=Mt(n)?os:yt.current,c=Zs(e,c));var y=n.getDerivedStateFromProps;(d=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||f!==c)&&$p(e,a,r,c),lr=!1,f=e.memoizedState,a.state=f,fl(e,r,a,s);var _=e.memoizedState;l!==h||f!==_||Ot.current||lr?(typeof y=="function"&&(nd(e,n,y,r),_=e.memoizedState),(u=lr||Fp(e,n,u,r,f,_,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,_,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,_,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),a.props=r,a.state=_,a.context=c,r=u):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return od(t,e,n,r,i,s)}function od(t,e,n,r,s,i){dy(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&Pp(e,n,!1),Qn(t,e,i);r=e.stateNode,eN.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=ti(e,t.child,null,i),e.child=ti(e,null,l,i)):vt(t,e,l,i),e.memoizedState=r.state,s&&Pp(e,n,!0),e.child}function hy(t){var e=t.stateNode;e.pendingContext?Tp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Tp(t,e.context,!1),vh(t,e.containerInfo)}function qp(t,e,n,r,s){return ei(),ph(s),e.flags|=256,vt(t,e,n,r),e.child}var ad={dehydrated:null,treeContext:null,retryLane:0};function ld(t){return{baseLanes:t,cachePool:null,transitions:null}}function fy(t,e,n){var r=e.pendingProps,s=Ue.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ke(Ue,s&1),t===null)return ed(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=cc(a,r,0,null),t=ss(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ld(n),e.memoizedState=ad,t):jh(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return tN(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Er(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Er(l,i):(i=ss(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?ld(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=ad,r}return i=t.child,t=i.sibling,r=Er(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function jh(t,e){return e=cc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wa(t,e,n,r){return r!==null&&ph(r),ti(e,t.child,null,n),t=jh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function tN(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=ou(Error(P(422))),wa(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=cc({mode:"visible",children:r.children},s,0,null),i=ss(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ti(e,t.child,null,a),e.child.memoizedState=ld(a),e.memoizedState=ad,i);if(!(e.mode&1))return wa(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(P(419)),r=ou(i,r,void 0),wa(t,e,a,r)}if(l=(a&t.childLanes)!==0,Dt||l){if(r=at,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Kn(t,s),gn(r,t,s,-1))}return Dh(),r=ou(Error(P(421))),wa(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=pN.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Bt=Nr(s.nextSibling),Ht=e,De=!0,un=null,t!==null&&(Gt[Kt++]=Mn,Gt[Kt++]=Fn,Gt[Kt++]=as,Mn=t.id,Fn=t.overflow,as=e),e=jh(e,r.children),e.flags|=4096,e)}function Gp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),td(t.return,e,n)}function au(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function py(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(vt(t,e,r.children,n),r=Ue.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Gp(t,n,e);else if(t.tag===19)Gp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ke(Ue,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&pl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),au(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&pl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}au(e,!0,n,null,i);break;case"together":au(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $a(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Qn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),cs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(P(153));if(e.child!==null){for(t=e.child,n=Er(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Er(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function nN(t,e,n){switch(e.tag){case 3:hy(e),ei();break;case 5:U0(e);break;case 1:Mt(e.type)&&ll(e);break;case 4:vh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ke(dl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ke(Ue,Ue.current&1),e.flags|=128,null):n&e.child.childLanes?fy(t,e,n):(ke(Ue,Ue.current&1),t=Qn(t,e,n),t!==null?t.sibling:null);ke(Ue,Ue.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return py(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ke(Ue,Ue.current),r)break;return null;case 22:case 23:return e.lanes=0,uy(t,e,n)}return Qn(t,e,n)}var my,cd,gy,yy;my=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};cd=function(){};gy=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ts(Sn.current);var i=null;switch(n){case"input":s=Iu(t,s),r=Iu(t,r),i=[];break;case"select":s=He({},s,{value:void 0}),r=He({},r,{value:void 0}),i=[];break;case"textarea":s=Du(t,s),r=Du(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ol)}Ou(n,r);var a;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(uo.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(uo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Te("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};yy=function(t,e,n,r){n!==r&&(e.flags|=4)};function Li(t,e){if(!De)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function mt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function rN(t,e,n){var r=e.pendingProps;switch(fh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(e),null;case 1:return Mt(e.type)&&al(),mt(e),null;case 3:return r=e.stateNode,ni(),Pe(Ot),Pe(yt),Nh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(_a(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,un!==null&&(yd(un),un=null))),cd(t,e),mt(e),null;case 5:wh(e);var s=ts(bo.current);if(n=e.type,t!==null&&e.stateNode!=null)gy(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(P(166));return mt(e),null}if(t=ts(Sn.current),_a(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Nn]=e,r[wo]=i,t=(e.mode&1)!==0,n){case"dialog":Te("cancel",r),Te("close",r);break;case"iframe":case"object":case"embed":Te("load",r);break;case"video":case"audio":for(s=0;s<qi.length;s++)Te(qi[s],r);break;case"source":Te("error",r);break;case"img":case"image":case"link":Te("error",r),Te("load",r);break;case"details":Te("toggle",r);break;case"input":np(r,i),Te("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Te("invalid",r);break;case"textarea":sp(r,i),Te("invalid",r)}Ou(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&xa(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&xa(r.textContent,l,t),s=["children",""+l]):uo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Te("scroll",r)}switch(n){case"input":ua(r),rp(r,i,!0);break;case"textarea":ua(r),ip(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ol)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Vg(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Nn]=e,t[wo]=r,my(t,e,!1,!1),e.stateNode=t;e:{switch(a=Mu(n,r),n){case"dialog":Te("cancel",t),Te("close",t),s=r;break;case"iframe":case"object":case"embed":Te("load",t),s=r;break;case"video":case"audio":for(s=0;s<qi.length;s++)Te(qi[s],t);s=r;break;case"source":Te("error",t),s=r;break;case"img":case"image":case"link":Te("error",t),Te("load",t),s=r;break;case"details":Te("toggle",t),s=r;break;case"input":np(t,r),s=Iu(t,r),Te("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=He({},r,{value:void 0}),Te("invalid",t);break;case"textarea":sp(t,r),s=Du(t,r),Te("invalid",t);break;default:s=r}Ou(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Kg(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&qg(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ho(t,c):typeof c=="number"&&ho(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(uo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Te("scroll",t):c!=null&&Jd(t,i,c,a))}switch(n){case"input":ua(t),rp(t,r,!1);break;case"textarea":ua(t),ip(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ar(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?zs(t,!!r.multiple,i,!1):r.defaultValue!=null&&zs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=ol)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return mt(e),null;case 6:if(t&&e.stateNode!=null)yy(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(P(166));if(n=ts(bo.current),ts(Sn.current),_a(e)){if(r=e.stateNode,n=e.memoizedProps,r[Nn]=e,(i=r.nodeValue!==n)&&(t=Ht,t!==null))switch(t.tag){case 3:xa(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&xa(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Nn]=e,e.stateNode=r}return mt(e),null;case 13:if(Pe(Ue),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(De&&Bt!==null&&e.mode&1&&!(e.flags&128))L0(),ei(),e.flags|=98560,i=!1;else if(i=_a(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(P(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(P(317));i[Nn]=e}else ei(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;mt(e),i=!1}else un!==null&&(yd(un),un=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ue.current&1?nt===0&&(nt=3):Dh())),e.updateQueue!==null&&(e.flags|=4),mt(e),null);case 4:return ni(),cd(t,e),t===null&&_o(e.stateNode.containerInfo),mt(e),null;case 10:return yh(e.type._context),mt(e),null;case 17:return Mt(e.type)&&al(),mt(e),null;case 19:if(Pe(Ue),i=e.memoizedState,i===null)return mt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Li(i,!1);else{if(nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=pl(t),a!==null){for(e.flags|=128,Li(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ke(Ue,Ue.current&1|2),e.child}t=t.sibling}i.tail!==null&&Qe()>si&&(e.flags|=128,r=!0,Li(i,!1),e.lanes=4194304)}else{if(!r)if(t=pl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Li(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!De)return mt(e),null}else 2*Qe()-i.renderingStartTime>si&&n!==1073741824&&(e.flags|=128,r=!0,Li(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Qe(),e.sibling=null,n=Ue.current,ke(Ue,r?n&1|2:n&1),e):(mt(e),null);case 22:case 23:return Ah(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?zt&1073741824&&(mt(e),e.subtreeFlags&6&&(e.flags|=8192)):mt(e),null;case 24:return null;case 25:return null}throw Error(P(156,e.tag))}function sN(t,e){switch(fh(e),e.tag){case 1:return Mt(e.type)&&al(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ni(),Pe(Ot),Pe(yt),Nh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return wh(e),null;case 13:if(Pe(Ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(P(340));ei()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pe(Ue),null;case 4:return ni(),null;case 10:return yh(e.type._context),null;case 22:case 23:return Ah(),null;case 24:return null;default:return null}}var Na=!1,gt=!1,iN=typeof WeakSet=="function"?WeakSet:Set,z=null;function Ms(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ve(t,e,r)}else n.current=null}function ud(t,e,n){try{n()}catch(r){Ve(t,e,r)}}var Kp=!1;function oN(t,e){if(Gu=rl,t=N0(),dh(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var y;h!==n||s!==0&&h.nodeType!==3||(l=a+s),h!==i||r!==0&&h.nodeType!==3||(c=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(y=h.firstChild)!==null;)f=h,h=y;for(;;){if(h===t)break t;if(f===n&&++u===s&&(l=a),f===i&&++d===r&&(c=a),(y=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=y}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ku={focusedElem:t,selectionRange:n},rl=!1,z=e;z!==null;)if(e=z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,z=t;else for(;z!==null;){e=z;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var v=_.memoizedProps,S=_.memoizedState,g=e.stateNode,p=g.getSnapshotBeforeUpdate(e.elementType===e.type?v:ln(e.type,v),S);g.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(P(163))}}catch(w){Ve(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,z=t;break}z=e.return}return _=Kp,Kp=!1,_}function eo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ud(e,n,i)}s=s.next}while(s!==r)}}function ac(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function dd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function xy(t){var e=t.alternate;e!==null&&(t.alternate=null,xy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Nn],delete e[wo],delete e[Xu],delete e[B1],delete e[H1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function _y(t){return t.tag===5||t.tag===3||t.tag===4}function Qp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||_y(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ol));else if(r!==4&&(t=t.child,t!==null))for(hd(t,e,n),t=t.sibling;t!==null;)hd(t,e,n),t=t.sibling}function fd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(fd(t,e,n),t=t.sibling;t!==null;)fd(t,e,n),t=t.sibling}var lt=null,cn=!1;function ir(t,e,n){for(n=n.child;n!==null;)vy(t,e,n),n=n.sibling}function vy(t,e,n){if(bn&&typeof bn.onCommitFiberUnmount=="function")try{bn.onCommitFiberUnmount(Zl,n)}catch{}switch(n.tag){case 5:gt||Ms(n,e);case 6:var r=lt,s=cn;lt=null,ir(t,e,n),lt=r,cn=s,lt!==null&&(cn?(t=lt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):lt.removeChild(n.stateNode));break;case 18:lt!==null&&(cn?(t=lt,n=n.stateNode,t.nodeType===8?eu(t.parentNode,n):t.nodeType===1&&eu(t,n),go(t)):eu(lt,n.stateNode));break;case 4:r=lt,s=cn,lt=n.stateNode.containerInfo,cn=!0,ir(t,e,n),lt=r,cn=s;break;case 0:case 11:case 14:case 15:if(!gt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&ud(n,e,a),s=s.next}while(s!==r)}ir(t,e,n);break;case 1:if(!gt&&(Ms(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ve(n,e,l)}ir(t,e,n);break;case 21:ir(t,e,n);break;case 22:n.mode&1?(gt=(r=gt)||n.memoizedState!==null,ir(t,e,n),gt=r):ir(t,e,n);break;default:ir(t,e,n)}}function Yp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new iN),e.forEach(function(r){var s=mN.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function an(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:lt=l.stateNode,cn=!1;break e;case 3:lt=l.stateNode.containerInfo,cn=!0;break e;case 4:lt=l.stateNode.containerInfo,cn=!0;break e}l=l.return}if(lt===null)throw Error(P(160));vy(i,a,s),lt=null,cn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Ve(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)wy(e,t),e=e.sibling}function wy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(an(e,t),vn(t),r&4){try{eo(3,t,t.return),ac(3,t)}catch(v){Ve(t,t.return,v)}try{eo(5,t,t.return)}catch(v){Ve(t,t.return,v)}}break;case 1:an(e,t),vn(t),r&512&&n!==null&&Ms(n,n.return);break;case 5:if(an(e,t),vn(t),r&512&&n!==null&&Ms(n,n.return),t.flags&32){var s=t.stateNode;try{ho(s,"")}catch(v){Ve(t,t.return,v)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Hg(s,i),Mu(l,a);var u=Mu(l,i);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];d==="style"?Kg(s,h):d==="dangerouslySetInnerHTML"?qg(s,h):d==="children"?ho(s,h):Jd(s,d,h,u)}switch(l){case"input":Ru(s,i);break;case"textarea":Wg(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?zs(s,!!i.multiple,y,!1):f!==!!i.multiple&&(i.defaultValue!=null?zs(s,!!i.multiple,i.defaultValue,!0):zs(s,!!i.multiple,i.multiple?[]:"",!1))}s[wo]=i}catch(v){Ve(t,t.return,v)}}break;case 6:if(an(e,t),vn(t),r&4){if(t.stateNode===null)throw Error(P(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(v){Ve(t,t.return,v)}}break;case 3:if(an(e,t),vn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{go(e.containerInfo)}catch(v){Ve(t,t.return,v)}break;case 4:an(e,t),vn(t);break;case 13:an(e,t),vn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ih=Qe())),r&4&&Yp(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(gt=(u=gt)||d,an(e,t),gt=u):an(e,t),vn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(z=t,d=t.child;d!==null;){for(h=z=d;z!==null;){switch(f=z,y=f.child,f.tag){case 0:case 11:case 14:case 15:eo(4,f,f.return);break;case 1:Ms(f,f.return);var _=f.stateNode;if(typeof _.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(v){Ve(r,n,v)}}break;case 5:Ms(f,f.return);break;case 22:if(f.memoizedState!==null){Jp(h);continue}}y!==null?(y.return=f,z=y):Jp(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Gg("display",a))}catch(v){Ve(t,t.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){Ve(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:an(e,t),vn(t),r&4&&Yp(t);break;case 21:break;default:an(e,t),vn(t)}}function vn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(_y(n)){var r=n;break e}n=n.return}throw Error(P(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ho(s,""),r.flags&=-33);var i=Qp(t);fd(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Qp(t);hd(t,l,a);break;default:throw Error(P(161))}}catch(c){Ve(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function aN(t,e,n){z=t,Ny(t)}function Ny(t,e,n){for(var r=(t.mode&1)!==0;z!==null;){var s=z,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Na;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||gt;l=Na;var u=gt;if(Na=a,(gt=c)&&!u)for(z=s;z!==null;)a=z,c=a.child,a.tag===22&&a.memoizedState!==null?Zp(s):c!==null?(c.return=a,z=c):Zp(s);for(;i!==null;)z=i,Ny(i),i=i.sibling;z=s,Na=l,gt=u}Xp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,z=i):Xp(t)}}function Xp(t){for(;z!==null;){var e=z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gt||ac(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!gt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:ln(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Lp(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Lp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&go(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(P(163))}gt||e.flags&512&&dd(e)}catch(f){Ve(e,e.return,f)}}if(e===t){z=null;break}if(n=e.sibling,n!==null){n.return=e.return,z=n;break}z=e.return}}function Jp(t){for(;z!==null;){var e=z;if(e===t){z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,z=n;break}z=e.return}}function Zp(t){for(;z!==null;){var e=z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ac(4,e)}catch(c){Ve(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Ve(e,s,c)}}var i=e.return;try{dd(e)}catch(c){Ve(e,i,c)}break;case 5:var a=e.return;try{dd(e)}catch(c){Ve(e,a,c)}}}catch(c){Ve(e,e.return,c)}if(e===t){z=null;break}var l=e.sibling;if(l!==null){l.return=e.return,z=l;break}z=e.return}}var lN=Math.ceil,yl=nr.ReactCurrentDispatcher,Th=nr.ReactCurrentOwner,Jt=nr.ReactCurrentBatchConfig,me=0,at=null,Je=null,ut=0,zt=0,Fs=Ur(0),nt=0,ko=null,cs=0,lc=0,Ph=0,to=null,At=null,Ih=0,si=1/0,Ln=null,xl=!1,pd=null,Sr=null,ba=!1,yr=null,_l=0,no=0,md=null,Ua=-1,za=0;function Nt(){return me&6?Qe():Ua!==-1?Ua:Ua=Qe()}function Cr(t){return t.mode&1?me&2&&ut!==0?ut&-ut:V1.transition!==null?(za===0&&(za=o0()),za):(t=_e,t!==0||(t=window.event,t=t===void 0?16:f0(t.type)),t):1}function gn(t,e,n,r){if(50<no)throw no=0,md=null,Error(P(185));zo(t,n,r),(!(me&2)||t!==at)&&(t===at&&(!(me&2)&&(lc|=n),nt===4&&ur(t,ut)),Ft(t,r),n===1&&me===0&&!(e.mode&1)&&(si=Qe()+500,sc&&zr()))}function Ft(t,e){var n=t.callbackNode;Vw(t,e);var r=nl(t,t===at?ut:0);if(r===0)n!==null&&lp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&lp(n),e===1)t.tag===0?W1(em.bind(null,t)):R0(em.bind(null,t)),U1(function(){!(me&6)&&zr()}),n=null;else{switch(a0(r)){case 1:n=rh;break;case 4:n=s0;break;case 16:n=tl;break;case 536870912:n=i0;break;default:n=tl}n=Py(n,by.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function by(t,e){if(Ua=-1,za=0,me&6)throw Error(P(327));var n=t.callbackNode;if(qs()&&t.callbackNode!==n)return null;var r=nl(t,t===at?ut:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=vl(t,r);else{e=r;var s=me;me|=2;var i=Cy();(at!==t||ut!==e)&&(Ln=null,si=Qe()+500,rs(t,e));do try{dN();break}catch(l){Sy(t,l)}while(!0);gh(),yl.current=i,me=s,Je!==null?e=0:(at=null,ut=0,e=nt)}if(e!==0){if(e===2&&(s=Bu(t),s!==0&&(r=s,e=gd(t,s))),e===1)throw n=ko,rs(t,0),ur(t,r),Ft(t,Qe()),n;if(e===6)ur(t,r);else{if(s=t.current.alternate,!(r&30)&&!cN(s)&&(e=vl(t,r),e===2&&(i=Bu(t),i!==0&&(r=i,e=gd(t,i))),e===1))throw n=ko,rs(t,0),ur(t,r),Ft(t,Qe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(P(345));case 2:Kr(t,At,Ln);break;case 3:if(ur(t,r),(r&130023424)===r&&(e=Ih+500-Qe(),10<e)){if(nl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Nt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Yu(Kr.bind(null,t,At,Ln),e);break}Kr(t,At,Ln);break;case 4:if(ur(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-mn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*lN(r/1960))-r,10<r){t.timeoutHandle=Yu(Kr.bind(null,t,At,Ln),r);break}Kr(t,At,Ln);break;case 5:Kr(t,At,Ln);break;default:throw Error(P(329))}}}return Ft(t,Qe()),t.callbackNode===n?by.bind(null,t):null}function gd(t,e){var n=to;return t.current.memoizedState.isDehydrated&&(rs(t,e).flags|=256),t=vl(t,e),t!==2&&(e=At,At=n,e!==null&&yd(e)),t}function yd(t){At===null?At=t:At.push.apply(At,t)}function cN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!xn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ur(t,e){for(e&=~Ph,e&=~lc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-mn(e),r=1<<n;t[n]=-1,e&=~r}}function em(t){if(me&6)throw Error(P(327));qs();var e=nl(t,0);if(!(e&1))return Ft(t,Qe()),null;var n=vl(t,e);if(t.tag!==0&&n===2){var r=Bu(t);r!==0&&(e=r,n=gd(t,r))}if(n===1)throw n=ko,rs(t,0),ur(t,e),Ft(t,Qe()),n;if(n===6)throw Error(P(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Kr(t,At,Ln),Ft(t,Qe()),null}function Rh(t,e){var n=me;me|=1;try{return t(e)}finally{me=n,me===0&&(si=Qe()+500,sc&&zr())}}function us(t){yr!==null&&yr.tag===0&&!(me&6)&&qs();var e=me;me|=1;var n=Jt.transition,r=_e;try{if(Jt.transition=null,_e=1,t)return t()}finally{_e=r,Jt.transition=n,me=e,!(me&6)&&zr()}}function Ah(){zt=Fs.current,Pe(Fs)}function rs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$1(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(fh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&al();break;case 3:ni(),Pe(Ot),Pe(yt),Nh();break;case 5:wh(r);break;case 4:ni();break;case 13:Pe(Ue);break;case 19:Pe(Ue);break;case 10:yh(r.type._context);break;case 22:case 23:Ah()}n=n.return}if(at=t,Je=t=Er(t.current,null),ut=zt=e,nt=0,ko=null,Ph=lc=cs=0,At=to=null,es!==null){for(e=0;e<es.length;e++)if(n=es[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}es=null}return t}function Sy(t,e){do{var n=Je;try{if(gh(),Ma.current=gl,ml){for(var r=ze.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ml=!1}if(ls=0,it=Ze=ze=null,Zi=!1,So=0,Th.current=null,n===null||n.return===null){nt=1,ko=e,Je=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=ut,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var y=zp(a);if(y!==null){y.flags&=-257,Bp(y,a,l,i,e),y.mode&1&&Up(i,u,e),e=y,c=u;var _=e.updateQueue;if(_===null){var v=new Set;v.add(c),e.updateQueue=v}else _.add(c);break e}else{if(!(e&1)){Up(i,u,e),Dh();break e}c=Error(P(426))}}else if(De&&l.mode&1){var S=zp(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Bp(S,a,l,i,e),ph(ri(c,l));break e}}i=c=ri(c,l),nt!==4&&(nt=2),to===null?to=[i]:to.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=ay(i,c,e);Dp(i,g);break e;case 1:l=c;var p=i.type,m=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Sr===null||!Sr.has(m)))){i.flags|=65536,e&=-e,i.lanes|=e;var w=ly(i,l,e);Dp(i,w);break e}}i=i.return}while(i!==null)}ky(n)}catch(N){e=N,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function Cy(){var t=yl.current;return yl.current=gl,t===null?gl:t}function Dh(){(nt===0||nt===3||nt===2)&&(nt=4),at===null||!(cs&268435455)&&!(lc&268435455)||ur(at,ut)}function vl(t,e){var n=me;me|=2;var r=Cy();(at!==t||ut!==e)&&(Ln=null,rs(t,e));do try{uN();break}catch(s){Sy(t,s)}while(!0);if(gh(),me=n,yl.current=r,Je!==null)throw Error(P(261));return at=null,ut=0,nt}function uN(){for(;Je!==null;)Ey(Je)}function dN(){for(;Je!==null&&!Ow();)Ey(Je)}function Ey(t){var e=Ty(t.alternate,t,zt);t.memoizedProps=t.pendingProps,e===null?ky(t):Je=e,Th.current=null}function ky(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=sN(n,e),n!==null){n.flags&=32767,Je=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{nt=6,Je=null;return}}else if(n=rN(n,e,zt),n!==null){Je=n;return}if(e=e.sibling,e!==null){Je=e;return}Je=e=t}while(e!==null);nt===0&&(nt=5)}function Kr(t,e,n){var r=_e,s=Jt.transition;try{Jt.transition=null,_e=1,hN(t,e,n,r)}finally{Jt.transition=s,_e=r}return null}function hN(t,e,n,r){do qs();while(yr!==null);if(me&6)throw Error(P(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(P(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(qw(t,i),t===at&&(Je=at=null,ut=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ba||(ba=!0,Py(tl,function(){return qs(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Jt.transition,Jt.transition=null;var a=_e;_e=1;var l=me;me|=4,Th.current=null,oN(t,n),wy(n,t),R1(Ku),rl=!!Gu,Ku=Gu=null,t.current=n,aN(n),Mw(),me=l,_e=a,Jt.transition=i}else t.current=n;if(ba&&(ba=!1,yr=t,_l=s),i=t.pendingLanes,i===0&&(Sr=null),Uw(n.stateNode),Ft(t,Qe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(xl)throw xl=!1,t=pd,pd=null,t;return _l&1&&t.tag!==0&&qs(),i=t.pendingLanes,i&1?t===md?no++:(no=0,md=t):no=0,zr(),null}function qs(){if(yr!==null){var t=a0(_l),e=Jt.transition,n=_e;try{if(Jt.transition=null,_e=16>t?16:t,yr===null)var r=!1;else{if(t=yr,yr=null,_l=0,me&6)throw Error(P(331));var s=me;for(me|=4,z=t.current;z!==null;){var i=z,a=i.child;if(z.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(z=u;z!==null;){var d=z;switch(d.tag){case 0:case 11:case 15:eo(8,d,i)}var h=d.child;if(h!==null)h.return=d,z=h;else for(;z!==null;){d=z;var f=d.sibling,y=d.return;if(xy(d),d===u){z=null;break}if(f!==null){f.return=y,z=f;break}z=y}}}var _=i.alternate;if(_!==null){var v=_.child;if(v!==null){_.child=null;do{var S=v.sibling;v.sibling=null,v=S}while(v!==null)}}z=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,z=a;else e:for(;z!==null;){if(i=z,i.flags&2048)switch(i.tag){case 0:case 11:case 15:eo(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,z=g;break e}z=i.return}}var p=t.current;for(z=p;z!==null;){a=z;var m=a.child;if(a.subtreeFlags&2064&&m!==null)m.return=a,z=m;else e:for(a=p;z!==null;){if(l=z,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ac(9,l)}}catch(N){Ve(l,l.return,N)}if(l===a){z=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,z=w;break e}z=l.return}}if(me=s,zr(),bn&&typeof bn.onPostCommitFiberRoot=="function")try{bn.onPostCommitFiberRoot(Zl,t)}catch{}r=!0}return r}finally{_e=n,Jt.transition=e}}return!1}function tm(t,e,n){e=ri(n,e),e=ay(t,e,1),t=br(t,e,1),e=Nt(),t!==null&&(zo(t,1,e),Ft(t,e))}function Ve(t,e,n){if(t.tag===3)tm(t,t,n);else for(;e!==null;){if(e.tag===3){tm(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Sr===null||!Sr.has(r))){t=ri(n,t),t=ly(e,t,1),e=br(e,t,1),t=Nt(),e!==null&&(zo(e,1,t),Ft(e,t));break}}e=e.return}}function fN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Nt(),t.pingedLanes|=t.suspendedLanes&n,at===t&&(ut&n)===n&&(nt===4||nt===3&&(ut&130023424)===ut&&500>Qe()-Ih?rs(t,0):Ph|=n),Ft(t,e)}function jy(t,e){e===0&&(t.mode&1?(e=fa,fa<<=1,!(fa&130023424)&&(fa=4194304)):e=1);var n=Nt();t=Kn(t,e),t!==null&&(zo(t,e,n),Ft(t,n))}function pN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),jy(t,n)}function mN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(P(314))}r!==null&&r.delete(e),jy(t,n)}var Ty;Ty=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ot.current)Dt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Dt=!1,nN(t,e,n);Dt=!!(t.flags&131072)}else Dt=!1,De&&e.flags&1048576&&A0(e,ul,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;$a(t,e),t=e.pendingProps;var s=Zs(e,yt.current);Vs(e,n),s=Sh(null,e,r,t,s,n);var i=Ch();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Mt(r)?(i=!0,ll(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,_h(e),s.updater=oc,e.stateNode=s,s._reactInternals=e,rd(e,r,t,n),e=od(null,e,r,!0,i,n)):(e.tag=0,De&&i&&hh(e),vt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch($a(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=yN(r),t=ln(r,t),s){case 0:e=id(null,e,r,t,n);break e;case 1:e=Vp(null,e,r,t,n);break e;case 11:e=Hp(null,e,r,t,n);break e;case 14:e=Wp(null,e,r,ln(r.type,t),n);break e}throw Error(P(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ln(r,s),id(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ln(r,s),Vp(t,e,r,s,n);case 3:e:{if(hy(e),t===null)throw Error(P(387));r=e.pendingProps,i=e.memoizedState,s=i.element,$0(t,e),fl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ri(Error(P(423)),e),e=qp(t,e,r,n,s);break e}else if(r!==s){s=ri(Error(P(424)),e),e=qp(t,e,r,n,s);break e}else for(Bt=Nr(e.stateNode.containerInfo.firstChild),Ht=e,De=!0,un=null,n=M0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ei(),r===s){e=Qn(t,e,n);break e}vt(t,e,r,n)}e=e.child}return e;case 5:return U0(e),t===null&&ed(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Qu(r,s)?a=null:i!==null&&Qu(r,i)&&(e.flags|=32),dy(t,e),vt(t,e,a,n),e.child;case 6:return t===null&&ed(e),null;case 13:return fy(t,e,n);case 4:return vh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ti(e,null,r,n):vt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ln(r,s),Hp(t,e,r,s,n);case 7:return vt(t,e,e.pendingProps,n),e.child;case 8:return vt(t,e,e.pendingProps.children,n),e.child;case 12:return vt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,ke(dl,r._currentValue),r._currentValue=a,i!==null)if(xn(i.value,a)){if(i.children===s.children&&!Ot.current){e=Qn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Bn(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),td(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(P(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),td(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}vt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Vs(e,n),s=Zt(s),r=r(s),e.flags|=1,vt(t,e,r,n),e.child;case 14:return r=e.type,s=ln(r,e.pendingProps),s=ln(r.type,s),Wp(t,e,r,s,n);case 15:return cy(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ln(r,s),$a(t,e),e.tag=1,Mt(r)?(t=!0,ll(e)):t=!1,Vs(e,n),oy(e,r,s),rd(e,r,s,n),od(null,e,r,!0,t,n);case 19:return py(t,e,n);case 22:return uy(t,e,n)}throw Error(P(156,e.tag))};function Py(t,e){return r0(t,e)}function gN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(t,e,n,r){return new gN(t,e,n,r)}function Lh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function yN(t){if(typeof t=="function")return Lh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===eh)return 11;if(t===th)return 14}return 2}function Er(t,e){var n=t.alternate;return n===null?(n=Qt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ba(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Lh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case js:return ss(n.children,s,i,e);case Zd:a=8,s|=8;break;case ku:return t=Qt(12,n,e,s|2),t.elementType=ku,t.lanes=i,t;case ju:return t=Qt(13,n,e,s),t.elementType=ju,t.lanes=i,t;case Tu:return t=Qt(19,n,e,s),t.elementType=Tu,t.lanes=i,t;case Ug:return cc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Fg:a=10;break e;case $g:a=9;break e;case eh:a=11;break e;case th:a=14;break e;case ar:a=16,r=null;break e}throw Error(P(130,t==null?t:typeof t,""))}return e=Qt(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ss(t,e,n,r){return t=Qt(7,t,r,e),t.lanes=n,t}function cc(t,e,n,r){return t=Qt(22,t,r,e),t.elementType=Ug,t.lanes=n,t.stateNode={isHidden:!1},t}function lu(t,e,n){return t=Qt(6,t,null,e),t.lanes=n,t}function cu(t,e,n){return e=Qt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function xN(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hc(0),this.expirationTimes=Hc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Oh(t,e,n,r,s,i,a,l,c){return t=new xN(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Qt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_h(i),t}function _N(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ks,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Iy(t){if(!t)return Dr;t=t._reactInternals;e:{if(xs(t)!==t||t.tag!==1)throw Error(P(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Mt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(P(171))}if(t.tag===1){var n=t.type;if(Mt(n))return I0(t,n,e)}return e}function Ry(t,e,n,r,s,i,a,l,c){return t=Oh(n,r,!0,t,s,i,a,l,c),t.context=Iy(null),n=t.current,r=Nt(),s=Cr(n),i=Bn(r,s),i.callback=e??null,br(n,i,s),t.current.lanes=s,zo(t,s,r),Ft(t,r),t}function uc(t,e,n,r){var s=e.current,i=Nt(),a=Cr(s);return n=Iy(n),e.context===null?e.context=n:e.pendingContext=n,e=Bn(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=br(s,e,a),t!==null&&(gn(t,s,a,i),Oa(t,s,a)),a}function wl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function nm(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Mh(t,e){nm(t,e),(t=t.alternate)&&nm(t,e)}function vN(){return null}var Ay=typeof reportError=="function"?reportError:function(t){console.error(t)};function Fh(t){this._internalRoot=t}dc.prototype.render=Fh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(P(409));uc(t,e,null,null)};dc.prototype.unmount=Fh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;us(function(){uc(null,t,null,null)}),e[Gn]=null}};function dc(t){this._internalRoot=t}dc.prototype.unstable_scheduleHydration=function(t){if(t){var e=u0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<cr.length&&e!==0&&e<cr[n].priority;n++);cr.splice(n,0,t),n===0&&h0(t)}};function $h(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function rm(){}function wN(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=wl(a);i.call(u)}}var a=Ry(e,r,t,0,null,!1,!1,"",rm);return t._reactRootContainer=a,t[Gn]=a.current,_o(t.nodeType===8?t.parentNode:t),us(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=wl(c);l.call(u)}}var c=Oh(t,0,!1,null,null,!1,!1,"",rm);return t._reactRootContainer=c,t[Gn]=c.current,_o(t.nodeType===8?t.parentNode:t),us(function(){uc(e,c,n,r)}),c}function fc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=wl(a);l.call(c)}}uc(e,a,t,s)}else a=wN(n,e,t,s,r);return wl(a)}l0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Vi(e.pendingLanes);n!==0&&(sh(e,n|1),Ft(e,Qe()),!(me&6)&&(si=Qe()+500,zr()))}break;case 13:us(function(){var r=Kn(t,1);if(r!==null){var s=Nt();gn(r,t,1,s)}}),Mh(t,1)}};ih=function(t){if(t.tag===13){var e=Kn(t,134217728);if(e!==null){var n=Nt();gn(e,t,134217728,n)}Mh(t,134217728)}};c0=function(t){if(t.tag===13){var e=Cr(t),n=Kn(t,e);if(n!==null){var r=Nt();gn(n,t,e,r)}Mh(t,e)}};u0=function(){return _e};d0=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}};$u=function(t,e,n){switch(e){case"input":if(Ru(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=rc(r);if(!s)throw Error(P(90));Bg(r),Ru(r,s)}}}break;case"textarea":Wg(t,n);break;case"select":e=n.value,e!=null&&zs(t,!!n.multiple,e,!1)}};Xg=Rh;Jg=us;var NN={usingClientEntryPoint:!1,Events:[Ho,Rs,rc,Qg,Yg,Rh]},Oi={findFiberByHostInstance:Zr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bN={bundleType:Oi.bundleType,version:Oi.version,rendererPackageName:Oi.rendererPackageName,rendererConfig:Oi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:nr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=t0(t),t===null?null:t.stateNode},findFiberByHostInstance:Oi.findFiberByHostInstance||vN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sa.isDisabled&&Sa.supportsFiber)try{Zl=Sa.inject(bN),bn=Sa}catch{}}Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NN;Vt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$h(e))throw Error(P(200));return _N(t,e,null,n)};Vt.createRoot=function(t,e){if(!$h(t))throw Error(P(299));var n=!1,r="",s=Ay;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Oh(t,1,!1,null,null,n,!1,r,s),t[Gn]=e.current,_o(t.nodeType===8?t.parentNode:t),new Fh(e)};Vt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(P(188)):(t=Object.keys(t).join(","),Error(P(268,t)));return t=t0(e),t=t===null?null:t.stateNode,t};Vt.flushSync=function(t){return us(t)};Vt.hydrate=function(t,e,n){if(!hc(e))throw Error(P(200));return fc(null,t,e,!0,n)};Vt.hydrateRoot=function(t,e,n){if(!$h(t))throw Error(P(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=Ay;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Ry(e,null,t,1,n??null,s,!1,i,a),t[Gn]=e.current,_o(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new dc(e)};Vt.render=function(t,e,n){if(!hc(e))throw Error(P(200));return fc(null,t,e,!1,n)};Vt.unmountComponentAtNode=function(t){if(!hc(t))throw Error(P(40));return t._reactRootContainer?(us(function(){fc(null,null,t,!1,function(){t._reactRootContainer=null,t[Gn]=null})}),!0):!1};Vt.unstable_batchedUpdates=Rh;Vt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!hc(n))throw Error(P(200));if(t==null||t._reactInternals===void 0)throw Error(P(38));return fc(t,e,n,!1,r)};Vt.version="18.3.1-next-f1338f8080-20240426";function Dy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Dy)}catch(t){console.error(t)}}Dy(),Dg.exports=Vt;var Ly=Dg.exports,Oy,sm=Ly;Oy=sm.createRoot,sm.hydrateRoot;/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var im="popstate";function SN(t={}){function e(r,s){let{pathname:i,search:a,hash:l}=r.location;return xd("",{pathname:i,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:jo(s)}return EN(e,n,null,t)}function Be(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function kn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function CN(){return Math.random().toString(36).substring(2,10)}function om(t,e){return{usr:t.state,key:t.key,idx:e}}function xd(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?xi(e):e,state:n,key:e&&e.key||r||CN()}}function jo({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function xi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function EN(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,l="POP",c=null,u=d();u==null&&(u=0,a.replaceState({...a.state,idx:u},""));function d(){return(a.state||{idx:null}).idx}function h(){l="POP";let S=d(),g=S==null?null:S-u;u=S,c&&c({action:l,location:v.location,delta:g})}function f(S,g){l="PUSH";let p=xd(v.location,S,g);u=d()+1;let m=om(p,u),w=v.createHref(p);try{a.pushState(m,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(w)}i&&c&&c({action:l,location:v.location,delta:1})}function y(S,g){l="REPLACE";let p=xd(v.location,S,g);u=d();let m=om(p,u),w=v.createHref(p);a.replaceState(m,"",w),i&&c&&c({action:l,location:v.location,delta:0})}function _(S){return kN(S)}let v={get action(){return l},get location(){return t(s,a)},listen(S){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(im,h),c=S,()=>{s.removeEventListener(im,h),c=null}},createHref(S){return e(s,S)},createURL:_,encodeLocation(S){let g=_(S);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:y,go(S){return a.go(S)}};return v}function kN(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Be(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:jo(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function My(t,e,n="/"){return jN(t,e,n,!1)}function jN(t,e,n,r){let s=typeof e=="string"?xi(e):e,i=Yn(s.pathname||"/",n);if(i==null)return null;let a=Fy(t);TN(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let u=UN(i);l=FN(a[c],u,r)}return l}function Fy(t,e=[],n=[],r="",s=!1){let i=(a,l,c=s,u)=>{let d={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(r)&&c)return;Be(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length)}let h=Hn([r,d.relativePath]),f=n.concat(d);a.children&&a.children.length>0&&(Be(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),Fy(a.children,e,f,h,c)),!(a.path==null&&!a.index)&&e.push({path:h,score:ON(h,a.index),routesMeta:f})};return t.forEach((a,l)=>{var c;if(a.path===""||!((c=a.path)!=null&&c.includes("?")))i(a,l);else for(let u of $y(a.path))i(a,l,!0,u)}),e}function $y(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=$y(r.join("/")),l=[];return l.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...a),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function TN(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:MN(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var PN=/^:[\w-]+$/,IN=3,RN=2,AN=1,DN=10,LN=-2,am=t=>t==="*";function ON(t,e){let n=t.split("/"),r=n.length;return n.some(am)&&(r+=LN),e&&(r+=RN),n.filter(s=>!am(s)).reduce((s,i)=>s+(PN.test(i)?IN:i===""?AN:DN),r)}function MN(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function FN(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",a=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=Nl({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=Nl({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),a.push({params:s,pathname:Hn([i,h.pathname]),pathnameBase:WN(Hn([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Hn([i,h.pathnameBase]))}return a}function Nl(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=$N(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,{paramName:d,isOptional:h},f)=>{if(d==="*"){let _=l[f]||"";a=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const y=l[f];return h&&!y?u[d]=void 0:u[d]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:t}}function $N(t,e=!1,n=!0){kn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function UN(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return kn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Yn(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function zN(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?xi(t):t;return{pathname:n?n.startsWith("/")?n:BN(n,e):e,search:VN(r),hash:qN(s)}}function BN(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function uu(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function HN(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Uy(t){let e=HN(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function zy(t,e,n,r=!1){let s;typeof t=="string"?s=xi(t):(s={...t},Be(!s.pathname||!s.pathname.includes("?"),uu("?","pathname","search",s)),Be(!s.pathname||!s.pathname.includes("#"),uu("#","pathname","hash",s)),Be(!s.search||!s.search.includes("#"),uu("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,l;if(a==null)l=n;else{let h=e.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=zN(s,l),u=a&&a!=="/"&&a.endsWith("/"),d=(i||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var Hn=t=>t.join("/").replace(/\/\/+/g,"/"),WN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,qN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function GN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var By=["POST","PUT","PATCH","DELETE"];new Set(By);var KN=["GET",...By];new Set(KN);var _i=x.createContext(null);_i.displayName="DataRouter";var pc=x.createContext(null);pc.displayName="DataRouterState";x.createContext(!1);var Hy=x.createContext({isTransitioning:!1});Hy.displayName="ViewTransition";var QN=x.createContext(new Map);QN.displayName="Fetchers";var YN=x.createContext(null);YN.displayName="Await";var jn=x.createContext(null);jn.displayName="Navigation";var Vo=x.createContext(null);Vo.displayName="Location";var Tn=x.createContext({outlet:null,matches:[],isDataRoute:!1});Tn.displayName="Route";var Uh=x.createContext(null);Uh.displayName="RouteError";function XN(t,{relative:e}={}){Be(qo(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=x.useContext(jn),{hash:s,pathname:i,search:a}=Go(t,{relative:e}),l=i;return n!=="/"&&(l=i==="/"?n:Hn([n,i])),r.createHref({pathname:l,search:a,hash:s})}function qo(){return x.useContext(Vo)!=null}function nn(){return Be(qo(),"useLocation() may be used only in the context of a <Router> component."),x.useContext(Vo).location}var Wy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Vy(t){x.useContext(jn).static||x.useLayoutEffect(t)}function Br(){let{isDataRoute:t}=x.useContext(Tn);return t?ub():JN()}function JN(){Be(qo(),"useNavigate() may be used only in the context of a <Router> component.");let t=x.useContext(_i),{basename:e,navigator:n}=x.useContext(jn),{matches:r}=x.useContext(Tn),{pathname:s}=nn(),i=JSON.stringify(Uy(r)),a=x.useRef(!1);return Vy(()=>{a.current=!0}),x.useCallback((c,u={})=>{if(kn(a.current,Wy),!a.current)return;if(typeof c=="number"){n.go(c);return}let d=zy(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Hn([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,i,s,t])}x.createContext(null);function qy(){let{matches:t}=x.useContext(Tn),e=t[t.length-1];return e?e.params:{}}function Go(t,{relative:e}={}){let{matches:n}=x.useContext(Tn),{pathname:r}=nn(),s=JSON.stringify(Uy(n));return x.useMemo(()=>zy(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function ZN(t,e){return Gy(t,e)}function Gy(t,e,n,r,s){var p;Be(qo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=x.useContext(jn),{matches:a}=x.useContext(Tn),l=a[a.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",h=l&&l.route;{let m=h&&h.path||"";Ky(u,!h||m.endsWith("*")||m.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${m}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${m}"> to <Route path="${m==="/"?"*":`${m}/*`}">.`)}let f=nn(),y;if(e){let m=typeof e=="string"?xi(e):e;Be(d==="/"||((p=m.pathname)==null?void 0:p.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${m.pathname}" was given in the \`location\` prop.`),y=m}else y=f;let _=y.pathname||"/",v=_;if(d!=="/"){let m=d.replace(/^\//,"").split("/");v="/"+_.replace(/^\//,"").split("/").slice(m.length).join("/")}let S=My(t,{pathname:v});kn(h||S!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),kn(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let g=sb(S&&S.map(m=>Object.assign({},m,{params:Object.assign({},c,m.params),pathname:Hn([d,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?d:Hn([d,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),a,n,r,s);return e&&g?x.createElement(Vo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},g):g}function eb(){let t=cb(),e=GN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",t),a=x.createElement(x.Fragment,null,x.createElement("p",null," Hey developer "),x.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",x.createElement("code",{style:i},"ErrorBoundary")," or"," ",x.createElement("code",{style:i},"errorElement")," prop on your route.")),x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},e),n?x.createElement("pre",{style:s},n):null,a)}var tb=x.createElement(eb,null),nb=class extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?x.createElement(Tn.Provider,{value:this.props.routeContext},x.createElement(Uh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function rb({routeContext:t,match:e,children:n}){let r=x.useContext(_i);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),x.createElement(Tn.Provider,{value:t},n)}function sb(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,a=n==null?void 0:n.errors;if(a!=null){let u=i.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);Be(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(n)for(let u=0;u<i.length;u++){let d=i[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:f}=n,y=d.route.loader&&!h.hasOwnProperty(d.route.id)&&(!f||f[d.route.id]===void 0);if(d.route.lazy||y){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,d,h)=>{let f,y=!1,_=null,v=null;n&&(f=a&&d.route.id?a[d.route.id]:void 0,_=d.route.errorElement||tb,l&&(c<0&&h===0?(Ky("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,v=null):c===h&&(y=!0,v=d.route.hydrateFallbackElement||null)));let S=e.concat(i.slice(0,h+1)),g=()=>{let p;return f?p=_:y?p=v:d.route.Component?p=x.createElement(d.route.Component,null):d.route.element?p=d.route.element:p=u,x.createElement(rb,{match:d,routeContext:{outlet:u,matches:S,isDataRoute:n!=null},children:p})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?x.createElement(nb,{location:n.location,revalidation:n.revalidation,component:_,error:f,children:g(),routeContext:{outlet:null,matches:S,isDataRoute:!0},unstable_onError:r}):g()},null)}function zh(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ib(t){let e=x.useContext(_i);return Be(e,zh(t)),e}function ob(t){let e=x.useContext(pc);return Be(e,zh(t)),e}function ab(t){let e=x.useContext(Tn);return Be(e,zh(t)),e}function Bh(t){let e=ab(t),n=e.matches[e.matches.length-1];return Be(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function lb(){return Bh("useRouteId")}function cb(){var r;let t=x.useContext(Uh),e=ob("useRouteError"),n=Bh("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function ub(){let{router:t}=ib("useNavigate"),e=Bh("useNavigate"),n=x.useRef(!1);return Vy(()=>{n.current=!0}),x.useCallback(async(s,i={})=>{kn(n.current,Wy),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var lm={};function Ky(t,e,n){!e&&!lm[t]&&(lm[t]=!0,kn(!1,n))}x.memo(db);function db({routes:t,future:e,state:n,unstable_onError:r}){return Gy(t,void 0,n,r,e)}function Qr(t){Be(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function hb({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){Be(!qo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),l=x.useMemo(()=>({basename:a,navigator:s,static:i,future:{}}),[a,s,i]);typeof n=="string"&&(n=xi(n));let{pathname:c="/",search:u="",hash:d="",state:h=null,key:f="default"}=n,y=x.useMemo(()=>{let _=Yn(c,a);return _==null?null:{location:{pathname:_,search:u,hash:d,state:h,key:f},navigationType:r}},[a,c,u,d,h,f,r]);return kn(y!=null,`<Router basename="${a}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:x.createElement(jn.Provider,{value:l},x.createElement(Vo.Provider,{children:e,value:y}))}function fb({children:t,location:e}){return ZN(_d(t),e)}function _d(t,e=[]){let n=[];return x.Children.forEach(t,(r,s)=>{if(!x.isValidElement(r))return;let i=[...e,s];if(r.type===x.Fragment){n.push.apply(n,_d(r.props.children,i));return}Be(r.type===Qr,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Be(!r.props.index||!r.props.children,"An index route cannot have child routes.");let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=_d(r.props.children,i)),n.push(a)}),n}var Ha="get",Wa="application/x-www-form-urlencoded";function mc(t){return t!=null&&typeof t.tagName=="string"}function pb(t){return mc(t)&&t.tagName.toLowerCase()==="button"}function mb(t){return mc(t)&&t.tagName.toLowerCase()==="form"}function gb(t){return mc(t)&&t.tagName.toLowerCase()==="input"}function yb(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function xb(t,e){return t.button===0&&(!e||e==="_self")&&!yb(t)}var Ca=null;function _b(){if(Ca===null)try{new FormData(document.createElement("form"),0),Ca=!1}catch{Ca=!0}return Ca}var vb=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function du(t){return t!=null&&!vb.has(t)?(kn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Wa}"`),null):t}function wb(t,e){let n,r,s,i,a;if(mb(t)){let l=t.getAttribute("action");r=l?Yn(l,e):null,n=t.getAttribute("method")||Ha,s=du(t.getAttribute("enctype"))||Wa,i=new FormData(t)}else if(pb(t)||gb(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(r=c?Yn(c,e):null,n=t.getAttribute("formmethod")||l.getAttribute("method")||Ha,s=du(t.getAttribute("formenctype"))||du(l.getAttribute("enctype"))||Wa,i=new FormData(l,t),!_b()){let{name:u,type:d,value:h}=t;if(d==="image"){let f=u?`${u}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else u&&i.append(u,h)}}else{if(mc(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ha,r=null,s=Wa,a=t}return i&&s==="text/plain"&&(a=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Hh(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Nb(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Yn(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function bb(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Sb(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Cb(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let a=await bb(i,n);return a.links?a.links():[]}return[]}));return Tb(r.flat(1).filter(Sb).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function cm(t,e,n,r,s,i){let a=(c,u)=>n[u]?c.route.id!==n[u].route.id:!0,l=(c,u)=>{var d;return n[u].pathname!==c.pathname||((d=n[u].route.path)==null?void 0:d.endsWith("*"))&&n[u].params["*"]!==c.params["*"]};return i==="assets"?e.filter((c,u)=>a(c,u)||l(c,u)):i==="data"?e.filter((c,u)=>{var h;let d=r.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(a(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((h=n[0])==null?void 0:h.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function Eb(t,e,{includeHydrateFallback:n}={}){return kb(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function kb(t){return[...new Set(t)]}function jb(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function Tb(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(jb(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function Qy(){let t=x.useContext(_i);return Hh(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Pb(){let t=x.useContext(pc);return Hh(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Wh=x.createContext(void 0);Wh.displayName="FrameworkContext";function Yy(){let t=x.useContext(Wh);return Hh(t,"You must render this element inside a <HydratedRouter> element"),t}function Ib(t,e){let n=x.useContext(Wh),[r,s]=x.useState(!1),[i,a]=x.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=e,f=x.useRef(null);x.useEffect(()=>{if(t==="render"&&a(!0),t==="viewport"){let v=g=>{g.forEach(p=>{a(p.isIntersecting)})},S=new IntersectionObserver(v,{threshold:.5});return f.current&&S.observe(f.current),()=>{S.disconnect()}}},[t]),x.useEffect(()=>{if(r){let v=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(v)}}},[r]);let y=()=>{s(!0)},_=()=>{s(!1),a(!1)};return n?t!=="intent"?[i,f,{}]:[i,f,{onFocus:Mi(l,y),onBlur:Mi(c,_),onMouseEnter:Mi(u,y),onMouseLeave:Mi(d,_),onTouchStart:Mi(h,y)}]:[!1,f,{}]}function Mi(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Rb({page:t,...e}){let{router:n}=Qy(),r=x.useMemo(()=>My(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?x.createElement(Db,{page:t,matches:r,...e}):null}function Ab(t){let{manifest:e,routeModules:n}=Yy(),[r,s]=x.useState([]);return x.useEffect(()=>{let i=!1;return Cb(t,e,n).then(a=>{i||s(a)}),()=>{i=!0}},[t,e,n]),r}function Db({page:t,matches:e,...n}){let r=nn(),{manifest:s,routeModules:i}=Yy(),{basename:a}=Qy(),{loaderData:l,matches:c}=Pb(),u=x.useMemo(()=>cm(t,e,c,s,r,"data"),[t,e,c,s,r]),d=x.useMemo(()=>cm(t,e,c,s,r,"assets"),[t,e,c,s,r]),h=x.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let _=new Set,v=!1;if(e.forEach(g=>{var m;let p=s.routes[g.route.id];!p||!p.hasLoader||(!u.some(w=>w.route.id===g.route.id)&&g.route.id in l&&((m=i[g.route.id])!=null&&m.shouldRevalidate)||p.hasClientLoader?v=!0:_.add(g.route.id))}),_.size===0)return[];let S=Nb(t,a,"data");return v&&_.size>0&&S.searchParams.set("_routes",e.filter(g=>_.has(g.route.id)).map(g=>g.route.id).join(",")),[S.pathname+S.search]},[a,l,r,s,u,e,t,i]),f=x.useMemo(()=>Eb(d,s),[d,s]),y=Ab(d);return x.createElement(x.Fragment,null,h.map(_=>x.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...n})),f.map(_=>x.createElement("link",{key:_,rel:"modulepreload",href:_,...n})),y.map(({key:_,link:v})=>x.createElement("link",{key:_,nonce:n.nonce,...v})))}function Lb(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Xy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Xy&&(window.__reactRouterVersion="7.8.2")}catch{}function Ob({basename:t,children:e,window:n}){let r=x.useRef();r.current==null&&(r.current=SN({window:n,v5Compat:!0}));let s=r.current,[i,a]=x.useState({action:s.action,location:s.location}),l=x.useCallback(c=>{x.startTransition(()=>a(c))},[a]);return x.useLayoutEffect(()=>s.listen(l),[s,l]),x.createElement(hb,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var Jy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zy=x.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:a,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h,...f},y){let{basename:_}=x.useContext(jn),v=typeof u=="string"&&Jy.test(u),S,g=!1;if(typeof u=="string"&&v&&(S=u,Xy))try{let R=new URL(window.location.href),I=u.startsWith("//")?new URL(R.protocol+u):new URL(u),G=Yn(I.pathname,_);I.origin===R.origin&&G!=null?u=G+I.search+I.hash:g=!0}catch{kn(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let p=XN(u,{relative:s}),[m,w,N]=Ib(r,f),C=Ub(u,{replace:a,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function k(R){e&&e(R),R.defaultPrevented||C(R)}let T=x.createElement("a",{...f,...N,href:S||p,onClick:g||i?e:k,ref:Lb(y,w),target:c,"data-discover":!v&&n==="render"?"true":void 0});return m&&!v?x.createElement(x.Fragment,null,T,x.createElement(Rb,{page:p})):T});Zy.displayName="Link";var Mb=x.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:a,viewTransition:l,children:c,...u},d){let h=Go(a,{relative:u.relative}),f=nn(),y=x.useContext(pc),{navigator:_,basename:v}=x.useContext(jn),S=y!=null&&Vb(h)&&l===!0,g=_.encodeLocation?_.encodeLocation(h).pathname:h.pathname,p=f.pathname,m=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;n||(p=p.toLowerCase(),m=m?m.toLowerCase():null,g=g.toLowerCase()),m&&v&&(m=Yn(m,v)||m);const w=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let N=p===g||!s&&p.startsWith(g)&&p.charAt(w)==="/",C=m!=null&&(m===g||!s&&m.startsWith(g)&&m.charAt(g.length)==="/"),k={isActive:N,isPending:C,isTransitioning:S},T=N?e:void 0,R;typeof r=="function"?R=r(k):R=[r,N?"active":null,C?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let I=typeof i=="function"?i(k):i;return x.createElement(Zy,{...u,"aria-current":T,className:R,ref:d,style:I,to:a,viewTransition:l},typeof c=="function"?c(k):c)});Mb.displayName="NavLink";var Fb=x.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:a=Ha,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:h,...f},y)=>{let _=Hb(),v=Wb(l,{relative:u}),S=a.toLowerCase()==="get"?"get":"post",g=typeof l=="string"&&Jy.test(l),p=m=>{if(c&&c(m),m.defaultPrevented)return;m.preventDefault();let w=m.nativeEvent.submitter,N=(w==null?void 0:w.getAttribute("formmethod"))||a;_(w||m.currentTarget,{fetcherKey:e,method:N,navigate:n,replace:s,state:i,relative:u,preventScrollReset:d,viewTransition:h})};return x.createElement("form",{ref:y,method:S,action:v,onSubmit:r?c:p,...f,"data-discover":!g&&t==="render"?"true":void 0})});Fb.displayName="Form";function $b(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ex(t){let e=x.useContext(_i);return Be(e,$b(t)),e}function Ub(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:a}={}){let l=Br(),c=nn(),u=Go(t,{relative:i});return x.useCallback(d=>{if(xb(d,e)){d.preventDefault();let h=n!==void 0?n:jo(c)===jo(u);l(t,{replace:h,state:r,preventScrollReset:s,relative:i,viewTransition:a})}},[c,l,u,n,r,e,t,s,i,a])}var zb=0,Bb=()=>`__${String(++zb)}__`;function Hb(){let{router:t}=ex("useSubmit"),{basename:e}=x.useContext(jn),n=lb();return x.useCallback(async(r,s={})=>{let{action:i,method:a,encType:l,formData:c,body:u}=wb(r,e);if(s.navigate===!1){let d=s.fetcherKey||Bb();await t.fetch(d,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||a,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||a,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function Wb(t,{relative:e}={}){let{basename:n}=x.useContext(jn),r=x.useContext(Tn);Be(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...Go(t||".",{relative:e})},a=nn();if(t==null){i.search=a.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(h=>h).forEach(h=>l.append("index",h));let d=l.toString();i.search=d?`?${d}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:Hn([n,i.pathname])),jo(i)}function Vb(t,{relative:e}={}){let n=x.useContext(Hy);Be(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=ex("useViewTransitionState"),s=Go(t,{relative:e});if(!n.isTransitioning)return!1;let i=Yn(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=Yn(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Nl(s.pathname,a)!=null||Nl(s.pathname,i)!=null}const qb="modulepreload",Gb=function(t){return"/"+t},um={},is=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=Gb(c),c in um)return;um[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":qb,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,y)=>{h.addEventListener("load",f),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Kb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ae=(t,e)=>{const n=x.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:l="",children:c,...u},d)=>x.createElement("svg",{ref:d,...Kb,width:s,height:s,stroke:r,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Qb(t)}`,l].join(" "),...u},[...e.map(([h,f])=>x.createElement(h,f)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=ae("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=ae("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=ae("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=ae("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=ae("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dm=ae("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xb=ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=ae("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=ae("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=ae("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vh=ae("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jb=ae("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=ae("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hm=ae("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fm=ae("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zb=ae("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=ae("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=ae("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=ae("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=ae("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=ae("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=ae("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=ae("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=ae("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=ae("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rx=ae("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=ae("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=ae("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=ae("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=ae("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),cS=()=>{};var pm={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sx={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A=function(t,e){if(!t)throw vi(e)},vi=function(t){return new Error("Firebase Database ("+sx.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},uS=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Kh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|u>>6,y=u&63;c||(y=64,a||(f=64)),r.push(n[d],n[h],n[f],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ix(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):uS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new dS;const f=i<<2|l>>4;if(r.push(f),u!==64){const y=l<<4&240|u>>2;if(r.push(y),h!==64){const _=u<<6&192|h;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class dS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ox=function(t){const e=ix(t);return Kh.encodeByteArray(e,!0)},kl=function(t){return ox(t).replace(/\./g,"")},jl=function(t){try{return Kh.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){return ax(void 0,t)}function ax(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!fS(n)||(t[n]=ax(t[n],e[n]));return t}function fS(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS=()=>pS().__FIREBASE_DEFAULTS__,gS=()=>{if(typeof process>"u"||typeof pm>"u")return;const t=pm.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},yS=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&jl(t[1]);return e&&JSON.parse(e)},Qh=()=>{try{return cS()||mS()||gS()||yS()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},lx=t=>{var e,n;return(n=(e=Qh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},xS=t=>{const e=lx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},cx=()=>{var t;return(t=Qh())==null?void 0:t.config},ux=t=>{var e;return(e=Qh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dx(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _S(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[kl(JSON.stringify(n)),kl(JSON.stringify(a)),""].join(".")}const ro={};function vS(){const t={prod:[],emulator:[]};for(const e of Object.keys(ro))ro[e]?t.emulator.push(e):t.prod.push(e);return t}function wS(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let mm=!1;function hx(t,e){if(typeof window>"u"||typeof document>"u"||!wi(window.location.host)||ro[t]===e||ro[t]||mm)return;ro[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=vS().prod.length>0;function a(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,y){f.setAttribute("width","24"),f.setAttribute("id",y),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{mm=!0,a()},f}function d(f,y){f.setAttribute("id",y),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=wS(r),y=n("text"),_=document.getElementById(y)||document.createElement("span"),v=n("learnmore"),S=document.getElementById(v)||document.createElement("a"),g=n("preprendIcon"),p=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const m=f.element;l(m),d(S,v);const w=u();c(p,g),m.append(p,_,S,w),document.body.appendChild(m)}i?(_.innerText="Preview backend disconnected.",p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Yh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ct())}function NS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function fx(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function SS(){const t=Ct();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function px(){return sx.NODE_ADMIN===!0}function CS(){try{return typeof indexedDB=="object"}catch{return!1}}function ES(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kS="FirebaseError";class Hr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=kS,Object.setPrototypeOf(this,Hr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qo.prototype.create)}}class Qo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?jS(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Hr(s,l,r)}}function jS(t,e){return t.replace(TS,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const TS=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function To(t){return JSON.parse(t)}function tt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=To(jl(i[0])||""),n=To(jl(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},PS=function(t){const e=mx(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},IS=function(t){const e=mx(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function oi(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function bd(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Tl(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function ds(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(gm(i)&&gm(a)){if(!ds(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function gm(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ni(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const f=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(f<<1|f>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4],u,d;for(let h=0;h<80;h++){h<40?h<20?(u=l^i&(a^l),d=1518500249):(u=i^a^l,d=1859775393):h<60?(u=i&a|l&(i|a),d=2400959708):(u=i^a^l,d=3395469782);const f=(s<<5|s>>>27)+u+c+d+r[h]&4294967295;c=l,l=a,a=(i<<30|i>>>2)&4294967295,i=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let a=this.inbuf_;for(;s<n;){if(a===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[a]=e.charCodeAt(s),++a,++s,a===this.blockSize){this.compress_(i),a=0;break}}else for(;s<n;)if(i[a]=e[s],++a,++s,a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function AS(t,e){const n=new DS(t,e);return n.subscribe.bind(n)}class DS{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");LS(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=hu),s.error===void 0&&(s.error=hu),s.complete===void 0&&(s.complete=hu);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function LS(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function hu(){}function gc(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,A(r<t.length,"Surrogate pair missing trail surrogate.");const a=t.charCodeAt(r)-56320;s=65536+(i<<10)+a}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},yc=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(t){return t&&t._delegate?t._delegate:t}class hs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ko;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($S(e))try{this.getOrInitializeService({instanceIdentifier:Xr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Xr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xr){return this.instances.has(e)}getOptions(e=Xr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:FS(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xr){return this.component?this.component.multipleInstances?e:Xr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function FS(t){return t===Xr?void 0:t}function $S(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new MS(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ve||(ve={}));const zS={debug:ve.DEBUG,verbose:ve.VERBOSE,info:ve.INFO,warn:ve.WARN,error:ve.ERROR,silent:ve.SILENT},BS=ve.INFO,HS={[ve.DEBUG]:"log",[ve.VERBOSE]:"log",[ve.INFO]:"info",[ve.WARN]:"warn",[ve.ERROR]:"error"},WS=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=HS[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Xh{constructor(e){this.name=e,this._logLevel=BS,this._logHandler=WS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?zS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ve.DEBUG,...e),this._logHandler(this,ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ve.VERBOSE,...e),this._logHandler(this,ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ve.INFO,...e),this._logHandler(this,ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ve.WARN,...e),this._logHandler(this,ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ve.ERROR,...e),this._logHandler(this,ve.ERROR,...e)}}const VS=(t,e)=>e.some(n=>t instanceof n);let ym,xm;function qS(){return ym||(ym=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function GS(){return xm||(xm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gx=new WeakMap,Sd=new WeakMap,yx=new WeakMap,fu=new WeakMap,Jh=new WeakMap;function KS(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(kr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&gx.set(n,t)}).catch(()=>{}),Jh.set(e,t),e}function QS(t){if(Sd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Sd.set(t,e)}let Cd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Sd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||yx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return kr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function YS(t){Cd=t(Cd)}function XS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(pu(this),e,...n);return yx.set(r,e.sort?e.sort():[e]),kr(r)}:GS().includes(t)?function(...e){return t.apply(pu(this),e),kr(gx.get(this))}:function(...e){return kr(t.apply(pu(this),e))}}function JS(t){return typeof t=="function"?XS(t):(t instanceof IDBTransaction&&QS(t),VS(t,qS())?new Proxy(t,Cd):t)}function kr(t){if(t instanceof IDBRequest)return KS(t);if(fu.has(t))return fu.get(t);const e=JS(t);return e!==t&&(fu.set(t,e),Jh.set(e,t)),e}const pu=t=>Jh.get(t);function ZS(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=kr(a);return r&&a.addEventListener("upgradeneeded",c=>{r(kr(a.result),c.oldVersion,c.newVersion,kr(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const eC=["get","getKey","getAll","getAllKeys","count"],tC=["put","add","delete","clear"],mu=new Map;function _m(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(mu.get(e))return mu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=tC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||eC.includes(n)))return;const i=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return mu.set(e,i),i}YS(t=>({...t,get:(e,n,r)=>_m(e,n)||t.get(e,n,r),has:(e,n)=>!!_m(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(rC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function rC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ed="@firebase/app",vm="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn=new Xh("@firebase/app"),sC="@firebase/app-compat",iC="@firebase/analytics-compat",oC="@firebase/analytics",aC="@firebase/app-check-compat",lC="@firebase/app-check",cC="@firebase/auth",uC="@firebase/auth-compat",dC="@firebase/database",hC="@firebase/data-connect",fC="@firebase/database-compat",pC="@firebase/functions",mC="@firebase/functions-compat",gC="@firebase/installations",yC="@firebase/installations-compat",xC="@firebase/messaging",_C="@firebase/messaging-compat",vC="@firebase/performance",wC="@firebase/performance-compat",NC="@firebase/remote-config",bC="@firebase/remote-config-compat",SC="@firebase/storage",CC="@firebase/storage-compat",EC="@firebase/firestore",kC="@firebase/ai",jC="@firebase/firestore-compat",TC="firebase",PC="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kd="[DEFAULT]",IC={[Ed]:"fire-core",[sC]:"fire-core-compat",[oC]:"fire-analytics",[iC]:"fire-analytics-compat",[lC]:"fire-app-check",[aC]:"fire-app-check-compat",[cC]:"fire-auth",[uC]:"fire-auth-compat",[dC]:"fire-rtdb",[hC]:"fire-data-connect",[fC]:"fire-rtdb-compat",[pC]:"fire-fn",[mC]:"fire-fn-compat",[gC]:"fire-iid",[yC]:"fire-iid-compat",[xC]:"fire-fcm",[_C]:"fire-fcm-compat",[vC]:"fire-perf",[wC]:"fire-perf-compat",[NC]:"fire-rc",[bC]:"fire-rc-compat",[SC]:"fire-gcs",[CC]:"fire-gcs-compat",[EC]:"fire-fst",[jC]:"fire-fst-compat",[kC]:"fire-vertex","fire-js":"fire-js",[TC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl=new Map,RC=new Map,jd=new Map;function wm(t,e){try{t.container.addComponent(e)}catch(n){Xn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ai(t){const e=t.name;if(jd.has(e))return Xn.debug(`There were multiple attempts to register component ${e}.`),!1;jd.set(e,t);for(const n of Pl.values())wm(n,t);for(const n of RC.values())wm(n,t);return!0}function Zh(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function dn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},jr=new Qo("app","Firebase",AC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw jr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi=PC;function xx(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:kd,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw jr.create("bad-app-name",{appName:String(s)});if(n||(n=cx()),!n)throw jr.create("no-options");const i=Pl.get(s);if(i){if(ds(n,i.options)&&ds(r,i.config))return i;throw jr.create("duplicate-app",{appName:s})}const a=new US(s);for(const c of jd.values())a.addComponent(c);const l=new DC(n,r,a);return Pl.set(s,l),l}function _x(t=kd){const e=Pl.get(t);if(!e&&t===kd&&cx())return xx();if(!e)throw jr.create("no-app",{appName:t});return e}function Tr(t,e,n){let r=IC[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xn.warn(a.join(" "));return}ai(new hs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC="firebase-heartbeat-database",OC=1,Po="firebase-heartbeat-store";let gu=null;function vx(){return gu||(gu=ZS(LC,OC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Po)}catch(n){console.warn(n)}}}}).catch(t=>{throw jr.create("idb-open",{originalErrorMessage:t.message})})),gu}async function MC(t){try{const n=(await vx()).transaction(Po),r=await n.objectStore(Po).get(wx(t));return await n.done,r}catch(e){if(e instanceof Hr)Xn.warn(e.message);else{const n=jr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xn.warn(n.message)}}}async function Nm(t,e){try{const r=(await vx()).transaction(Po,"readwrite");await r.objectStore(Po).put(e,wx(t)),await r.done}catch(n){if(n instanceof Hr)Xn.warn(n.message);else{const r=jr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Xn.warn(r.message)}}}function wx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC=1024,$C=30;class UC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new BC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=bm();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>$C){const a=HC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Xn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=bm(),{heartbeatsToSend:r,unsentEntries:s}=zC(this._heartbeatsCache.heartbeats),i=kl(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Xn.warn(n),""}}}function bm(){return new Date().toISOString().substring(0,10)}function zC(t,e=FC){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Sm(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Sm(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class BC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return CS()?ES().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await MC(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Nm(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Nm(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Sm(t){return kl(JSON.stringify({version:2,heartbeats:t})).length}function HC(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(t){ai(new hs("platform-logger",e=>new nC(e),"PRIVATE")),ai(new hs("heartbeat",e=>new UC(e),"PRIVATE")),Tr(Ed,vm,t),Tr(Ed,vm,"esm2020"),Tr("fire-js","")}WC("");var Cm={};const Em="@firebase/database",km="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nx="";function bx(t){Nx=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),tt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:To(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Pn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sx=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new VC(e)}}catch{}return new qC},ns=Sx("localStorage"),GC=Sx("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs=new Xh("@firebase/database"),KC=function(){let t=1;return function(){return t++}}(),Cx=function(t){const e=OS(t),n=new RS;n.update(e);const r=n.digest();return Kh.encodeByteArray(r)},Yo=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Yo.apply(null,r):typeof r=="object"?e+=tt(r):e+=r,e+=" "}return e};let so=null,jm=!0;const QC=function(t,e){A(!e,"Can't turn on custom loggers persistently."),Gs.logLevel=ve.VERBOSE,so=Gs.log.bind(Gs)},ct=function(...t){if(jm===!0&&(jm=!1,so===null&&GC.get("logging_enabled")===!0&&QC()),so){const e=Yo.apply(null,t);so(e)}},Xo=function(t){return function(...e){ct(t,...e)}},Td=function(...t){const e="FIREBASE INTERNAL ERROR: "+Yo(...t);Gs.error(e)},Jn=function(...t){const e=`FIREBASE FATAL ERROR: ${Yo(...t)}`;throw Gs.error(e),new Error(e)},bt=function(...t){const e="FIREBASE WARNING: "+Yo(...t);Gs.warn(e)},YC=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&bt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ef=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},XC=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},li="[MIN_NAME]",fs="[MAX_NAME]",_s=function(t,e){if(t===e)return 0;if(t===li||e===fs)return-1;if(e===li||t===fs)return 1;{const n=Tm(t),r=Tm(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},JC=function(t,e){return t===e?0:t<e?-1:1},$i=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+tt(e))},tf=function(t){if(typeof t!="object"||t===null)return tt(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=tt(e[r]),n+=":",n+=tf(t[e[r]]);return n+="}",n},Ex=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function ht(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const kx=function(t){A(!ef(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,a,l,c;t===0?(i=0,a=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=l+r,a=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(i=0,a=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(c=n;c;c-=1)u.push(a%2?1:0),a=Math.floor(a/2);for(c=e;c;c-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(s?1:0),u.reverse();const d=u.join("");let h="";for(c=0;c<64;c+=8){let f=parseInt(d.substr(c,8),2).toString(16);f.length===1&&(f="0"+f),h=h+f}return h.toLowerCase()},ZC=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},eE=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function tE(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const nE=new RegExp("^-?(0*)\\d{1,10}$"),rE=-2147483648,sE=2147483647,Tm=function(t){if(nE.test(t)){const e=Number(t);if(e>=rE&&e<=sE)return e}return null},Si=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw bt("Exception was thrown by user callback.",n),e},Math.floor(0))}},iE=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},io=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,dn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){bt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',bt(e)}}class qa{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}qa.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf="5",jx="v",Tx="s",Px="r",Ix="f",Rx=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ax="ls",Dx="p",Pd="ac",Lx="websocket",Ox="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(e,n,r,s,i=!1,a="",l=!1,c=!1,u=null){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=a,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ns.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ns.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function lE(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Fx(t,e,n){A(typeof e=="string","typeof type must == string"),A(typeof n=="object","typeof params must == object");let r;if(e===Lx)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Ox)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);lE(t)&&(n.ns=t.namespace);const s=[];return ht(n,(i,a)=>{s.push(i+"="+a)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(){this.counters_={}}incrementCounter(e,n=1){Pn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return hS(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yu={},xu={};function rf(t){const e=t.toString();return yu[e]||(yu[e]=new cE),yu[e]}function uE(t,e){const n=t.toString();return xu[n]||(xu[n]=e()),xu[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&Si(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm="start",hE="close",fE="pLPCommand",pE="pRTLPCB",$x="id",Ux="pw",zx="ser",mE="cb",gE="seg",yE="ts",xE="d",_E="dframe",Bx=1870,Hx=30,vE=Bx-Hx,wE=25e3,NE=3e4;class $s{constructor(e,n,r,s,i,a,l){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=a,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Xo(e),this.stats_=rf(n),this.urlFn=c=>(this.appCheckToken&&(c[Pd]=this.appCheckToken),Fx(n,Ox,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new dE(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(NE)),XC(()=>{if(this.isClosed_)return;this.scriptTagHolder=new sf((...i)=>{const[a,l,c,u,d]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===Pm)this.id=l,this.password=c;else if(a===hE)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...i)=>{const[a,l]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(a,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[Pm]="t",r[zx]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[mE]=this.scriptTagHolder.uniqueCallbackIdentifier),r[jx]=nf,this.transportSessionId&&(r[Tx]=this.transportSessionId),this.lastSessionId&&(r[Ax]=this.lastSessionId),this.applicationId&&(r[Dx]=this.applicationId),this.appCheckToken&&(r[Pd]=this.appCheckToken),typeof location<"u"&&location.hostname&&Rx.test(location.hostname)&&(r[Px]=Ix);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){$s.forceAllow_=!0}static forceDisallow(){$s.forceDisallow_=!0}static isAvailable(){return $s.forceAllow_?!0:!$s.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!ZC()&&!eE()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=tt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=ox(n),s=Ex(r,vE);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[_E]="t",r[$x]=e,r[Ux]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=tt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class sf{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=KC(),window[fE+this.uniqueCallbackIdentifier]=e,window[pE+this.uniqueCallbackIdentifier]=n,this.myIFrame=sf.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(l){ct("frame writing exception"),l.stack&&ct(l.stack),ct(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ct("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[$x]=this.myID,e[Ux]=this.myPW,e[zx]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Hx+r.length<=Bx;){const a=this.pendingSegs.shift();r=r+"&"+gE+s+"="+a.seg+"&"+yE+s+"="+a.ts+"&"+xE+s+"="+a.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(wE)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE=16384,SE=45e3;let Il=null;typeof MozWebSocket<"u"?Il=MozWebSocket:typeof WebSocket<"u"&&(Il=WebSocket);class hn{constructor(e,n,r,s,i,a,l){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Xo(this.connId),this.stats_=rf(n),this.connURL=hn.connectionURL_(n,a,l,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const a={};return a[jx]=nf,typeof location<"u"&&location.hostname&&Rx.test(location.hostname)&&(a[Px]=Ix),n&&(a[Tx]=n),r&&(a[Ax]=r),s&&(a[Pd]=s),i&&(a[Dx]=i),Fx(e,Lx,a)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ns.set("previous_websocket_failure",!0);try{let r;px(),this.mySock=new Il(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){hn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Il!==null&&!hn.forceDisallow_}static previouslyFailed(){return ns.isInMemoryStorage||ns.get("previous_websocket_failure")===!0}markConnectionHealthy(){ns.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=To(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(A(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=tt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Ex(n,bE);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(SE))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}hn.responsesRequiredToBeHealthy=2;hn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{static get ALL_TRANSPORTS(){return[$s,hn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=hn&&hn.isAvailable();let r=n&&!hn.previouslyFailed();if(e.webSocketOnly&&(n||bt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[hn];else{const s=this.transports_=[];for(const i of Io.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);Io.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Io.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE=6e4,EE=5e3,kE=10*1024,jE=100*1024,_u="t",Im="d",TE="s",Rm="r",PE="e",Am="o",Dm="a",Lm="n",Om="p",IE="h";class RE{constructor(e,n,r,s,i,a,l,c,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=a,this.onReady_=l,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Xo("c:"+this.id+":"),this.transportManager_=new Io(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=io(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>jE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>kE?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(_u in e){const n=e[_u];n===Dm?this.upgradeIfSecondaryHealthy_():n===Rm?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Am&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=$i("t",e),r=$i("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Om,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Dm,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Lm,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=$i("t",e),r=$i("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=$i(_u,e);if(Im in e){const r=e[Im];if(n===IE){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===Lm){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===TE?this.onConnectionShutdown_(r):n===Rm?this.onReset_(r):n===PE?Td("Server Error: "+r):n===Am?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Td("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),nf!==r&&bt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),io(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(CE))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):io(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(EE))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Om,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ns.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e){this.allowedEvents_=e,this.listeners_={},A(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){A(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl extends Vx{static getInstance(){return new Rl}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Yh()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return A(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm=32,Fm=768;class we{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ye(){return new we("")}function ie(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Lr(t){return t.pieces_.length-t.pieceNum_}function Ee(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new we(t.pieces_,e)}function of(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function AE(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ro(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function qx(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new we(e,0)}function qe(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof we)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new we(n,0)}function ue(t){return t.pieceNum_>=t.pieces_.length}function wt(t,e){const n=ie(t),r=ie(e);if(n===null)return e;if(n===r)return wt(Ee(t),Ee(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function DE(t,e){const n=Ro(t,0),r=Ro(e,0);for(let s=0;s<n.length&&s<r.length;s++){const i=_s(n[s],r[s]);if(i!==0)return i}return n.length===r.length?0:n.length<r.length?-1:1}function af(t,e){if(Lr(t)!==Lr(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Xt(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Lr(t)>Lr(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class LE{constructor(e,n){this.errorPrefix_=n,this.parts_=Ro(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=yc(this.parts_[r]);Gx(this)}}function OE(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=yc(e),Gx(t)}function ME(t){const e=t.parts_.pop();t.byteLength_-=yc(e),t.parts_.length>0&&(t.byteLength_-=1)}function Gx(t){if(t.byteLength_>Fm)throw new Error(t.errorPrefix_+"has a key path longer than "+Fm+" bytes ("+t.byteLength_+").");if(t.parts_.length>Mm)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Mm+") or object contains a cycle "+Jr(t))}function Jr(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf extends Vx{static getInstance(){return new lf}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return A(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ui=1e3,FE=60*5*1e3,$m=30*1e3,$E=1.3,UE=3e4,zE="server_kill",Um=3;class Wn extends Wx{constructor(e,n,r,s,i,a,l,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=Wn.nextPersistentConnectionId_++,this.log_=Xo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ui,this.maxReconnectDelay_=FE,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!px())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");lf.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Rl.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(tt(i)),A(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Ko,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const l=a.d;a.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),A(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),A(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(a).set(i,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},a="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(a,i,l=>{const c=l.d,u=l.s;Wn.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Pn(e,"w")){const r=oi(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();bt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||IS(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=$m)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=PS(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,a=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),A(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},a="n";s&&(i.q=r,i.t=s),this.sendRequest(a,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const a={p:n,d:r};i!==void 0&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+tt(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Td("Unrecognized action received from server: "+tt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){A(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ui,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ui,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>UE&&(this.reconnectDelay_=Ui),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*$E)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Wn.nextConnectionId_++,i=this.lastSessionId;let a=!1,l=null;const c=function(){l?l.close():(a=!0,r())},u=function(h){A(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(h)};this.realtime_={close:c,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,f]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?ct("getToken() completed but was canceled"):(ct("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,l=new RE(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,y=>{bt(y+" ("+this.repoInfo_.toString()+")"),this.interrupt(zE)},i))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&bt(h),c())}}}interrupt(e){ct("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ct("Resuming connection for reason: "+e),delete this.interruptReasons_[e],bd(this.interruptReasons_)&&(this.reconnectDelay_=Ui,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>tf(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new we(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){ct("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Um&&(this.reconnectDelay_=$m,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){ct("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Um&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Nx.replace(/\./g,"-")]=1,Yh()?e["framework.cordova"]=1:fx()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Rl.getInstance().currentlyOnline();return bd(this.interruptReasons_)&&e}}Wn.nextPersistentConnectionId_=0;Wn.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new oe(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new oe(li,e),s=new oe(li,n);return this.compare(r,s)!==0}minPost(){return oe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ea;class Kx extends xc{static get __EMPTY_NODE(){return Ea}static set __EMPTY_NODE(e){Ea=e}compare(e,n){return _s(e.name,n.name)}isDefinedOn(e){throw vi("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return oe.MIN}maxPost(){return new oe(fs,Ea)}makePost(e,n){return A(typeof e=="string","KeyIndex indexValue must always be a string."),new oe(e,Ea)}toString(){return".key"}}const Ks=new Kx;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=n?r(e.key,n):1,s&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ot{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ot.RED,this.left=s??Lt.EMPTY_NODE,this.right=i??Lt.EMPTY_NODE}copy(e,n,r,s,i){return new ot(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Lt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Lt.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ot.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ot.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ot.RED=!0;ot.BLACK=!1;class BE{copy(e,n,r,s,i){return this}insert(e,n,r){return new ot(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Lt{constructor(e,n=Lt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Lt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,ot.BLACK,null,null))}remove(e){return new Lt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ot.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ka(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ka(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ka(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ka(this.root_,null,this.comparator_,!0,e)}}Lt.EMPTY_NODE=new BE;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE(t,e){return _s(t.name,e.name)}function cf(t,e){return _s(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Id;function WE(t){Id=t}const Qx=function(t){return typeof t=="number"?"number:"+kx(t):"string:"+t},Yx=function(t){if(t.isLeafNode()){const e=t.val();A(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Pn(e,".sv"),"Priority must be a string or number.")}else A(t===Id||t.isEmpty(),"priority of unexpected type.");A(t===Id||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zm;class st{static set __childrenNodeConstructor(e){zm=e}static get __childrenNodeConstructor(){return zm}constructor(e,n=st.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,A(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Yx(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new st(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:st.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ue(e)?this:ie(e)===".priority"?this.priorityNode_:st.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:st.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=ie(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(A(r!==".priority"||Lr(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,st.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ee(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Qx(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=kx(this.value_):e+=this.value_,this.lazyHash_=Cx(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===st.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof st.__childrenNodeConstructor?-1:(A(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=st.VALUE_TYPE_ORDER.indexOf(n),i=st.VALUE_TYPE_ORDER.indexOf(r);return A(s>=0,"Unknown leaf type: "+n),A(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}st.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xx,Jx;function VE(t){Xx=t}function qE(t){Jx=t}class GE extends xc{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?_s(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return oe.MIN}maxPost(){return new oe(fs,new st("[PRIORITY-POST]",Jx))}makePost(e,n){const r=Xx(e);return new oe(n,new st("[PRIORITY-POST]",r))}toString(){return".priority"}}const Ge=new GE;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE=Math.log(2);class QE{constructor(e){const n=i=>parseInt(Math.log(i)/KE,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Al=function(t,e,n,r){t.sort(e);const s=function(c,u){const d=u-c;let h,f;if(d===0)return null;if(d===1)return h=t[c],f=n?n(h):h,new ot(f,h.node,ot.BLACK,null,null);{const y=parseInt(d/2,10)+c,_=s(c,y),v=s(y+1,u);return h=t[y],f=n?n(h):h,new ot(f,h.node,ot.BLACK,_,v)}},i=function(c){let u=null,d=null,h=t.length;const f=function(_,v){const S=h-_,g=h;h-=_;const p=s(S+1,g),m=t[S],w=n?n(m):m;y(new ot(w,m.node,v,null,p))},y=function(_){u?(u.left=_,u=_):(d=_,u=_)};for(let _=0;_<c.count;++_){const v=c.nextBitIsOne(),S=Math.pow(2,c.count-(_+1));v?f(S,ot.BLACK):(f(S,ot.BLACK),f(S,ot.RED))}return d},a=new QE(t.length),l=i(a);return new Lt(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vu;const Cs={};class $n{static get Default(){return A(Cs&&Ge,"ChildrenNode.ts has not been loaded"),vu=vu||new $n({".priority":Cs},{".priority":Ge}),vu}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=oi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Lt?n:null}hasIndex(e){return Pn(this.indexSet_,e.toString())}addIndex(e,n){A(e!==Ks,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(oe.Wrap);let a=i.getNext();for(;a;)s=s||e.isDefinedOn(a.node),r.push(a),a=i.getNext();let l;s?l=Al(r,e.getCompare()):l=Cs;const c=e.toString(),u={...this.indexSet_};u[c]=e;const d={...this.indexes_};return d[c]=l,new $n(d,u)}addToIndexes(e,n){const r=Tl(this.indexes_,(s,i)=>{const a=oi(this.indexSet_,i);if(A(a,"Missing index implementation for "+i),s===Cs)if(a.isDefinedOn(e.node)){const l=[],c=n.getIterator(oe.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&l.push(u),u=c.getNext();return l.push(e),Al(l,a.getCompare())}else return Cs;else{const l=n.get(e.name);let c=s;return l&&(c=c.remove(new oe(e.name,l))),c.insert(e,e.node)}});return new $n(r,this.indexSet_)}removeFromIndexes(e,n){const r=Tl(this.indexes_,s=>{if(s===Cs)return s;{const i=n.get(e.name);return i?s.remove(new oe(e.name,i)):s}});return new $n(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zi;class X{static get EMPTY_NODE(){return zi||(zi=new X(new Lt(cf),null,$n.Default))}constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Yx(this.priorityNode_),this.children_.isEmpty()&&A(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||zi}updatePriority(e){return this.children_.isEmpty()?this:new X(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?zi:n}}getChild(e){const n=ie(e);return n===null?this:this.getImmediateChild(n).getChild(Ee(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(A(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new oe(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const a=s.isEmpty()?zi:this.priorityNode_;return new X(s,a,i)}}updateChild(e,n){const r=ie(e);if(r===null)return n;{A(ie(e)!==".priority"||Lr(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Ee(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(Ge,(a,l)=>{n[a]=l.val(e),r++,i&&X.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):i=!1}),!e&&i&&s<2*r){const a=[];for(const l in n)a[l]=n[l];return a}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Qx(this.getPriority().val())+":"),this.forEachChild(Ge,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":Cx(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new oe(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new oe(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new oe(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,oe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,oe.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Jo?-1:0}withIndex(e){if(e===Ks||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new X(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Ks||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Ge),s=n.getIterator(Ge);let i=r.getNext(),a=s.getNext();for(;i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=r.getNext(),a=s.getNext()}return i===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===Ks?null:this.indexMap_.get(e.toString())}}X.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class YE extends X{constructor(){super(new Lt(cf),X.EMPTY_NODE,$n.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return X.EMPTY_NODE}isEmpty(){return!1}}const Jo=new YE;Object.defineProperties(oe,{MIN:{value:new oe(li,X.EMPTY_NODE)},MAX:{value:new oe(fs,Jo)}});Kx.__EMPTY_NODE=X.EMPTY_NODE;st.__childrenNodeConstructor=X;WE(Jo);qE(Jo);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=!0;function et(t,e=null){if(t===null)return X.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),A(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new st(n,et(e))}if(!(t instanceof Array)&&XE){const n=[];let r=!1;if(ht(t,(a,l)=>{if(a.substring(0,1)!=="."){const c=et(l);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new oe(a,c)))}}),n.length===0)return X.EMPTY_NODE;const i=Al(n,HE,a=>a.name,cf);if(r){const a=Al(n,Ge.getCompare());return new X(i,et(e),new $n({".priority":a},{".priority":Ge}))}else return new X(i,et(e),$n.Default)}else{let n=X.EMPTY_NODE;return ht(t,(r,s)=>{if(Pn(t,r)&&r.substring(0,1)!=="."){const i=et(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(et(e))}}VE(et);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE extends xc{constructor(e){super(),this.indexPath_=e,A(!ue(e)&&ie(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?_s(e.name,n.name):i}makePost(e,n){const r=et(e),s=X.EMPTY_NODE.updateChild(this.indexPath_,r);return new oe(n,s)}maxPost(){const e=X.EMPTY_NODE.updateChild(this.indexPath_,Jo);return new oe(fs,e)}toString(){return Ro(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE extends xc{compare(e,n){const r=e.node.compareTo(n.node);return r===0?_s(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return oe.MIN}maxPost(){return oe.MAX}makePost(e,n){const r=et(e);return new oe(n,r)}toString(){return".value"}}const ek=new ZE;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(t){return{type:"value",snapshotNode:t}}function ci(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ao(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Do(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function tk(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e){this.index_=e}updateChild(e,n,r,s,i,a){A(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(s).equals(r.getChild(s))&&l.isEmpty()===r.isEmpty()||(a!=null&&(r.isEmpty()?e.hasChild(n)?a.trackChildChange(Ao(n,l)):A(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?a.trackChildChange(ci(n,r)):a.trackChildChange(Do(n,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ge,(s,i)=>{n.hasChild(s)||r.trackChildChange(Ao(s,i))}),n.isLeafNode()||n.forEachChild(Ge,(s,i)=>{if(e.hasChild(s)){const a=e.getImmediateChild(s);a.equals(i)||r.trackChildChange(Do(s,i,a))}else r.trackChildChange(ci(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?X.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e){this.indexedFilter_=new uf(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Lo.getStartPost_(e),this.endPost_=Lo.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,a){return this.matches(new oe(n,r))||(r=X.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,a)}updateFullNode(e,n,r){n.isLeafNode()&&(n=X.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(X.EMPTY_NODE);const i=this;return n.forEachChild(Ge,(a,l)=>{i.matches(new oe(a,l))||(s=s.updateImmediateChild(a,X.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Lo(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,a){return this.rangedFilter_.matches(new oe(n,r))||(r=X.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,a):this.fullLimitUpdateChild_(e,n,r,i,a)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=X.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=X.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;i.hasNext()&&a<this.limit_;){const l=i.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),a++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(X.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let a=0;for(;i.hasNext();){const l=i.getNext();a<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?a++:s=s.updateImmediateChild(l.name,X.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let a;if(this.reverse_){const h=this.index_.getCompare();a=(f,y)=>h(y,f)}else a=this.index_.getCompare();const l=e;A(l.numChildren()===this.limit_,"");const c=new oe(n,r),u=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(l.hasChild(n)){const h=l.getImmediateChild(n);let f=s.getChildAfterChild(this.index_,u,this.reverse_);for(;f!=null&&(f.name===n||l.hasChild(f.name));)f=s.getChildAfterChild(this.index_,f,this.reverse_);const y=f==null?1:a(f,c);if(d&&!r.isEmpty()&&y>=0)return i!=null&&i.trackChildChange(Do(n,r,h)),l.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(Ao(n,h));const v=l.updateImmediateChild(n,X.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(i!=null&&i.trackChildChange(ci(f.name,f.node)),v.updateImmediateChild(f.name,f.node)):v}}else return r.isEmpty()?e:d&&a(u,c)>=0?(i!=null&&(i.trackChildChange(Ao(u.name,u.node)),i.trackChildChange(ci(n,r))),l.updateImmediateChild(n,r).updateImmediateChild(u.name,X.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ge}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return A(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return A(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:li}hasEnd(){return this.endSet_}getIndexEndValue(){return A(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return A(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:fs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return A(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ge}copy(){const e=new _c;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function rk(t){return t.loadsAllData()?new uf(t.getIndex()):t.hasLimit()?new nk(t):new Lo(t)}function Bm(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ge?n="$priority":t.index_===ek?n="$value":t.index_===Ks?n="$key":(A(t.index_ instanceof JE,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=tt(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=tt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+tt(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=tt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+tt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Hm(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ge&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl extends Wx{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(A(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=Xo("p:rest:"),this.listens_={}}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const a=Dl.getListenId_(e,r),l={};this.listens_[a]=l;const c=Bm(e._queryParams);this.restRequest_(i+".json",c,(u,d)=>{let h=d;if(u===404&&(h=null,u=null),u===null&&this.onDataUpdate_(i,h,!1,r),oi(this.listens_,a)===l){let f;u?u===401?f="permission_denied":f="rest_error:"+u:f="ok",s(f,null)}})}unlisten(e,n){const r=Dl.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Bm(e._queryParams),r=e._path.toString(),s=new Ko;return this.restRequest_(r+".json",n,(i,a)=>{let l=a;i===404&&(l=null,i=null),i===null?(this.onDataUpdate_(r,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ni(n);this.log_("Sending REST request for "+a);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+a+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=To(l.responseText)}catch{bt("Failed to parse JSON response for "+a+": "+l.responseText)}r(null,c)}else l.status!==401&&l.status!==404&&bt("Got unsuccessful REST response for "+a+" Status: "+l.status),r(l.status);r=null}},l.open("GET",a,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(){this.rootNode_=X.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(){return{value:null,children:new Map}}function e_(t,e,n){if(ue(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=ie(e);t.children.has(r)||t.children.set(r,Ll());const s=t.children.get(r);e=Ee(e),e_(s,e,n)}}function Rd(t,e,n){t.value!==null?n(e,t.value):ik(t,(r,s)=>{const i=new we(e.toString()+"/"+r);Rd(s,i,n)})}function ik(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&ht(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm=10*1e3,ak=30*1e3,lk=5*60*1e3;class ck{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new ok(e);const r=Wm+(ak-Wm)*Math.random();io(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;ht(e,(s,i)=>{i>0&&Pn(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),io(this.reportStats_.bind(this),Math.floor(Math.random()*2*lk))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(fn||(fn={}));function df(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function hf(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ff(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=fn.ACK_USER_WRITE,this.source=df()}operationForChild(e){if(ue(this.path)){if(this.affectedTree.value!=null)return A(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new we(e));return new Ol(ye(),n,this.revert)}}else return A(ie(this.path)===e,"operationForChild called for unrelated child."),new Ol(Ee(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,n){this.source=e,this.path=n,this.type=fn.LISTEN_COMPLETE}operationForChild(e){return ue(this.path)?new Oo(this.source,ye()):new Oo(this.source,Ee(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=fn.OVERWRITE}operationForChild(e){return ue(this.path)?new ps(this.source,ye(),this.snap.getImmediateChild(e)):new ps(this.source,Ee(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=fn.MERGE}operationForChild(e){if(ue(this.path)){const n=this.children.subtree(new we(e));return n.isEmpty()?null:n.value?new ps(this.source,ye(),n.value):new ui(this.source,ye(),n)}else return A(ie(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ui(this.source,Ee(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ue(e))return this.isFullyInitialized()&&!this.filtered_;const n=ie(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function dk(t,e,n,r){const s=[],i=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&i.push(tk(a.childName,a.snapshotNode))}),Bi(t,s,"child_removed",e,r,n),Bi(t,s,"child_added",e,r,n),Bi(t,s,"child_moved",i,r,n),Bi(t,s,"child_changed",e,r,n),Bi(t,s,"value",e,r,n),s}function Bi(t,e,n,r,s,i){const a=r.filter(l=>l.type===n);a.sort((l,c)=>fk(t,l,c)),a.forEach(l=>{const c=hk(t,l,i);s.forEach(u=>{u.respondsTo(l.type)&&e.push(u.createEvent(c,t.query_))})})}function hk(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function fk(t,e,n){if(e.childName==null||n.childName==null)throw vi("Should only compare child_ events.");const r=new oe(e.childName,e.snapshotNode),s=new oe(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(t,e){return{eventCache:t,serverCache:e}}function oo(t,e,n,r){return vc(new Or(e,n,r),t.serverCache)}function t_(t,e,n,r){return vc(t.eventCache,new Or(e,n,r))}function Ml(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function ms(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wu;const pk=()=>(wu||(wu=new Lt(JC)),wu);class Ce{static fromObject(e){let n=new Ce(null);return ht(e,(r,s)=>{n=n.set(new we(r),s)}),n}constructor(e,n=pk()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ye(),value:this.value};if(ue(e))return null;{const r=ie(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Ee(e),n);return i!=null?{path:qe(new we(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ue(e))return this;{const n=ie(e),r=this.children.get(n);return r!==null?r.subtree(Ee(e)):new Ce(null)}}set(e,n){if(ue(e))return new Ce(n,this.children);{const r=ie(e),i=(this.children.get(r)||new Ce(null)).set(Ee(e),n),a=this.children.insert(r,i);return new Ce(this.value,a)}}remove(e){if(ue(e))return this.children.isEmpty()?new Ce(null):new Ce(null,this.children);{const n=ie(e),r=this.children.get(n);if(r){const s=r.remove(Ee(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Ce(null):new Ce(this.value,i)}else return this}}get(e){if(ue(e))return this.value;{const n=ie(e),r=this.children.get(n);return r?r.get(Ee(e)):null}}setTree(e,n){if(ue(e))return n;{const r=ie(e),i=(this.children.get(r)||new Ce(null)).setTree(Ee(e),n);let a;return i.isEmpty()?a=this.children.remove(r):a=this.children.insert(r,i),new Ce(this.value,a)}}fold(e){return this.fold_(ye(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(qe(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ye(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(ue(e))return null;{const i=ie(e),a=this.children.get(i);return a?a.findOnPath_(Ee(e),qe(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ye(),n)}foreachOnPath_(e,n,r){if(ue(e))return this;{this.value&&r(n,this.value);const s=ie(e),i=this.children.get(s);return i?i.foreachOnPath_(Ee(e),qe(n,s),r):new Ce(null)}}foreach(e){this.foreach_(ye(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(qe(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.writeTree_=e}static empty(){return new yn(new Ce(null))}}function ao(t,e,n){if(ue(e))return new yn(new Ce(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const a=wt(s,e);return i=i.updateChild(a,n),new yn(t.writeTree_.set(s,i))}else{const s=new Ce(n),i=t.writeTree_.setTree(e,s);return new yn(i)}}}function Ad(t,e,n){let r=t;return ht(n,(s,i)=>{r=ao(r,qe(e,s),i)}),r}function Vm(t,e){if(ue(e))return yn.empty();{const n=t.writeTree_.setTree(e,new Ce(null));return new yn(n)}}function Dd(t,e){return vs(t,e)!=null}function vs(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(wt(n.path,e)):null}function qm(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ge,(r,s)=>{e.push(new oe(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new oe(r,s.value))}),e}function Pr(t,e){if(ue(e))return t;{const n=vs(t,e);return n!=null?new yn(new Ce(n)):new yn(t.writeTree_.subtree(e))}}function Ld(t){return t.writeTree_.isEmpty()}function di(t,e){return n_(ye(),t.writeTree_,e)}function n_(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(A(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=n_(qe(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(qe(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wc(t,e){return o_(e,t)}function mk(t,e,n,r,s){A(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=ao(t.visibleWrites,e,n)),t.lastWriteId=r}function gk(t,e,n,r){A(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Ad(t.visibleWrites,e,n),t.lastWriteId=r}function yk(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function xk(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);A(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,a=t.allWrites.length-1;for(;s&&a>=0;){const l=t.allWrites[a];l.visible&&(a>=n&&_k(l,r.path)?s=!1:Xt(r.path,l.path)&&(i=!0)),a--}if(s){if(i)return vk(t),!0;if(r.snap)t.visibleWrites=Vm(t.visibleWrites,r.path);else{const l=r.children;ht(l,c=>{t.visibleWrites=Vm(t.visibleWrites,qe(r.path,c))})}return!0}else return!1}function _k(t,e){if(t.snap)return Xt(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Xt(qe(t.path,n),e))return!0;return!1}function vk(t){t.visibleWrites=r_(t.allWrites,wk,ye()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function wk(t){return t.visible}function r_(t,e,n){let r=yn.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const a=i.path;let l;if(i.snap)Xt(n,a)?(l=wt(n,a),r=ao(r,l,i.snap)):Xt(a,n)&&(l=wt(a,n),r=ao(r,ye(),i.snap.getChild(l)));else if(i.children){if(Xt(n,a))l=wt(n,a),r=Ad(r,l,i.children);else if(Xt(a,n))if(l=wt(a,n),ue(l))r=Ad(r,ye(),i.children);else{const c=oi(i.children,ie(l));if(c){const u=c.getChild(Ee(l));r=ao(r,ye(),u)}}}else throw vi("WriteRecord should have .snap or .children")}}return r}function s_(t,e,n,r,s){if(!r&&!s){const i=vs(t.visibleWrites,e);if(i!=null)return i;{const a=Pr(t.visibleWrites,e);if(Ld(a))return n;if(n==null&&!Dd(a,ye()))return null;{const l=n||X.EMPTY_NODE;return di(a,l)}}}else{const i=Pr(t.visibleWrites,e);if(!s&&Ld(i))return n;if(!s&&n==null&&!Dd(i,ye()))return null;{const a=function(u){return(u.visible||s)&&(!r||!~r.indexOf(u.writeId))&&(Xt(u.path,e)||Xt(e,u.path))},l=r_(t.allWrites,a,e),c=n||X.EMPTY_NODE;return di(l,c)}}}function Nk(t,e,n){let r=X.EMPTY_NODE;const s=vs(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Ge,(i,a)=>{r=r.updateImmediateChild(i,a)}),r;if(n){const i=Pr(t.visibleWrites,e);return n.forEachChild(Ge,(a,l)=>{const c=di(Pr(i,new we(a)),l);r=r.updateImmediateChild(a,c)}),qm(i).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}else{const i=Pr(t.visibleWrites,e);return qm(i).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}}function bk(t,e,n,r,s){A(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=qe(e,n);if(Dd(t.visibleWrites,i))return null;{const a=Pr(t.visibleWrites,i);return Ld(a)?s.getChild(n):di(a,s.getChild(n))}}function Sk(t,e,n,r){const s=qe(e,n),i=vs(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const a=Pr(t.visibleWrites,s);return di(a,r.getNode().getImmediateChild(n))}else return null}function Ck(t,e){return vs(t.visibleWrites,e)}function Ek(t,e,n,r,s,i,a){let l;const c=Pr(t.visibleWrites,e),u=vs(c,ye());if(u!=null)l=u;else if(n!=null)l=di(c,n);else return[];if(l=l.withIndex(a),!l.isEmpty()&&!l.isLeafNode()){const d=[],h=a.getCompare(),f=i?l.getReverseIteratorFrom(r,a):l.getIteratorFrom(r,a);let y=f.getNext();for(;y&&d.length<s;)h(y,r)!==0&&d.push(y),y=f.getNext();return d}else return[]}function kk(){return{visibleWrites:yn.empty(),allWrites:[],lastWriteId:-1}}function Fl(t,e,n,r){return s_(t.writeTree,t.treePath,e,n,r)}function pf(t,e){return Nk(t.writeTree,t.treePath,e)}function Gm(t,e,n,r){return bk(t.writeTree,t.treePath,e,n,r)}function $l(t,e){return Ck(t.writeTree,qe(t.treePath,e))}function jk(t,e,n,r,s,i){return Ek(t.writeTree,t.treePath,e,n,r,s,i)}function mf(t,e,n){return Sk(t.writeTree,t.treePath,e,n)}function i_(t,e){return o_(qe(t.treePath,e),t.writeTree)}function o_(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;A(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),A(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Do(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,Ao(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,ci(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Do(r,e.snapshotNode,s.oldSnap));else throw vi("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const a_=new Pk;class gf{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Or(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return mf(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ms(this.viewCache_),i=jk(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(t){return{filter:t}}function Rk(t,e){A(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),A(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Ak(t,e,n,r,s){const i=new Tk;let a,l;if(n.type===fn.OVERWRITE){const u=n;u.source.fromUser?a=Od(t,e,u.path,u.snap,r,s,i):(A(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered()&&!ue(u.path),a=Ul(t,e,u.path,u.snap,r,s,l,i))}else if(n.type===fn.MERGE){const u=n;u.source.fromUser?a=Lk(t,e,u.path,u.children,r,s,i):(A(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered(),a=Md(t,e,u.path,u.children,r,s,l,i))}else if(n.type===fn.ACK_USER_WRITE){const u=n;u.revert?a=Fk(t,e,u.path,r,s,i):a=Ok(t,e,u.path,u.affectedTree,r,s,i)}else if(n.type===fn.LISTEN_COMPLETE)a=Mk(t,e,n.path,r,i);else throw vi("Unknown operation type: "+n.type);const c=i.getChanges();return Dk(e,a,c),{viewCache:a,changes:c}}function Dk(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Ml(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(Zx(Ml(e)))}}function l_(t,e,n,r,s,i){const a=e.eventCache;if($l(r,n)!=null)return e;{let l,c;if(ue(n))if(A(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=ms(e),d=u instanceof X?u:X.EMPTY_NODE,h=pf(r,d);l=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const u=Fl(r,ms(e));l=t.filter.updateFullNode(e.eventCache.getNode(),u,i)}else{const u=ie(n);if(u===".priority"){A(Lr(n)===1,"Can't have a priority with additional path components");const d=a.getNode();c=e.serverCache.getNode();const h=Gm(r,n,d,c);h!=null?l=t.filter.updatePriority(d,h):l=a.getNode()}else{const d=Ee(n);let h;if(a.isCompleteForChild(u)){c=e.serverCache.getNode();const f=Gm(r,n,a.getNode(),c);f!=null?h=a.getNode().getImmediateChild(u).updateChild(d,f):h=a.getNode().getImmediateChild(u)}else h=mf(r,u,e.serverCache);h!=null?l=t.filter.updateChild(a.getNode(),u,h,d,s,i):l=a.getNode()}}return oo(e,l,a.isFullyInitialized()||ue(n),t.filter.filtersNodes())}}function Ul(t,e,n,r,s,i,a,l){const c=e.serverCache;let u;const d=a?t.filter:t.filter.getIndexedFilter();if(ue(n))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){const y=c.getNode().updateChild(n,r);u=d.updateFullNode(c.getNode(),y,null)}else{const y=ie(n);if(!c.isCompleteForPath(n)&&Lr(n)>1)return e;const _=Ee(n),S=c.getNode().getImmediateChild(y).updateChild(_,r);y===".priority"?u=d.updatePriority(c.getNode(),S):u=d.updateChild(c.getNode(),y,S,_,a_,null)}const h=t_(e,u,c.isFullyInitialized()||ue(n),d.filtersNodes()),f=new gf(s,h,i);return l_(t,h,n,s,f,l)}function Od(t,e,n,r,s,i,a){const l=e.eventCache;let c,u;const d=new gf(s,e,i);if(ue(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,a),c=oo(e,u,!0,t.filter.filtersNodes());else{const h=ie(n);if(h===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),c=oo(e,u,l.isFullyInitialized(),l.isFiltered());else{const f=Ee(n),y=l.getNode().getImmediateChild(h);let _;if(ue(f))_=r;else{const v=d.getCompleteChild(h);v!=null?of(f)===".priority"&&v.getChild(qx(f)).isEmpty()?_=v:_=v.updateChild(f,r):_=X.EMPTY_NODE}if(y.equals(_))c=e;else{const v=t.filter.updateChild(l.getNode(),h,_,f,d,a);c=oo(e,v,l.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function Km(t,e){return t.eventCache.isCompleteForChild(e)}function Lk(t,e,n,r,s,i,a){let l=e;return r.foreach((c,u)=>{const d=qe(n,c);Km(e,ie(d))&&(l=Od(t,l,d,u,s,i,a))}),r.foreach((c,u)=>{const d=qe(n,c);Km(e,ie(d))||(l=Od(t,l,d,u,s,i,a))}),l}function Qm(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function Md(t,e,n,r,s,i,a,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;ue(n)?u=r:u=new Ce(null).setTree(n,r);const d=e.serverCache.getNode();return u.children.inorderTraversal((h,f)=>{if(d.hasChild(h)){const y=e.serverCache.getNode().getImmediateChild(h),_=Qm(t,y,f);c=Ul(t,c,new we(h),_,s,i,a,l)}}),u.children.inorderTraversal((h,f)=>{const y=!e.serverCache.isCompleteForChild(h)&&f.value===null;if(!d.hasChild(h)&&!y){const _=e.serverCache.getNode().getImmediateChild(h),v=Qm(t,_,f);c=Ul(t,c,new we(h),v,s,i,a,l)}}),c}function Ok(t,e,n,r,s,i,a){if($l(s,n)!=null)return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ue(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Ul(t,e,n,c.getNode().getChild(n),s,i,l,a);if(ue(n)){let u=new Ce(null);return c.getNode().forEachChild(Ks,(d,h)=>{u=u.set(new we(d),h)}),Md(t,e,n,u,s,i,l,a)}else return e}else{let u=new Ce(null);return r.foreach((d,h)=>{const f=qe(n,d);c.isCompleteForPath(f)&&(u=u.set(d,c.getNode().getChild(f)))}),Md(t,e,n,u,s,i,l,a)}}function Mk(t,e,n,r,s){const i=e.serverCache,a=t_(e,i.getNode(),i.isFullyInitialized()||ue(n),i.isFiltered());return l_(t,a,n,r,a_,s)}function Fk(t,e,n,r,s,i){let a;if($l(r,n)!=null)return e;{const l=new gf(r,e,s),c=e.eventCache.getNode();let u;if(ue(n)||ie(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Fl(r,ms(e));else{const h=e.serverCache.getNode();A(h instanceof X,"serverChildren would be complete if leaf node"),d=pf(r,h)}d=d,u=t.filter.updateFullNode(c,d,i)}else{const d=ie(n);let h=mf(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?u=t.filter.updateChild(c,d,h,Ee(n),l,i):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(c,d,X.EMPTY_NODE,Ee(n),l,i):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=Fl(r,ms(e)),a.isLeafNode()&&(u=t.filter.updateFullNode(u,a,i)))}return a=e.serverCache.isFullyInitialized()||$l(r,ye())!=null,oo(e,u,a,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new uf(r.getIndex()),i=rk(r);this.processor_=Ik(i);const a=n.serverCache,l=n.eventCache,c=s.updateFullNode(X.EMPTY_NODE,a.getNode(),null),u=i.updateFullNode(X.EMPTY_NODE,l.getNode(),null),d=new Or(c,a.isFullyInitialized(),s.filtersNodes()),h=new Or(u,l.isFullyInitialized(),i.filtersNodes());this.viewCache_=vc(h,d),this.eventGenerator_=new uk(this.query_)}get query(){return this.query_}}function Uk(t){return t.viewCache_.serverCache.getNode()}function zk(t){return Ml(t.viewCache_)}function Bk(t,e){const n=ms(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ue(e)&&!n.getImmediateChild(ie(e)).isEmpty())?n.getChild(e):null}function Ym(t){return t.eventRegistrations_.length===0}function Hk(t,e){t.eventRegistrations_.push(e)}function Xm(t,e,n){const r=[];if(n){A(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const a=i.createCancelEvent(n,s);a&&r.push(a)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const a=t.eventRegistrations_[i];if(!a.matches(e))s.push(a);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function Jm(t,e,n,r){e.type===fn.MERGE&&e.source.queryId!==null&&(A(ms(t.viewCache_),"We should always have a full cache before handling merges"),A(Ml(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=Ak(t.processor_,s,e,n,r);return Rk(t.processor_,i.viewCache),A(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,c_(t,i.changes,i.viewCache.eventCache.getNode(),null)}function Wk(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ge,(i,a)=>{r.push(ci(i,a))}),n.isFullyInitialized()&&r.push(Zx(n.getNode())),c_(t,r,n.getNode(),e)}function c_(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return dk(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zl;class u_{constructor(){this.views=new Map}}function Vk(t){A(!zl,"__referenceConstructor has already been defined"),zl=t}function qk(){return A(zl,"Reference.ts has not been loaded"),zl}function Gk(t){return t.views.size===0}function yf(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return A(i!=null,"SyncTree gave us an op for an invalid query."),Jm(i,e,n,r)}else{let i=[];for(const a of t.views.values())i=i.concat(Jm(a,e,n,r));return i}}function d_(t,e,n,r,s){const i=e._queryIdentifier,a=t.views.get(i);if(!a){let l=Fl(n,s?r:null),c=!1;l?c=!0:r instanceof X?(l=pf(n,r),c=!1):(l=X.EMPTY_NODE,c=!1);const u=vc(new Or(l,c,!1),new Or(r,s,!1));return new $k(e,u)}return a}function Kk(t,e,n,r,s,i){const a=d_(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),Hk(a,n),Wk(a,n)}function Qk(t,e,n,r){const s=e._queryIdentifier,i=[];let a=[];const l=Mr(t);if(s==="default")for(const[c,u]of t.views.entries())a=a.concat(Xm(u,n,r)),Ym(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||i.push(u.query));else{const c=t.views.get(s);c&&(a=a.concat(Xm(c,n,r)),Ym(c)&&(t.views.delete(s),c.query._queryParams.loadsAllData()||i.push(c.query)))}return l&&!Mr(t)&&i.push(new(qk())(e._repo,e._path)),{removed:i,events:a}}function h_(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ir(t,e){let n=null;for(const r of t.views.values())n=n||Bk(r,e);return n}function f_(t,e){if(e._queryParams.loadsAllData())return Nc(t);{const r=e._queryIdentifier;return t.views.get(r)}}function p_(t,e){return f_(t,e)!=null}function Mr(t){return Nc(t)!=null}function Nc(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bl;function Yk(t){A(!Bl,"__referenceConstructor has already been defined"),Bl=t}function Xk(){return A(Bl,"Reference.ts has not been loaded"),Bl}let Jk=1;class Zm{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ce(null),this.pendingWriteTree_=kk(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function m_(t,e,n,r,s){return mk(t.pendingWriteTree_,e,n,r,s),s?Ci(t,new ps(df(),e,n)):[]}function Zk(t,e,n,r){gk(t.pendingWriteTree_,e,n,r);const s=Ce.fromObject(n);return Ci(t,new ui(df(),e,s))}function xr(t,e,n=!1){const r=yk(t.pendingWriteTree_,e);if(xk(t.pendingWriteTree_,e)){let i=new Ce(null);return r.snap!=null?i=i.set(ye(),!0):ht(r.children,a=>{i=i.set(new we(a),!0)}),Ci(t,new Ol(r.path,i,n))}else return[]}function Zo(t,e,n){return Ci(t,new ps(hf(),e,n))}function ej(t,e,n){const r=Ce.fromObject(n);return Ci(t,new ui(hf(),e,r))}function tj(t,e){return Ci(t,new Oo(hf(),e))}function nj(t,e,n){const r=_f(t,n);if(r){const s=vf(r),i=s.path,a=s.queryId,l=wt(i,e),c=new Oo(ff(a),l);return wf(t,i,c)}else return[]}function Hl(t,e,n,r,s=!1){const i=e._path,a=t.syncPointTree_.get(i);let l=[];if(a&&(e._queryIdentifier==="default"||p_(a,e))){const c=Qk(a,e,n,r);Gk(a)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const u=c.removed;if(l=c.events,!s){const d=u.findIndex(f=>f._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(i,(f,y)=>Mr(y));if(d&&!h){const f=t.syncPointTree_.subtree(i);if(!f.isEmpty()){const y=ij(f);for(let _=0;_<y.length;++_){const v=y[_],S=v.query,g=__(t,v);t.listenProvider_.startListening(lo(S),Mo(t,S),g.hashFn,g.onComplete)}}}!h&&u.length>0&&!r&&(d?t.listenProvider_.stopListening(lo(e),null):u.forEach(f=>{const y=t.queryToTagMap.get(bc(f));t.listenProvider_.stopListening(lo(f),y)}))}oj(t,u)}return l}function g_(t,e,n,r){const s=_f(t,r);if(s!=null){const i=vf(s),a=i.path,l=i.queryId,c=wt(a,e),u=new ps(ff(l),c,n);return wf(t,a,u)}else return[]}function rj(t,e,n,r){const s=_f(t,r);if(s){const i=vf(s),a=i.path,l=i.queryId,c=wt(a,e),u=Ce.fromObject(n),d=new ui(ff(l),c,u);return wf(t,a,d)}else return[]}function Fd(t,e,n,r=!1){const s=e._path;let i=null,a=!1;t.syncPointTree_.foreachOnPath(s,(f,y)=>{const _=wt(f,s);i=i||Ir(y,_),a=a||Mr(y)});let l=t.syncPointTree_.get(s);l?(a=a||Mr(l),i=i||Ir(l,ye())):(l=new u_,t.syncPointTree_=t.syncPointTree_.set(s,l));let c;i!=null?c=!0:(c=!1,i=X.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((y,_)=>{const v=Ir(_,ye());v&&(i=i.updateImmediateChild(y,v))}));const u=p_(l,e);if(!u&&!e._queryParams.loadsAllData()){const f=bc(e);A(!t.queryToTagMap.has(f),"View does not exist, but we have a tag");const y=aj();t.queryToTagMap.set(f,y),t.tagToQueryMap.set(y,f)}const d=wc(t.pendingWriteTree_,s);let h=Kk(l,e,n,d,i,c);if(!u&&!a&&!r){const f=f_(l,e);h=h.concat(lj(t,e,f))}return h}function xf(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(a,l)=>{const c=wt(a,e),u=Ir(l,c);if(u)return u});return s_(s,e,i,n,!0)}function sj(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,d)=>{const h=wt(u,n);r=r||Ir(d,h)});let s=t.syncPointTree_.get(n);s?r=r||Ir(s,ye()):(s=new u_,t.syncPointTree_=t.syncPointTree_.set(n,s));const i=r!=null,a=i?new Or(r,!0,!1):null,l=wc(t.pendingWriteTree_,e._path),c=d_(s,e,l,i?a.getNode():X.EMPTY_NODE,i);return zk(c)}function Ci(t,e){return y_(e,t.syncPointTree_,null,wc(t.pendingWriteTree_,ye()))}function y_(t,e,n,r){if(ue(t.path))return x_(t,e,n,r);{const s=e.get(ye());n==null&&s!=null&&(n=Ir(s,ye()));let i=[];const a=ie(t.path),l=t.operationForChild(a),c=e.children.get(a);if(c&&l){const u=n?n.getImmediateChild(a):null,d=i_(r,a);i=i.concat(y_(l,c,u,d))}return s&&(i=i.concat(yf(s,t,r,n))),i}}function x_(t,e,n,r){const s=e.get(ye());n==null&&s!=null&&(n=Ir(s,ye()));let i=[];return e.children.inorderTraversal((a,l)=>{const c=n?n.getImmediateChild(a):null,u=i_(r,a),d=t.operationForChild(a);d&&(i=i.concat(x_(d,l,c,u)))}),s&&(i=i.concat(yf(s,t,r,n))),i}function __(t,e){const n=e.query,r=Mo(t,n);return{hashFn:()=>(Uk(e)||X.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?nj(t,n._path,r):tj(t,n._path);{const i=tE(s,n);return Hl(t,n,null,i)}}}}function Mo(t,e){const n=bc(e);return t.queryToTagMap.get(n)}function bc(t){return t._path.toString()+"$"+t._queryIdentifier}function _f(t,e){return t.tagToQueryMap.get(e)}function vf(t){const e=t.indexOf("$");return A(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new we(t.substr(0,e))}}function wf(t,e,n){const r=t.syncPointTree_.get(e);A(r,"Missing sync point for query tag that we're tracking");const s=wc(t.pendingWriteTree_,e);return yf(r,n,s,null)}function ij(t){return t.fold((e,n,r)=>{if(n&&Mr(n))return[Nc(n)];{let s=[];return n&&(s=h_(n)),ht(r,(i,a)=>{s=s.concat(a)}),s}})}function lo(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Xk())(t._repo,t._path):t}function oj(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=bc(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function aj(){return Jk++}function lj(t,e,n){const r=e._path,s=Mo(t,e),i=__(t,n),a=t.listenProvider_.startListening(lo(e),s,i.hashFn,i.onComplete),l=t.syncPointTree_.subtree(r);if(s)A(!Mr(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((u,d,h)=>{if(!ue(u)&&d&&Mr(d))return[Nc(d).query];{let f=[];return d&&(f=f.concat(h_(d).map(y=>y.query))),ht(h,(y,_)=>{f=f.concat(_)}),f}});for(let u=0;u<c.length;++u){const d=c[u];t.listenProvider_.stopListening(lo(d),Mo(t,d))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Nf(n)}node(){return this.node_}}class bf{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=qe(this.path_,e);return new bf(this.syncTree_,n)}node(){return xf(this.syncTree_,this.path_)}}const cj=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},eg=function(t,e,n){if(!t||typeof t!="object")return t;if(A(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return uj(t[".sv"],e,n);if(typeof t[".sv"]=="object")return dj(t[".sv"],e);A(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},uj=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:A(!1,"Unexpected server value: "+t)}},dj=function(t,e,n){t.hasOwnProperty("increment")||A(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&A(!1,"Unexpected increment value: "+r);const s=e.node();if(A(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const a=s.getValue();return typeof a!="number"?r:a+r},v_=function(t,e,n,r){return Sf(e,new bf(n,t),r)},w_=function(t,e,n){return Sf(t,new Nf(e),n)};function Sf(t,e,n){const r=t.getPriority().val(),s=eg(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const a=t,l=eg(a.getValue(),e,n);return l!==a.getValue()||s!==a.getPriority().val()?new st(l,et(s)):t}else{const a=t;return i=a,s!==a.getPriority().val()&&(i=i.updatePriority(new st(s))),a.forEachChild(Ge,(l,c)=>{const u=Sf(c,e.getImmediateChild(l),n);u!==c&&(i=i.updateImmediateChild(l,u))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Ef(t,e){let n=e instanceof we?e:new we(e),r=t,s=ie(n);for(;s!==null;){const i=oi(r.node.children,s)||{children:{},childCount:0};r=new Cf(s,r,i),n=Ee(n),s=ie(n)}return r}function Ei(t){return t.node.value}function N_(t,e){t.node.value=e,$d(t)}function b_(t){return t.node.childCount>0}function hj(t){return Ei(t)===void 0&&!b_(t)}function Sc(t,e){ht(t.node.children,(n,r)=>{e(new Cf(n,t,r))})}function S_(t,e,n,r){n&&!r&&e(t),Sc(t,s=>{S_(s,e,!0,r)}),n&&r&&e(t)}function fj(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function ea(t){return new we(t.parent===null?t.name:ea(t.parent)+"/"+t.name)}function $d(t){t.parent!==null&&pj(t.parent,t.name,t)}function pj(t,e,n){const r=hj(n),s=Pn(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,$d(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,$d(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj=/[\[\].#$\/\u0000-\u001F\u007F]/,gj=/[\[\].#$\u0000-\u001F\u007F]/,Nu=10*1024*1024,kf=function(t){return typeof t=="string"&&t.length!==0&&!mj.test(t)},C_=function(t){return typeof t=="string"&&t.length!==0&&!gj.test(t)},yj=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),C_(t)},xj=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!ef(t)||t&&typeof t=="object"&&Pn(t,".sv")},_j=function(t,e,n,r){Cc(gc(t,"value"),e,n)},Cc=function(t,e,n){const r=n instanceof we?new LE(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Jr(r));if(typeof e=="function")throw new Error(t+"contains a function "+Jr(r)+" with contents = "+e.toString());if(ef(e))throw new Error(t+"contains "+e.toString()+" "+Jr(r));if(typeof e=="string"&&e.length>Nu/3&&yc(e)>Nu)throw new Error(t+"contains a string greater than "+Nu+" utf8 bytes "+Jr(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(ht(e,(a,l)=>{if(a===".value")s=!0;else if(a!==".priority"&&a!==".sv"&&(i=!0,!kf(a)))throw new Error(t+" contains an invalid key ("+a+") "+Jr(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);OE(r,a),Cc(t,l,r),ME(r)}),s&&i)throw new Error(t+' contains ".value" child '+Jr(r)+" in addition to actual children.")}},vj=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const i=Ro(r);for(let a=0;a<i.length;a++)if(!(i[a]===".priority"&&a===i.length-1)){if(!kf(i[a]))throw new Error(t+"contains an invalid key ("+i[a]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(DE);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&Xt(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},wj=function(t,e,n,r){const s=gc(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const i=[];ht(e,(a,l)=>{const c=new we(a);if(Cc(s,l,qe(n,c)),of(c)===".priority"&&!xj(l))throw new Error(s+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),vj(s,i)},jf=function(t,e,n,r){if(!C_(n))throw new Error(gc(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Nj=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),jf(t,e,n)},Tf=function(t,e){if(ie(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},bj=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!kf(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!yj(n))throw new Error(gc(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ec(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!af(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function E_(t,e,n){Ec(t,n),k_(t,r=>af(r,e))}function tn(t,e,n){Ec(t,n),k_(t,r=>Xt(r,e)||Xt(e,r))}function k_(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(Cj(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Cj(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();so&&ct("event: "+n.toString()),Si(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ej="repo_interrupt",kj=25;class jj{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Sj,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ll(),this.transactionQueueTree_=new Cf,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Tj(t,e,n){if(t.stats_=rf(t.repoInfo_),t.forceRestClient_||iE())t.server_=new Dl(t.repoInfo_,(r,s,i,a)=>{tg(t,r,s,i,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>ng(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{tt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Wn(t.repoInfo_,e,(r,s,i,a)=>{tg(t,r,s,i,a)},r=>{ng(t,r)},r=>{Ij(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=uE(t.repoInfo_,()=>new ck(t.stats_,t.server_)),t.infoData_=new sk,t.infoSyncTree_=new Zm({startListening:(r,s,i,a)=>{let l=[];const c=t.infoData_.getNode(r._path);return c.isEmpty()||(l=Zo(t.infoSyncTree_,r._path,c),setTimeout(()=>{a("ok")},0)),l},stopListening:()=>{}}),Pf(t,"connected",!1),t.serverSyncTree_=new Zm({startListening:(r,s,i,a)=>(t.server_.listen(r,i,s,(l,c)=>{const u=a(l,c);tn(t.eventQueue_,r._path,u)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function Pj(t){const n=t.infoData_.getNode(new we(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function kc(t){return cj({timestamp:Pj(t)})}function tg(t,e,n,r,s){t.dataUpdateCount++;const i=new we(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(s)if(r){const c=Tl(n,u=>et(u));a=rj(t.serverSyncTree_,i,c,s)}else{const c=et(n);a=g_(t.serverSyncTree_,i,c,s)}else if(r){const c=Tl(n,u=>et(u));a=ej(t.serverSyncTree_,i,c)}else{const c=et(n);a=Zo(t.serverSyncTree_,i,c)}let l=i;a.length>0&&(l=hi(t,i)),tn(t.eventQueue_,l,a)}function ng(t,e){Pf(t,"connected",e),e===!1&&Lj(t)}function Ij(t,e){ht(e,(n,r)=>{Pf(t,n,r)})}function Pf(t,e,n){const r=new we("/.info/"+e),s=et(n);t.infoData_.updateSnapshot(r,s);const i=Zo(t.infoSyncTree_,r,s);tn(t.eventQueue_,r,i)}function If(t){return t.nextWriteId_++}function Rj(t,e,n){const r=sj(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const i=et(s).withIndex(e._queryParams.getIndex());Fd(t.serverSyncTree_,e,n,!0);let a;if(e._queryParams.loadsAllData())a=Zo(t.serverSyncTree_,e._path,i);else{const l=Mo(t.serverSyncTree_,e);a=g_(t.serverSyncTree_,e._path,i,l)}return tn(t.eventQueue_,e._path,a),Hl(t.serverSyncTree_,e,n,null,!0),i},s=>(ta(t,"get for query "+tt(e)+" failed: "+s),Promise.reject(new Error(s))))}function Aj(t,e,n,r,s){ta(t,"set",{path:e.toString(),value:n,priority:r});const i=kc(t),a=et(n,r),l=xf(t.serverSyncTree_,e),c=w_(a,l,i),u=If(t),d=m_(t.serverSyncTree_,e,c,u,!0);Ec(t.eventQueue_,d),t.server_.put(e.toString(),a.val(!0),(f,y)=>{const _=f==="ok";_||bt("set at "+e+" failed: "+f);const v=xr(t.serverSyncTree_,u,!_);tn(t.eventQueue_,e,v),zd(t,s,f,y)});const h=Af(t,e);hi(t,h),tn(t.eventQueue_,h,[])}function Dj(t,e,n,r){ta(t,"update",{path:e.toString(),value:n});let s=!0;const i=kc(t),a={};if(ht(n,(l,c)=>{s=!1,a[l]=v_(qe(e,l),et(c),t.serverSyncTree_,i)}),s)ct("update() called with empty data.  Don't do anything."),zd(t,r,"ok",void 0);else{const l=If(t),c=Zk(t.serverSyncTree_,e,a,l);Ec(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,d)=>{const h=u==="ok";h||bt("update at "+e+" failed: "+u);const f=xr(t.serverSyncTree_,l,!h),y=f.length>0?hi(t,e):e;tn(t.eventQueue_,y,f),zd(t,r,u,d)}),ht(n,u=>{const d=Af(t,qe(e,u));hi(t,d)}),tn(t.eventQueue_,e,[])}}function Lj(t){ta(t,"onDisconnectEvents");const e=kc(t),n=Ll();Rd(t.onDisconnect_,ye(),(s,i)=>{const a=v_(s,i,t.serverSyncTree_,e);e_(n,s,a)});let r=[];Rd(n,ye(),(s,i)=>{r=r.concat(Zo(t.serverSyncTree_,s,i));const a=Af(t,s);hi(t,a)}),t.onDisconnect_=Ll(),tn(t.eventQueue_,ye(),r)}function Oj(t,e,n){let r;ie(e._path)===".info"?r=Fd(t.infoSyncTree_,e,n):r=Fd(t.serverSyncTree_,e,n),E_(t.eventQueue_,e._path,r)}function Ud(t,e,n){let r;ie(e._path)===".info"?r=Hl(t.infoSyncTree_,e,n):r=Hl(t.serverSyncTree_,e,n),E_(t.eventQueue_,e._path,r)}function Mj(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Ej)}function ta(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),ct(n,...e)}function zd(t,e,n,r){e&&Si(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const a=new Error(i);a.code=s,e(a)}})}function j_(t,e,n){return xf(t.serverSyncTree_,e,n)||X.EMPTY_NODE}function Rf(t,e=t.transactionQueueTree_){if(e||jc(t,e),Ei(e)){const n=P_(t,e);A(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&Fj(t,ea(e),n)}else b_(e)&&Sc(e,n=>{Rf(t,n)})}function Fj(t,e,n){const r=n.map(u=>u.currentWriteId),s=j_(t,e,r);let i=s;const a=s.hash();for(let u=0;u<n.length;u++){const d=n[u];A(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const h=wt(e,d.path);i=i.updateChild(h,d.currentOutputSnapshotRaw)}const l=i.val(!0),c=e;t.server_.put(c.toString(),l,u=>{ta(t,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){const h=[];for(let f=0;f<n.length;f++)n[f].status=2,d=d.concat(xr(t.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&h.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();jc(t,Ef(t.transactionQueueTree_,e)),Rf(t,t.transactionQueueTree_),tn(t.eventQueue_,e,d);for(let f=0;f<h.length;f++)Si(h[f])}else{if(u==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{bt("transaction at "+c.toString()+" failed: "+u);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=u}hi(t,e)}},a)}function hi(t,e){const n=T_(t,e),r=ea(n),s=P_(t,n);return $j(t,s,r),r}function $j(t,e,n){if(e.length===0)return;const r=[];let s=[];const a=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],u=wt(n,c.path);let d=!1,h;if(A(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,s=s.concat(xr(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=kj)d=!0,h="maxretry",s=s.concat(xr(t.serverSyncTree_,c.currentWriteId,!0));else{const f=j_(t,c.path,a);c.currentInputSnapshot=f;const y=e[l].update(f.val());if(y!==void 0){Cc("transaction failed: Data returned ",y,c.path);let _=et(y);typeof y=="object"&&y!=null&&Pn(y,".priority")||(_=_.updatePriority(f.getPriority()));const S=c.currentWriteId,g=kc(t),p=w_(_,f,g);c.currentOutputSnapshotRaw=_,c.currentOutputSnapshotResolved=p,c.currentWriteId=If(t),a.splice(a.indexOf(S),1),s=s.concat(m_(t.serverSyncTree_,c.path,p,c.currentWriteId,c.applyLocally)),s=s.concat(xr(t.serverSyncTree_,S,!0))}else d=!0,h="nodata",s=s.concat(xr(t.serverSyncTree_,c.currentWriteId,!0))}tn(t.eventQueue_,n,s),s=[],d&&(e[l].status=2,function(f){setTimeout(f,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(h==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(h),!1,null))))}jc(t,t.transactionQueueTree_);for(let l=0;l<r.length;l++)Si(r[l]);Rf(t,t.transactionQueueTree_)}function T_(t,e){let n,r=t.transactionQueueTree_;for(n=ie(e);n!==null&&Ei(r)===void 0;)r=Ef(r,n),e=Ee(e),n=ie(e);return r}function P_(t,e){const n=[];return I_(t,e,n),n.sort((r,s)=>r.order-s.order),n}function I_(t,e,n){const r=Ei(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Sc(e,s=>{I_(t,s,n)})}function jc(t,e){const n=Ei(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,N_(e,n.length>0?n:void 0)}Sc(e,r=>{jc(t,r)})}function Af(t,e){const n=ea(T_(t,e)),r=Ef(t.transactionQueueTree_,e);return fj(r,s=>{bu(t,s)}),bu(t,r),S_(r,s=>{bu(t,s)}),n}function bu(t,e){const n=Ei(e);if(n){const r=[];let s=[],i=-1;for(let a=0;a<n.length;a++)n[a].status===3||(n[a].status===1?(A(i===a-1,"All SENT items should be at beginning of queue."),i=a,n[a].status=3,n[a].abortReason="set"):(A(n[a].status===0,"Unexpected transaction status in abort"),n[a].unwatcher(),s=s.concat(xr(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&r.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));i===-1?N_(e,void 0):n.length=i+1,tn(t.eventQueue_,ea(e),s);for(let a=0;a<r.length;a++)Si(r[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uj(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function zj(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):bt(`Invalid query segment '${n}' in query '${t}'`)}return e}const rg=function(t,e){const n=Bj(t),r=n.namespace;n.domain==="firebase.com"&&Jn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Jn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||YC();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Mx(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new we(n.pathString)}},Bj=function(t){let e="",n="",r="",s="",i="",a=!0,l="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(l=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(d,h)),d<h&&(s=Uj(t.substring(d,h)));const f=zj(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(a=l==="https"||l==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const y=e.slice(0,u);if(y.toLowerCase()==="localhost")n="localhost";else if(y.split(".").length<=2)n=y;else{const _=e.indexOf(".");r=e.substring(0,_).toLowerCase(),n=e.substring(_+1),i=r}"ns"in f&&(i=f.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:a,scheme:l,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+tt(this.snapshot.exportVal())}}class Wj{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return A(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return ue(this._path)?null:of(this._path)}get ref(){return new In(this._repo,this._path)}get _queryIdentifier(){const e=Hm(this._queryParams),n=tf(e);return n==="{}"?"default":n}get _queryObject(){return Hm(this._queryParams)}isEqual(e){if(e=rn(e),!(e instanceof Tc))return!1;const n=this._repo===e._repo,r=af(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+AE(this._path)}}class In extends Tc{constructor(e,n){super(e,n,new _c,!1)}get parent(){const e=qx(this._path);return e===null?null:new In(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class fi{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new we(e),r=Wl(this.ref,e);return new fi(this._node.getChild(n),r,Ge)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new fi(s,Wl(this.ref,r),Ge)))}hasChild(e){const n=new we(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Z(t,e){return t=rn(t),t._checkNotDeleted("ref"),e!==void 0?Wl(t._root,e):t._root}function Wl(t,e){return t=rn(t),ie(t._path)===null?Nj("child","path",e):jf("child","path",e),new In(t._repo,qe(t._path,e))}function Df(t){return Tf("remove",t._path),Zn(t,null)}function Zn(t,e){t=rn(t),Tf("set",t._path),_j("set",e,t._path);const n=new Ko;return Aj(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function We(t,e){wj("update",e,t._path);const n=new Ko;return Dj(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function pi(t){t=rn(t);const e=new R_(()=>{}),n=new Pc(e);return Rj(t._repo,t,n).then(r=>new fi(r,new In(t._repo,t._path),t._queryParams.getIndex()))}class Pc{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new Hj("value",this,new fi(e.snapshotNode,new In(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Wj(this,e,n):null}matches(e){return e instanceof Pc?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Vj(t,e,n,r,s){let i;if(typeof r=="object"&&(i=void 0,s=r),typeof r=="function"&&(i=r),s&&s.onlyOnce){const c=n,u=(d,h)=>{Ud(t._repo,t,l),c(d,h)};u.userCallback=n.userCallback,u.context=n.context,n=u}const a=new R_(n,i||void 0),l=new Pc(a);return Oj(t._repo,t,l),()=>Ud(t._repo,t,l)}function St(t,e,n,r){return Vj(t,"value",e,n,r)}function Rn(t,e,n){Ud(t._repo,t,null)}Vk(In);Yk(In);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qj="FIREBASE_DATABASE_EMULATOR_HOST",Bd={};let Gj=!1;function Kj(t,e,n,r){const s=e.lastIndexOf(":"),i=e.substring(0,s),a=wi(i);t.repoInfo_=new Mx(e,a,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function A_(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Jn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ct("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=rg(i,s),l=a.repoInfo,c;typeof process<"u"&&Cm&&(c=Cm[qj]),c?(i=`http://${c}?ns=${l.namespace}`,a=rg(i,s),l=a.repoInfo):a.repoInfo.secure;const u=new aE(t.name,t.options,e);bj("Invalid Firebase Database URL",a),ue(a.path)||Jn("Database URL must point to the root of a Firebase Database (not including a child path).");const d=Yj(l,t,u,new oE(t,n));return new D_(d,t)}function Qj(t,e){const n=Bd[e];(!n||n[t.key]!==t)&&Jn(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Mj(t),delete n[t.key]}function Yj(t,e,n,r){let s=Bd[e.name];s||(s={},Bd[e.name]=s);let i=s[t.toURLString()];return i&&Jn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new jj(t,Gj,n,r),s[t.toURLString()]=i,i}class D_{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Tj(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new In(this._repo,ye())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Qj(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Jn("Cannot call "+e+" on a deleted database.")}}function L_(t=_x(),e){const n=Zh(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=xS("database");r&&O_(n,...r)}return n}function O_(t,e,n,r={}){t=rn(t),t._checkNotDeleted("useEmulator");const s=`${e}:${n}`,i=t._repoInternal;if(t._instanceStarted){if(s===t._repoInternal.repoInfo_.host&&ds(r,i.repoInfo_.emulatorOptions))return;Jn("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Jn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new qa(qa.OWNER);else if(r.mockUserToken){const l=typeof r.mockUserToken=="string"?r.mockUserToken:_S(r.mockUserToken,t.app.options.projectId);a=new qa(l)}wi(e)&&(dx(e),hx("Database",!0)),Kj(i,s,r,a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xj(t){bx(bi),ai(new hs("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return A_(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),Tr(Em,km,t),Tr(Em,km,"esm2020")}Wn.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Wn.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Xj();const Ga=Object.freeze(Object.defineProperty({__proto__:null,DataSnapshot:fi,Database:D_,_QueryImpl:Tc,_QueryParams:_c,_ReferenceImpl:In,_repoManagerDatabaseFromApp:A_,_setSDKVersion:bx,_validatePathString:jf,_validateWritablePath:Tf,child:Wl,connectDatabaseEmulator:O_,get:pi,getDatabase:L_,off:Rn,onValue:St,ref:Z,remove:Df,set:Zn,update:We},Symbol.toStringTag,{value:"Module"}));var Jj="firebase",Zj="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tr(Jj,Zj,"app");function M_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const eT=M_,F_=new Qo("auth","Firebase",M_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vl=new Xh("@firebase/auth");function tT(t,...e){Vl.logLevel<=ve.WARN&&Vl.warn(`Auth (${bi}): ${t}`,...e)}function Ka(t,...e){Vl.logLevel<=ve.ERROR&&Vl.error(`Auth (${bi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(t,...e){throw Lf(t,...e)}function Cn(t,...e){return Lf(t,...e)}function $_(t,e,n){const r={...eT(),[e]:n};return new Qo("auth","Firebase",r).create(e,{appName:t.name})}function Rr(t){return $_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Lf(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return F_.create(t,...e)}function te(t,e,...n){if(!t)throw Lf(e,...n)}function Un(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ka(e),new Error(e)}function tr(t,e){t||Un(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function nT(){return sg()==="http:"||sg()==="https:"}function sg(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nT()||bS()||"connection"in navigator)?navigator.onLine:!0}function sT(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,n){this.shortDelay=e,this.longDelay=n,tr(n>e,"Short delay should be less than long delay!"),this.isMobile=Yh()||fx()}get(){return rT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Of(t,e){tr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Un("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Un("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Un("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aT=new na(3e4,6e4);function Ic(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ki(t,e,n,r,s={}){return z_(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const l=Ni({key:t.config.apiKey,...a}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...i};return NS()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&wi(t.emulatorConfig.host)&&(u.credentials="include"),U_.fetch()(await H_(t,t.config.apiHost,n,l),u)})}async function z_(t,e,n){t._canInitEmulator=!1;const r={...iT,...e};try{const s=new lT(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw ja(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const l=i.ok?a.errorMessage:a.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ja(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw ja(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw ja(t,"user-disabled",a);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw $_(t,d,u);er(t,d)}}catch(s){if(s instanceof Hr)throw s;er(t,"network-request-failed",{message:String(s)})}}async function B_(t,e,n,r,s={}){const i=await ki(t,e,n,r,s);return"mfaPendingCredential"in i&&er(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function H_(t,e,n,r){const s=`${e}${n}?${r}`,i=t,a=i.config.emulator?Of(t.config,s):`${t.config.apiScheme}://${s}`;return oT.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class lT{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Cn(this.auth,"network-request-failed")),aT.get())})}}function ja(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Cn(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cT(t,e){return ki(t,"POST","/v1/accounts:delete",e)}async function ql(t,e){return ki(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function co(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uT(t,e=!1){const n=rn(t),r=await n.getIdToken(e),s=Mf(r);te(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:co(Su(s.auth_time)),issuedAtTime:co(Su(s.iat)),expirationTime:co(Su(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Su(t){return Number(t)*1e3}function Mf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ka("JWT malformed, contained fewer than 3 sections"),null;try{const s=jl(n);return s?JSON.parse(s):(Ka("Failed to decode base64 JWT payload"),null)}catch(s){return Ka("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function ig(t){const e=Mf(t);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Hr&&dT(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function dT({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=co(this.lastLoginAt),this.creationTime=co(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gl(t){var h;const e=t.auth,n=await t.getIdToken(),r=await Fo(t,ql(e,{idToken:n}));te(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?W_(s.providerUserInfo):[],a=pT(t.providerData,i),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Wd(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function fT(t){const e=rn(t);await Gl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function pT(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function W_(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mT(t,e){const n=await z_(t,{},async()=>{const r=Ni({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=await H_(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:r};return t.emulatorConfig&&wi(t.emulatorConfig.host)&&(c.credentials="include"),U_.fetch()(a,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function gT(t,e){return ki(t,"POST","/v2/accounts:revokeToken",Ic(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ig(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){te(e.length!==0,"internal-error");const n=ig(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await mT(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new Qs;return r&&(te(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(te(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(te(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qs,this.toJSON())}_performRefresh(){return Un("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(t,e){te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class pn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new hT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Wd(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Fo(this,this.stsTokenManager.getToken(this.auth,e));return te(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return uT(this,e)}reload(){return fT(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new pn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Gl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dn(this.auth.app))return Promise.reject(Rr(this.auth));const e=await this.getIdToken();return await Fo(this,cT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,a=n.photoURL??void 0,l=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:y,providerData:_,stsTokenManager:v}=n;te(h&&v,e,"internal-error");const S=Qs.fromJSON(this.name,v);te(typeof h=="string",e,"internal-error"),or(r,e.name),or(s,e.name),te(typeof f=="boolean",e,"internal-error"),te(typeof y=="boolean",e,"internal-error"),or(i,e.name),or(a,e.name),or(l,e.name),or(c,e.name),or(u,e.name),or(d,e.name);const g=new pn({uid:h,auth:e,email:s,emailVerified:f,displayName:r,isAnonymous:y,photoURL:a,phoneNumber:i,tenantId:l,stsTokenManager:S,createdAt:u,lastLoginAt:d});return _&&Array.isArray(_)&&(g.providerData=_.map(p=>({...p}))),c&&(g._redirectEventId=c),g}static async _fromIdTokenResponse(e,n,r=!1){const s=new Qs;s.updateFromServerResponse(n);const i=new pn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Gl(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];te(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?W_(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Qs;l.updateFromIdToken(r);const c=new pn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:a}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Wd(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og=new Map;function zn(t){tr(t instanceof Function,"Expected a class definition");let e=og.get(t);return e?(tr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,og.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}V_.type="NONE";const ag=V_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qa(t,e,n){return`firebase:${t}:${e}:${n}`}class Ys{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Qa(this.userKey,s.apiKey,i),this.fullPersistenceKey=Qa("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ql(this.auth,{idToken:e}).catch(()=>{});return n?pn._fromGetAccountInfoResponse(this.auth,n,e):null}return pn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ys(zn(ag),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||zn(ag);const a=Qa(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(a);if(d){let h;if(typeof d=="string"){const f=await ql(e,{idToken:d}).catch(()=>{});if(!f)break;h=await pn._fromGetAccountInfoResponse(e,f,d)}else h=pn._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Ys(i,e,r):(i=c[0],l&&await i._set(a,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(a)}catch{}})),new Ys(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Q_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(q_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(X_(e))return"Blackberry";if(J_(e))return"Webos";if(G_(e))return"Safari";if((e.includes("chrome/")||K_(e))&&!e.includes("edge/"))return"Chrome";if(Y_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function q_(t=Ct()){return/firefox\//i.test(t)}function G_(t=Ct()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function K_(t=Ct()){return/crios\//i.test(t)}function Q_(t=Ct()){return/iemobile/i.test(t)}function Y_(t=Ct()){return/android/i.test(t)}function X_(t=Ct()){return/blackberry/i.test(t)}function J_(t=Ct()){return/webos/i.test(t)}function Ff(t=Ct()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function yT(t=Ct()){var e;return Ff(t)&&!!((e=window.navigator)!=null&&e.standalone)}function xT(){return SS()&&document.documentMode===10}function Z_(t=Ct()){return Ff(t)||Y_(t)||J_(t)||X_(t)||/windows phone/i.test(t)||Q_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(t,e=[]){let n;switch(t){case"Browser":n=lg(Ct());break;case"Worker":n=`${lg(Ct())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${bi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,l)=>{try{const c=e(i);a(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vT(t,e={}){return ki(t,"GET","/v2/passwordPolicy",Ic(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT=6;class NT{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??wT,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cg(this),this.idTokenSubscription=new cg(this),this.beforeStateQueue=new _T(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=F_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Ys.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ql(this,{idToken:e}),r=await pn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(dn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,l=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Gl(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(dn(this.app))return Promise.reject(Rr(this));const n=e?rn(e):null;return n&&te(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return dn(this.app)?Promise.reject(Rr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return dn(this.app)?Promise.reject(Rr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vT(this),n=new NT(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await gT(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&zn(e)||this._popupRedirectResolver;te(n,this,"argument-error"),this.redirectPersistenceManager=await Ys.create(this,[zn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(l,this,"internal-error"),l.then(()=>{a||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{a=!0,c()}}else{const c=e.addObserver(n);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ev(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&tT(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Rc(t){return rn(t)}class cg{constructor(e){this.auth=e,this.observer=null,this.addObserver=AS(n=>this.observer=n)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $f={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ST(t){$f=t}function CT(t){return $f.loadJS(t)}function ET(){return $f.gapiScript}function kT(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(t,e){const n=Zh(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ds(i,e??{}))return s;er(s,"already-initialized")}return n.initialize({options:e})}function TT(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(zn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function PT(t,e,n){const r=Rc(t);te(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=tv(e),{host:a,port:l}=IT(e),c=l===null?"":`:${l}`,u={url:`${i}//${a}${c}/`},d=Object.freeze({host:a,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){te(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),te(ds(u,r.config.emulator)&&ds(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,wi(a)?(dx(`${i}//${a}${c}`),hx("Auth",!0)):RT()}function tv(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function IT(t){const e=tv(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:ug(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:ug(a)}}}function ug(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function RT(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Un("not implemented")}_getIdTokenResponse(e){return Un("not implemented")}_linkToIdToken(e,n){return Un("not implemented")}_getReauthenticationResolver(e){return Un("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xs(t,e){return B_(t,"POST","/v1/accounts:signInWithIdp",Ic(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AT="http://localhost";class gs extends nv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new gs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):er("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const a=new gs(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Xs(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Xs(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Xs(e,n)}buildRequest(){const e={requestUri:AT,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ni(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra extends rv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr extends ra{constructor(){super("facebook.com")}static credential(e){return gs._fromParams({providerId:hr.PROVIDER_ID,signInMethod:hr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hr.credentialFromTaggedObject(e)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hr.credential(e.oauthAccessToken)}catch{return null}}}hr.FACEBOOK_SIGN_IN_METHOD="facebook.com";hr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr extends ra{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return gs._fromParams({providerId:fr.PROVIDER_ID,signInMethod:fr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return fr.credentialFromTaggedObject(e)}static credentialFromError(e){return fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return fr.credential(n,r)}catch{return null}}}fr.GOOGLE_SIGN_IN_METHOD="google.com";fr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr extends ra{constructor(){super("github.com")}static credential(e){return gs._fromParams({providerId:pr.PROVIDER_ID,signInMethod:pr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pr.credentialFromTaggedObject(e)}static credentialFromError(e){return pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pr.credential(e.oauthAccessToken)}catch{return null}}}pr.GITHUB_SIGN_IN_METHOD="github.com";pr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr extends ra{constructor(){super("twitter.com")}static credential(e,n){return gs._fromParams({providerId:mr.PROVIDER_ID,signInMethod:mr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return mr.credentialFromTaggedObject(e)}static credentialFromError(e){return mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return mr.credential(n,r)}catch{return null}}}mr.TWITTER_SIGN_IN_METHOD="twitter.com";mr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DT(t,e){return B_(t,"POST","/v1/accounts:signUp",Ic(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await pn._fromIdTokenResponse(e,r,s),a=dg(r);return new Fr({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=dg(r);return new Fr({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function dg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LT(t){var s;if(dn(t.app))return Promise.reject(Rr(t));const e=Rc(t);if(await e._initializationPromise,(s=e.currentUser)!=null&&s.isAnonymous)return new Fr({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await DT(e,{returnSecureToken:!0}),r=await Fr._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl extends Hr{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Kl.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Kl(e,n,r,s)}}function sv(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Kl._fromErrorAndOperation(t,i,e,r):i})}async function OT(t,e,n=!1){const r=await Fo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Fr._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MT(t,e,n=!1){const{auth:r}=t;if(dn(r.app))return Promise.reject(Rr(r));const s="reauthenticate";try{const i=await Fo(t,sv(r,s,e,t),n);te(i.idToken,r,"internal-error");const a=Mf(i.idToken);te(a,r,"internal-error");const{sub:l}=a;return te(t.uid===l,r,"user-mismatch"),Fr._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&er(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FT(t,e,n=!1){if(dn(t.app))return Promise.reject(Rr(t));const r="signIn",s=await sv(t,r,e),i=await Fr._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function $T(t,e,n,r){return rn(t).onIdTokenChanged(e,n,r)}function UT(t,e,n){return rn(t).beforeAuthStateChanged(e,n)}const Ql="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ql,"1"),this.storage.removeItem(Ql),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT=1e3,BT=10;class ov extends iv{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Z_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);xT()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,BT):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},zT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ov.type="LOCAL";const HT=ov;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av extends iv{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}av.type="SESSION";const lv=av;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Ac(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(a).map(async u=>u(n.origin,i)),c=await WT(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ac.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((l,c)=>{const u=Uf("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(){return window}function qT(t){En().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(){return typeof En().WorkerGlobalScope<"u"&&typeof En().importScripts=="function"}async function GT(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function KT(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function QT(){return cv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv="firebaseLocalStorageDb",YT=1,Yl="firebaseLocalStorage",dv="fbase_key";class sa{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Dc(t,e){return t.transaction([Yl],e?"readwrite":"readonly").objectStore(Yl)}function XT(){const t=indexedDB.deleteDatabase(uv);return new sa(t).toPromise()}function Vd(){const t=indexedDB.open(uv,YT);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Yl,{keyPath:dv})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Yl)?e(r):(r.close(),await XT(),e(await Vd()))})})}async function hg(t,e,n){const r=Dc(t,!0).put({[dv]:e,value:n});return new sa(r).toPromise()}async function JT(t,e){const n=Dc(t,!1).get(e),r=await new sa(n).toPromise();return r===void 0?null:r.value}function fg(t,e){const n=Dc(t,!0).delete(e);return new sa(n).toPromise()}const ZT=800,e2=3;class hv{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vd(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>e2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return cv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ac._getInstance(QT()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await GT(),!this.activeServiceWorker)return;this.sender=new VT(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||KT()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vd();return await hg(e,Ql,"1"),await fg(e,Ql),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>hg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>JT(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>fg(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Dc(s,!1).getAll();return new sa(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}hv.type="LOCAL";const t2=hv;new na(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n2(t,e){return e?zn(e):(te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf extends nv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Xs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Xs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function r2(t){return FT(t.auth,new zf(t),t.bypassAuthState)}function s2(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),MT(n,new zf(t),t.bypassAuthState)}async function i2(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),OT(n,new zf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:l}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return r2;case"linkViaPopup":case"linkViaRedirect":return i2;case"reauthViaPopup":case"reauthViaRedirect":return s2;default:er(this.auth,"internal-error")}}resolve(e){tr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){tr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2=new na(2e3,1e4);class Us extends fv{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Us.currentPopupAction&&Us.currentPopupAction.cancel(),Us.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return te(e,this.auth,"internal-error"),e}async onExecution(){tr(this.filter.length===1,"Popup operations only handle one event");const e=Uf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Cn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Cn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Us.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,o2.get())};e()}}Us.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="pendingRedirect",Ya=new Map;class l2 extends fv{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ya.get(this.auth._key());if(!e){try{const r=await c2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ya.set(this.auth._key(),e)}return this.bypassAuthState||Ya.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function c2(t,e){const n=h2(e),r=d2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function u2(t,e){Ya.set(t._key(),e)}function d2(t){return zn(t._redirectPersistence)}function h2(t){return Qa(a2,t.config.apiKey,t.name)}async function f2(t,e,n=!1){if(dn(t.app))return Promise.reject(Rr(t));const r=Rc(t),s=n2(r,e),a=await new l2(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2=10*60*1e3;class m2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!g2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!pv(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Cn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=p2&&this.cachedEventUids.clear(),this.cachedEventUids.has(pg(e))}saveEventToCache(e){this.cachedEventUids.add(pg(e)),this.lastProcessedEventTime=Date.now()}}function pg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function pv({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function g2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pv(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y2(t,e={}){return ki(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_2=/^https?/;async function v2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await y2(t);for(const n of e)try{if(w2(n))return}catch{}er(t,"unauthorized-domain")}function w2(t){const e=Hd(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!_2.test(n))return!1;if(x2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N2=new na(3e4,6e4);function mg(){const t=En().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function b2(t){return new Promise((e,n)=>{var s,i,a;function r(){mg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mg(),n(Cn(t,"network-request-failed"))},timeout:N2.get()})}if((i=(s=En().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=En().gapi)!=null&&a.load)r();else{const l=kT("iframefcb");return En()[l]=()=>{gapi.load?r():n(Cn(t,"network-request-failed"))},CT(`${ET()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Xa=null,e})}let Xa=null;function S2(t){return Xa=Xa||b2(t),Xa}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=new na(5e3,15e3),E2="__/auth/iframe",k2="emulator/auth/iframe",j2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},T2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function P2(t){const e=t.config;te(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Of(e,k2):`https://${t.config.authDomain}/${E2}`,r={apiKey:e.apiKey,appName:t.name,v:bi},s=T2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Ni(r).slice(1)}`}async function I2(t){const e=await S2(t),n=En().gapi;return te(n,t,"internal-error"),e.open({where:document.body,url:P2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:j2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=Cn(t,"network-request-failed"),l=En().setTimeout(()=>{i(a)},C2.get());function c(){En().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},A2=500,D2=600,L2="_blank",O2="http://localhost";class gg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function M2(t,e,n,r=A2,s=D2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c={...R2,width:r.toString(),height:s.toString(),top:i,left:a},u=Ct().toLowerCase();n&&(l=K_(u)?L2:n),q_(u)&&(e=e||O2,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[y,_])=>`${f}${y}=${_},`,"");if(yT(u)&&l!=="_self")return F2(e||"",l),new gg(null);const h=window.open(e||"",l,d);te(h,t,"popup-blocked");try{h.focus()}catch{}return new gg(h)}function F2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $2="__/auth/handler",U2="emulator/auth/handler",z2=encodeURIComponent("fac");async function yg(t,e,n,r,s,i){te(t.config.authDomain,t,"auth-domain-config-required"),te(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:bi,eventId:s};if(e instanceof rv){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",bd(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))a[d]=h}if(e instanceof ra){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${z2}=${encodeURIComponent(c)}`:"";return`${B2(t)}?${Ni(l).slice(1)}${u}`}function B2({config:t}){return t.emulator?Of(t,U2):`https://${t.authDomain}/${$2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cu="webStorageSupport";class H2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=lv,this._completeRedirectFn=f2,this._overrideRedirectResult=u2}async _openPopup(e,n,r,s){var a;tr((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await yg(e,n,r,Hd(),s);return M2(e,i,Uf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await yg(e,n,r,Hd(),s);return qT(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(tr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await I2(e),r=new m2(e);return n.register("authEvent",s=>(te(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Cu,{type:Cu},s=>{var a;const i=(a=s==null?void 0:s[0])==null?void 0:a[Cu];i!==void 0&&n(!!i),er(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=v2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Z_()||G_()||Ff()}}const W2=H2;var xg="@firebase/auth",_g="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function G2(t){ai(new hs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;te(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ev(t)},u=new bT(r,s,i,c);return TT(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ai(new hs("auth-internal",e=>{const n=Rc(e.getProvider("auth").getImmediate());return(r=>new V2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Tr(xg,_g,q2(t)),Tr(xg,_g,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2=5*60,Q2=ux("authIdTokenMaxAge")||K2;let vg=null;const Y2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Q2)return;const s=n==null?void 0:n.token;vg!==s&&(vg=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function X2(t=_x()){const e=Zh(t,"auth");if(e.isInitialized())return e.getImmediate();const n=jT(t,{popupRedirectResolver:W2,persistence:[t2,HT,lv]}),r=ux("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=Y2(i.toString());UT(n,a,()=>a(n.currentUser)),$T(n,l=>a(l))}}const s=lx("auth");return s&&PT(n,`http://${s}`),n}function J2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}ST({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Cn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",J2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});G2("Browser");const Z2={apiKey:"AIzaSyDDCIyLe28ivoIzohTUwBzb3LVKfLtJxBg",authDomain:"bcit-d5764.firebaseapp.com",databaseURL:"https://bcit-d5764-default-rtdb.firebaseio.com",projectId:"bcit-d5764",storageBucket:"bcit-d5764.firebasestorage.app",messagingSenderId:"864766820084",appId:"1:864766820084:web:d524e84073e1924e5be8a1",measurementId:"G-0KZX261EZY"},mv=xx(Z2),ee=L_(mv),eP=X2(mv);LT(eP).then(()=>{console.log("Signed in anonymously to Firebase")}).catch(t=>{console.error("Anonymous sign-in failed:",t)});const gv=async t=>{try{const e=Z(ee,`servers/${t}`);await Zn(e,{server_info:{server_lat:0,server_long:0,server_location_name:"Not set"},mode:{type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:new Date().toISOString()},active_status:{status:"idle",progress:0,total_files:0,received_files:0,total_size_bytes:0,transferred_bytes:0},connection_status:!1,clients:{}}),console.log("Server created:",t)}catch(e){throw console.error("Failed to create server:",e),e}},yv=async t=>{try{console.log(` Attempting to delete server: ${t}`);const e=Z(ee,`servers/${t}`);if(!(await pi(e)).exists()){console.log(` Server ${t} does not exist in Firebase`);return}if(console.log(` Server ${t} exists, proceeding with deletion...`),await Df(e),(await pi(e)).exists())throw console.error(` Server ${t} still exists after deletion attempt!`),new Error("Server deletion failed - server still exists");console.log(` Server ${t} successfully deleted from Firebase`)}catch(e){throw console.error(` Failed to delete server ${t}:`,e),e}},xv=async t=>{try{const e=Z(ee,`servers/${t}/clients`),n=await new Promise(l=>{St(e,c=>{l(c.val()||{})},{onlyOnce:!0})}),r=Z(ee,`servers/${t}/server_info`),s=await new Promise(l=>{St(r,c=>{l(c.val()||{server_lat:0,server_long:0,server_location_name:"Not set"})},{onlyOnce:!0})}),i={};Object.keys(n||{}).forEach(l=>{const c=n[l]||{};if(c.client_info){const u={...c.client_info||{}};typeof u.location_updated>"u"&&(u.location_updated=!1),i[l]={client_info:u,scheduled_records:c.scheduled_records||{_placeholder:"No scheduled records yet"},predictions:c.predictions||{}}}else i[l]={scheduled_records:c.scheduled_records||{_placeholder:"No scheduled records yet"},predictions:c.predictions||{}}});const a=Z(ee,`servers/${t}`);await Zn(a,{server_info:s,mode:{type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:new Date().toISOString()},active_status:{status:"idle",progress:0,total_files:0,received_files:0,total_size_bytes:0,transferred_bytes:0},connection_status:!1,clients:i}),console.log("Server reset (locations preserved):",t)}catch(e){throw console.error("Failed to reset server:",e),e}},_v=t=>{const e=Z(ee,"servers");return St(e,n=>{const r=n.val();t(r||{})}),()=>Rn(e)},vv=async(t,e)=>{try{const n=Z(ee,`servers/${t}/clients/${e}`);await Zn(n,{client_info:{lat:0,long:0,location_name:"Not set",location_updated:!1},scheduled_records:{_placeholder:"No scheduled records yet"}}),console.log("Client created:",t,e)}catch(n){throw console.error("Failed to create client:",n),n}},wv=async(t,e)=>{try{const n=Z(ee,`servers/${t}/clients/${e}`);await Df(n),console.log("Client deleted:",t,e)}catch(n){throw console.error("Failed to delete client:",n),n}},Nv=async(t,e)=>{try{const n=Z(ee,`servers/${t}/clients/${e}/scheduled_records`),r=await new Promise(f=>{St(n,y=>{f(y.val()||{_placeholder:"No scheduled records yet"})},{onlyOnce:!0})}),s=Z(ee,`servers/${t}/clients/${e}/client_info`),i=await new Promise(f=>{St(s,y=>{f(y.val()||{lat:0,long:0,location_name:"Not set"})},{onlyOnce:!0})}),a=Z(ee,`servers/${t}/clients/${e}/predictions`),l=await new Promise(f=>{St(a,y=>{f(y.val()||{})},{onlyOnce:!0})}),c=Z(ee,`servers/${t}/clients/${e}`),u={...i||{}};typeof u.location_updated>"u"&&(u.location_updated=!1),await Zn(c,{client_info:u,scheduled_records:r,predictions:l});const d=Z(ee,`servers/${t}/mode`);await We(d,{type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:new Date().toISOString()});const h=Z(ee,`servers/${t}`);await We(h,{connection_status:!1,active_status:{status:"idle",progress:0,total_files:0,received_files:0,total_size_bytes:0,transferred_bytes:0}}),console.log("Client reset (scheduled records and location preserved, server mode reset to idle):",t,e)}catch(n){throw console.error("Failed to reset client:",n),n}},bv=async t=>{try{const e=Z(ee,`servers/${t}/mode`);await We(e,{type:"server_location",updated_at:new Date().toISOString()}),console.log("Server location command sent")}catch(e){throw console.error("Failed to send server location command:",e),e}},Sv=async(t,e)=>{try{const n=Z(ee,`servers/${t}/mode`);await We(n,{type:"client_location",target_client_id:e,updated_at:new Date().toISOString()}),console.log("Client location command sent")}catch(n){throw console.error("Failed to send client location command:",n),n}},Cv=async(t,e)=>{try{const n=Z(ee,`servers/${t}/mode`);await We(n,{type:"connect",target_client_id:e,updated_at:new Date().toISOString()}),console.log("Connect command sent")}catch(n){throw console.error("Failed to send connect command:",n),n}},Ev=async(t,e,n)=>{try{const r=Z(ee,`servers/${t}/mode`);await We(r,{type:"instant",target_client_id:e,duration_sec:n,updated_at:new Date().toISOString()}),console.log("Instant command sent")}catch(r){throw console.error("Failed to send instant command:",r),r}},kv=async(t,e,n,r)=>{try{const s=new Date().toISOString(),i=Z(ee,`servers/${t}/mode`);await We(i,{type:"schedule",target_client_id:e,duration_sec:n,schedule_key:r,updated_at:s});const a=Z(ee,`servers/${t}/clients/${e}/scheduled_records/${r}`);await We(a,{duration_sec:n,status:"pending",created_at:s}),console.log("Schedule command sent and record created")}catch(s){throw console.error("Failed to send schedule command:",s),s}},jv=async(t,e,n)=>{try{const r=Z(ee,`servers/${t}/mode`);await We(r,{type:"transmit_scheduled",target_client_id:e,schedule_key:n,updated_at:new Date().toISOString()}),console.log("Transmit scheduled command sent")}catch(r){throw console.error("Failed to send transmit scheduled command:",r),r}},Tv=(t,e)=>{const n=Z(ee,`servers/${t}/server_info`);return St(n,r=>{e(r.val()||{})}),()=>Rn(n)},Bf=(t,e)=>{const n=Z(ee,`servers/${t}/mode`);return St(n,r=>{e(r.val()||{})}),()=>Rn(n)},Xl=(t,e)=>{const n=Z(ee,`servers/${t}/active_status`);return St(n,r=>{e(r.val()||{})}),()=>Rn(n)},Pv=(t,e)=>{const n=Z(ee,`servers/${t}/connection_status`);return St(n,r=>{e(!!r.val())}),()=>Rn(n)},Iv=(t,e,n)=>{const r=Z(ee,`servers/${t}/clients/${e}/client_info`);return St(r,s=>{n(s.val()||{})}),()=>Rn(r)},Rv=(t,e)=>{const n=Z(ee,`servers/${t}/clients`);return St(n,r=>{e(r.val()||{})}),()=>Rn(n)},Av=(t,e,n)=>{const r=Z(ee,`servers/${t}/clients/${e}/scheduled_records`);return St(r,s=>{n(s.val()||{})}),()=>Rn(r)},Hf=async(t,e,n,r,s,i,a,l,c)=>{if(!t||!e||!n){console.error(" [savePrediction] Missing required parameters:",{serverId:t,clientId:e,batId:n});return}if(c&&l&&l.length>0){let u=n.replace(".wav","").replace("bat_","");if(!u){console.error(" [savePrediction] Could not extract bat number from:",n);return}const d=`servers/${t}/clients/${e}/predictions/${c}/${u}`;console.log(` [savePrediction] Saving to: ${d}`),console.log(`   Species count: ${l.length}`);const h=Z(ee,d),f={};l.forEach((y,_)=>{y&&y.species&&typeof y.confidence=="number"&&(f[_]={s:y.species,c:y.confidence})}),Object.keys(f).length>0?(await Zn(h,f),console.log(` [savePrediction] Saved ${Object.keys(f).length} species for bat ${u}`)):console.warn(" [savePrediction] No valid species data to save")}else if(r&&typeof s=="number"){console.log(` [savePrediction] Fallback save for ${n}`);const u=Z(ee,`servers/${t}/clients/${e}/predictions/${n}`),d={s:r,c:s};i&&(d.d=i),a&&(d.f=a),await Zn(u,d)}else console.warn(" [savePrediction] No data to save - missing folderTimestamp or allSpecies")},tP=async(t,e,n,r)=>{var a,l;let s;if(r){const c=n.includes("_")?`bat_${n.split("_").pop()}`:n;s=Z(ee,`servers/${t}/clients/${e}/predictions/${r}/${c}`)}else s=Z(ee,`servers/${t}/clients/${e}/predictions/${n}`);const i=await pi(s);if(i.exists()){const c=i.val();if(typeof c=="object"&&!c.s&&!c.species){const u=Object.keys(c).sort((d,h)=>parseInt(d)-parseInt(h)).map(d=>({species:c[d].s,confidence:c[d].c}));return{species:((a=u[0])==null?void 0:a.species)||"Unknown",confidence:((l=u[0])==null?void 0:l.confidence)||0,allSpecies:u}}return{species:c.species||c.s,confidence:c.confidence||c.c,allSpecies:c.all_species||c.all||[]}}return null},Wf=async(t,e,n)=>{const r=`servers/${t}/clients/${e}/predictions/${n}`;console.log(` [getFolderPredictions] Reading from: ${r}`);let s=Z(ee,r),i=await pi(s);if(console.log(` [getFolderPredictions] Snapshot exists: ${i.exists()}`),i.exists()){const a=i.val();console.log(" [getFolderPredictions] Raw data keys:",Object.keys(a));const l={};return Object.keys(a).forEach(c=>{var h,f;const u=a[c];if(typeof u!="object"||u===null)return;const d=Object.keys(u).filter(y=>!isNaN(parseInt(y))).sort((y,_)=>parseInt(y)-parseInt(_)).map(y=>{var _,v;return{species:(_=u[y])==null?void 0:_.s,confidence:(v=u[y])==null?void 0:v.c}}).filter(y=>y.species&&typeof y.confidence=="number");if(d.length>0){const y=`bat_${c}.wav`;l[y]={species:((h=d[0])==null?void 0:h.species)||"Unknown",confidence:((f=d[0])==null?void 0:f.confidence)||0,allSpecies:d}}}),console.log(` Loaded ${Object.keys(l).length} predictions for ${n}`),l}return console.log(` No predictions found for ${n}`),{}},ia=(t,e,n)=>{const r=Z(ee,`servers/${t}/clients/${e}/predictions`);return St(r,s=>{const i={};if(s.exists()){const a=s.val();Object.entries(a).forEach(([l,c])=>{var u,d;if(typeof c=="object"&&c!==null){const h=Object.keys(c)[0],f=c[h];if(f&&typeof f=="object"&&"s"in f&&"c"in f){const y=Object.keys(c).filter(v=>!isNaN(parseInt(v))).sort((v,S)=>parseInt(v)-parseInt(S)).map(v=>({species:c[v].s,confidence:c[v].c})),_=`${l}.wav`;i[_]={species:((u=y[0])==null?void 0:u.species)||"Unknown",confidence:((d=y[0])==null?void 0:d.confidence)||0,allSpecies:y},i[l]=i[_]}else Object.entries(c).forEach(([y,_])=>{var v,S;if(typeof _=="object"&&_!==null){const g=Object.keys(_).filter(p=>!isNaN(parseInt(p))).sort((p,m)=>parseInt(p)-parseInt(m)).map(p=>{var m,w;return{species:(m=_[p])==null?void 0:m.s,confidence:(w=_[p])==null?void 0:w.c}}).filter(p=>p.species&&typeof p.confidence=="number");if(g.length>0){const p=`bat_${y}.wav`;i[p]={species:((v=g[0])==null?void 0:v.species)||"Unknown",confidence:((S=g[0])==null?void 0:S.confidence)||0,allSpecies:g},i[`bat_${y}`]=i[p],i[y]=i[p]}}})}})}console.log(" Firebase predictions update:",Object.keys(i).length,"predictions"),n(i)}),()=>Rn(r)},Dv=async(t,e)=>{const n=Z(ee,`servers/${t}/clients/${e}/predictions`),r=await pi(n);if(!r.exists())return;const s=r.val(),i={};let a=!1;Object.entries(s).forEach(([l,c])=>{c&&typeof c=="object"&&"s"in c&&"c"in c?i[l]={s:c.s,c:c.c}:(a=!0,console.log(` Removing invalid prediction format for ${l}:`,c))}),(a||Object.keys(i).length!==Object.keys(s).length)&&(console.log(" Migrating predictions to new structure..."),await Zn(n,i),console.log(" Migration complete!"))},wg=Object.freeze(Object.defineProperty({__proto__:null,createClient:vv,createServer:gv,database:ee,deleteClient:wv,deleteServer:yv,getFolderPredictions:Wf,getPrediction:tP,loadAllServers:_v,migratePredictionsStructure:Dv,resetClient:Nv,resetServer:xv,savePrediction:Hf,setClientLocationCommand:Sv,setConnectCommand:Cv,setInstantCommand:Ev,setScheduleCommand:kv,setServerLocationCommand:bv,setTransmitScheduledCommand:jv,subscribeToActiveStatus:Xl,subscribeToClientInfo:Iv,subscribeToClients:Rv,subscribeToConnectionStatus:Pv,subscribeToMode:Bf,subscribeToPredictions:ia,subscribeToScheduledRecords:Av,subscribeToServerInfo:Tv},Symbol.toStringTag,{value:"Module"})),Lv="https://bat-admin-backend.onrender.com/api",Vf=t=>{if(!t)return"1";const e=t.match(/(\d+)/);return e?e[1]:"1"},qf=t=>{if(!t)return"1";const e=t.match(/(\d+)/);return e?e[1]:"1"},Gf=t=>`server${Vf(t)}`,Kf=t=>`client${qf(t)}`,Ov=t=>t.toLowerCase().split("_").slice(2).join("_"),Lc=async t=>{const{serverId:e,clientId:n,folderName:r}=t,s=Gf(e),i=Kf(n),a=Vf(e),l=qf(n),c=Ov(r);console.log(` [folderPredictions] Loading folder: ${r}`),console.log(`   serverId: ${s}, clientId: ${i}, timestamp: ${c}`);let u={};try{console.log(" [folderPredictions] Step 1: Checking Firebase for cached predictions..."),u=await Wf(s,i,c);const S=Object.keys(u).length;console.log(` [folderPredictions] Found ${S} cached predictions for ${c}`),S>0&&console.log(" [folderPredictions] Cached files:",Object.keys(u))}catch(S){console.warn("[folderPredictions] Could not load existing predictions:",S)}const d=`${Lv}/api/folder/files`,h=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_num:a,client_num:l,folder_timestamp:c})});if(!h.ok)throw new Error(`Failed to list files: ${h.status}`);const f=await h.json();console.log(` [folderPredictions] Found ${f.total_files||0} audio files in Drive`);const y=(f.files||[]).map(S=>{var p,m;const g=u[S.file_name];return g&&g.allSpecies&&g.allSpecies.length>0?{file_id:S.file_id,file_name:S.file_name,size:S.size||0,species:g.allSpecies,predicted_species:g.species||((p=g.allSpecies[0])==null?void 0:p.species)||"Unknown",confidence:g.confidence||((m=g.allSpecies[0])==null?void 0:m.confidence)||0,processing:!1,from_cache:!0,needs_prediction:!1}:{file_id:S.file_id,file_name:S.file_name,size:S.size||0,species:[],predicted_species:"Waiting",confidence:0,processing:!1,from_cache:!1,needs_prediction:!0}}),_=y.filter(S=>S.from_cache).length,v=y.filter(S=>S.needs_prediction).length;return console.log(` [folderPredictions] Loaded ${y.length} files (${_} cached, ${v} waiting)`),{timestamp:c,entries:y,serverNum:a,clientNum:l}},$o=async t=>{var y;const{serverId:e,clientId:n,serverNum:r,clientNum:s,timestamp:i,audio:a,signal:l}=t,c=Gf(e),u=Kf(n);console.log(` [folderPredictions] Predicting: ${a.file_name}`),console.log(`   serverId: ${c}, clientId: ${u}, timestamp: ${i}`);const d=`${Lv}/api/audio/predict`,h=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_id:a.file_id,file_name:a.file_name,server_num:r,client_num:s,folder_timestamp:i}),signal:l});if(!h.ok){const _=await h.text();throw console.error(` [folderPredictions] Prediction failed: ${h.status}`,_),new Error(`Prediction failed: ${h.status}`)}const f=await h.json();if(f.success&&f.species&&f.species.length>0){const _=a.file_name.match(/bat_(\d+)/i),v=_?_[1]:a.file_name.replace(".wav","");console.log(` [folderPredictions] Saving to Firebase: ${c}/${u}/${i}/${v}`);try{await Hf(c,u,v,f.species[0].species,f.species[0].confidence,new Date().toISOString(),((y=f.call_parameters)==null?void 0:y.peak_freq)||"",f.species,i),console.log(` [folderPredictions] Saved prediction for ${a.file_name}`)}catch(S){console.error("[folderPredictions] Firebase save error:",S)}}return{file_id:a.file_id,file_name:a.file_name,size:a.size,species:f.species||[],predicted_species:f.success&&f.species&&f.species.length>0?f.species[0].species:"Error",confidence:f.success&&f.species&&f.species.length>0?f.species[0].confidence:0,processing:!1,from_cache:!1,needs_prediction:!1,error:f.success?void 0:f.message||"Prediction failed"}},nP=Object.freeze(Object.defineProperty({__proto__:null,extractClientNum:qf,extractServerNum:Vf,extractTimestamp:Ov,loadFolderAudioWithPredictions:Lc,normalizeClientId:Kf,normalizeServerId:Gf,predictSingleAudio:$o},Symbol.toStringTag,{value:"Module"})),rP=({serverId:t,serverName:e,clientId:n,clientName:r,isServerBusy:s,currentTargetClient:i,onRemove:a,onOptimisticModeChange:l})=>{const c=Br(),u=b=>{if(b===0)return"0 B";const j=b/1024/1024;return j>=1?`${j.toFixed(1)} MB`:`${(b/1024).toFixed(1)} KB`},[d,h]=x.useState(!1),[f,y]=x.useState(!1),[_,v]=x.useState(!1),[S,g]=x.useState(!1),[p,m]=x.useState(""),[w,N]=x.useState(""),[C,k]=x.useState(""),[T,R]=x.useState("1"),[I,G]=x.useState("5"),[re,ne]=x.useState(""),[ge,K]=x.useState(""),[Le,Q]=x.useState({show:!1,message:"",type:"loading"}),[E,H]=x.useState({}),[M,fe]=x.useState({}),[D,jt]=x.useState({}),[O,U]=x.useState(!1),[$,Ne]=x.useState({status:"idle",progress:0,total_files:0,received_files:0,total_size_bytes:0,transferred_bytes:0}),[Oe,pe]=x.useState([]),[Ie,Se]=x.useState(!1),[Xe,xt]=x.useState(null),[je,le]=x.useState({}),[W,q]=x.useState(null),[L,he]=x.useState(0),[se,ce]=x.useState({}),Re=5,_t=x.useRef(null),[Me,xe]=x.useState(0),rt=5,[$t,Ns]=x.useState(!0),[An,ji]=x.useState(!0),Ke=(()=>{try{return(localStorage.getItem(`recordingClient:${t}`)||"")===n}catch{return!1}})(),Ae=i===n,Fe=Ke?!0:s;x.useEffect(()=>{const b=Iv(t,n,j=>{H(j)});return()=>{b()}},[t,n]),x.useEffect(()=>Bf(t,jt),[t]),x.useEffect(()=>Pv(t,j=>{U(j)}),[t]),x.useEffect(()=>Xl(t,j=>{Ne(j||{status:"idle",progress:0,total_files:0,received_files:0,total_size_bytes:0,transferred_bytes:0})}),[t]),x.useEffect(()=>{if(!t||!n)return;(async()=>{try{Se(!0);const j=e.replace("Server ",""),V=r.replace("Client ",""),F=`https://bat-admin-backend.onrender.com/api/api/folders/${j}/${V}`;console.log(` [${n}] Fetching folders from: ${F}`);const Y=await fetch(F);if(!Y.ok){console.error(` [${n}] Failed to fetch folders: ${Y.status}`);const J=await Y.text();console.error(` [${n}] Error response:`,J),pe([]);return}const B=await Y.json();if(console.log(` [${n}] Received folders:`,B),B.success&&B.folders){const J=B.folders.map(be=>({id:be.id,name:be.name,folderId:be.folder_id,timestamp:be.timestamp,date:be.date,time:be.time,fileCount:be.file_count||0,totalSize:be.total_size_formatted||"0 B",modifiedDate:be.modified_date}));console.log(` [${n}] Setting ${J.length} folders`),pe(J)}else console.warn(` [${n}] No folders in response or success=false`),pe([])}catch(j){console.error(` [${n}] Error fetching folders:`,j)}finally{Se(!1)}})()},[t,n,e,r]),x.useEffect(()=>()=>{_t.current&&(console.log(` [${n}] Component unmounting - cancelling all predictions`),_t.current.abort())},[n]);const ft=async(b,j,V,F)=>{try{const B=j.toLowerCase().split("_").slice(2).join("_");console.log(` [${n}] Re-predicting: ${F.file_name}`),le(It=>{const $e=[...It[b]||[]];return $e[V]&&($e[V]={...$e[V],predicted_species:"Re-predicting...",processing:!0}),{...It,[b]:$e}});const J=e.replace("Server ",""),be=r.replace("Client ",""),_n=await $o({serverId:t,clientId:n,serverNum:J,clientNum:be,timestamp:B,audio:F});le(It=>{const $e=[...It[b]||[]];return $e[V]=_n,{...It,[b]:$e}})}catch(Y){console.error(" Error re-predicting:",Y),le(B=>{const J=[...B[b]||[]];return J[V]&&(J[V]={...J[V],predicted_species:"Error",processing:!1,error:Y.message}),{...B,[b]:J}})}},bs=async(b,j,V=!1)=>{if(!V&&je[b]&&je[b].length>0){const F=je[b].some(B=>B.processing),Y=je[b].some(B=>B.needs_prediction&&!B.processing);if(F){console.log(` [${n}] Folder ${j} is being processed, skipping reload`);return}if(!Y){console.log(` [${n}] All files predicted for ${j}, using cache`);return}console.log(` [${n}] Found ${je[b].filter(B=>B.needs_prediction).length} files still need prediction`)}try{console.log(` [${n}] Loading folder: ${j} (forceRepredict: ${V})`);const{timestamp:F,entries:Y,serverNum:B,clientNum:J}=await Lc({serverId:t,clientId:n,folderName:j});le($e=>({...$e,[b]:Y}));const be=Y.filter($e=>$e.from_cache).length,_n=Y.filter($e=>$e.needs_prediction).length;console.log(` [${n}] Loaded ${Y.length} files: ${be} cached, ${_n} need prediction`);const It=Y.map(($e,sn)=>({entry:$e,index:sn})).filter(({entry:$e})=>$e.needs_prediction);if(It.length>0){console.log(` [${n}] Starting SEQUENTIAL predictions for ${It.length} files`),_t.current=new AbortController;const $e=_t.current.signal;(async()=>{for(const{entry:sn,index:on}of It){if($e.aborted){console.log(` [${n}] Predictions cancelled - stopping at ${sn.file_name}`);break}try{console.log(` [${n}] Predicting ${on+1}/${It.length}: ${sn.file_name}`),le(Dn=>{const Rt=[...Dn[b]||[]];return Rt[on]&&(Rt[on]={...Rt[on],processing:!0,predicted_species:"Processing..."}),{...Dn,[b]:Rt}});const sr=await $o({serverId:t,clientId:n,serverNum:B,clientNum:J,timestamp:F,audio:sn,signal:$e});le(Dn=>{const Rt=[...Dn[b]||[]];return Rt[on]&&(Rt[on]=sr),{...Dn,[b]:Rt}}),console.log(` [${n}] Completed ${on+1}/${It.length}: ${sn.file_name}`)}catch(sr){if(sr instanceof Error&&sr.name==="AbortError"){console.log(` [${n}] Prediction cancelled for ${sn.file_name}`);break}console.error(` [${n}] Prediction error for ${sn.file_name}:`,sr),le(Dn=>{const Rt=[...Dn[b]||[]];return Rt[on]&&(Rt[on]={...Rt[on],processing:!1,predicted_species:"Error",error:sr instanceof Error?sr.message:"Unknown error"}),{...Dn,[b]:Rt}})}}console.log(` [${n}] All predictions completed for ${j}`)})()}}catch(F){console.error(` [${n}] Error loading folder:`,F),le(Y=>({...Y,[b]:[]}))}},Wr=async b=>{if(Xe===b.id)xt(null);else if(xt(b.id),!je[b.id]||je[b.id].length===0){q(b.id);try{await bs(b.id,b.name)}finally{q(null)}}};x.useEffect(()=>{const b=async()=>{const V=`species_predictions_${t}_${n}`;localStorage.removeItem(V),console.log(" Checking Firebase predictions structure..."),await Dv(t,n)},j=ia(t,n,V=>{const F={};Object.entries(V).forEach(([Y,B])=>{F[Y]={species:B.species,confidence:B.confidence||0,date:B.date,frequency:B.frequency}}),ce(F)});return b(),j},[t,n]),x.useEffect(()=>Xl(t,j=>{Ne(j||{status:"idle",progress:0,total_files:0,received_files:0,total_size_bytes:0,transferred_bytes:0})}),[t]),x.useEffect(()=>{if(console.log(`[${n}] Mode changed:`,D.type,"isActive:",Ae),D.type==="client_location"&&D.target_client_id===n){console.log(`[${n}] Showing location status card`),Q({show:!0,message:"Getting location...",type:"loading"});try{localStorage.setItem(`locatingClient:${t}`,n)}catch{}}else if(D.type==="connect"&&D.target_client_id===n){console.log(`[${n}] Showing connect status card`),Q({show:!0,message:"Connecting...",type:"loading"});try{localStorage.setItem(`connectingClient:${t}`,n)}catch{}}else if(D.type==="instant"&&D.target_client_id===n){console.log(`[${n}] Showing instant progress status card`),Q({show:!0,message:"Connecting...",type:"progress"});try{localStorage.setItem(`instantClient:${t}`,n)}catch{}}else if(D.type==="schedule"&&D.target_client_id===n){console.log(`[${n}] Showing schedule status card`),Q({show:!0,message:"Scheduling",type:"loading"});try{localStorage.setItem(`schedulingClient:${t}`,n),localStorage.setItem(`schedulingKey:${t}:${n}`,D.schedule_key||""),localStorage.setItem(`schedulingDuration:${t}:${n}`,String(D.duration_sec||0))}catch{}}else if(D.type==="transmit_scheduled"&&D.target_client_id===n){console.log(`[${n}] Showing transmit scheduled progress status card`),Q({show:!0,message:"Transmitting...",type:"progress"});try{localStorage.setItem(`transmittingClient:${t}`,n),localStorage.setItem(`transmittingKey:${t}:${n}`,D.schedule_key||"")}catch{}}else if(D.type==="idle"){console.log(`[${n}] Mode idle, closing status card`);const b=localStorage.getItem(`instantClient:${t}`)||"",j=localStorage.getItem(`schedulingClient:${t}`)||"",V=localStorage.getItem(`connectingClient:${t}`)||"",F=localStorage.getItem(`locatingClient:${t}`)||"",Y=localStorage.getItem(`recordingClient:${t}`)||"",B=localStorage.getItem(`transmittingClient:${t}`)||"",J=localStorage.getItem(`instantSuccessAt:${t}:${n}`),be=localStorage.getItem(`scheduleSuccessAt:${t}:${n}`),_n=localStorage.getItem(`connectSuccessAt:${t}:${n}`),It=localStorage.getItem(`locationSuccessAt:${t}:${n}`),$e=localStorage.getItem(`transmitReadyAt:${t}:${n}`),sn=localStorage.getItem(`transmitSuccessAt:${t}:${n}`);if(!(b===n&&J)&&!(j===n&&be)&&!(V===n&&_n)&&!(F===n&&It)&&!(Y===n&&$e)&&!(B===n&&sn)){Q({show:!1,message:"",type:"loading"});try{b===n&&!J&&localStorage.removeItem(`instantClient:${t}`),j===n&&!be&&localStorage.removeItem(`schedulingClient:${t}`),V===n&&!_n&&localStorage.removeItem(`connectingClient:${t}`),F===n&&!It&&localStorage.removeItem(`locatingClient:${t}`),Y===n&&!$e&&localStorage.removeItem(`recordingClient:${t}`),B===n&&!sn&&localStorage.removeItem(`transmittingClient:${t}`)}catch{}}}},[D.type,D.target_client_id,D.schedule_key,D.duration_sec,n,t]);const Ut=x.useRef(null);x.useEffect(()=>{let b="";try{b=localStorage.getItem(`locatingClient:${t}`)||""}catch{}const j=b===n;if(!(D.type==="client_location"&&D.target_client_id===n||j)||!((E==null?void 0:E.location_updated)===!0))return;let F=b||"";if(F||(F=D.target_client_id||""),F!==n)return;Q({show:!0,message:"Location updated",type:"success"});try{localStorage.setItem(`locationPrevUpdatedAt:${t}:${n}`,(E==null?void 0:E.location_updated_at)||new Date().toISOString())}catch{}let Y=5e3;try{const J=`locationSuccessAt:${t}:${n}`,be=localStorage.getItem(J);if(be){const _n=Date.now()-new Date(be).getTime();Y=Math.max(0,5e3-_n)}else localStorage.setItem(J,new Date().toISOString())}catch{}Ut.current&&(window.clearTimeout(Ut.current),Ut.current=null);const B=window.setTimeout(async()=>{try{const J=new Date().toISOString(),be=Z(ee,`servers/${t}/mode`);await We(be,{type:"idle",target_client_id:"",updated_at:J});try{const _n=Z(ee,`servers/${t}/clients/${n}/client_info`);await We(_n,{location_updated:!1})}catch{}typeof l=="function"&&l({type:"idle",target_client_id:"",updated_at:J})}catch(J){console.error("Failed to reset after location success:",J)}finally{Q({show:!1,message:"",type:"loading"});try{localStorage.removeItem(`locationSuccessAt:${t}:${n}`),localStorage.removeItem(`locatingClient:${t}`),localStorage.removeItem(`locationPrevUpdatedAt:${t}:${n}`),localStorage.removeItem(`locationBaseline:${t}:${n}`)}catch{}}},Y);return Ut.current=B,()=>{Ut.current&&(window.clearTimeout(Ut.current),Ut.current=null)}},[E==null?void 0:E.lat,E==null?void 0:E.long,E==null?void 0:E.location_name,E==null?void 0:E.location_updated_at,E==null?void 0:E.location_updated,D==null?void 0:D.type,D==null?void 0:D.target_client_id,D==null?void 0:D.updated_at,n,t]);const Tt=x.useRef(null);x.useEffect(()=>{if(!O)return;let b="";try{b=localStorage.getItem(`connectingClient:${t}`)||""}catch{}if(!b&&(D==null?void 0:D.type)==="connect"&&(b=D.target_client_id||""),b!==n)return;Q({show:!0,message:"Successfully connected",type:"success"});let j=5e3;try{const F=`connectSuccessAt:${t}:${n}`,Y=localStorage.getItem(F);if(Y){const B=Date.now()-new Date(Y).getTime();j=Math.max(0,5e3-B)}else localStorage.setItem(F,new Date().toISOString())}catch{}const V=window.setTimeout(async()=>{try{const F=new Date().toISOString(),Y=Z(ee,`servers/${t}/mode`);await We(Y,{type:"idle",target_client_id:"",updated_at:F});const B=Z(ee,`servers/${t}`);await We(B,{connection_status:!1}),typeof l=="function"&&l({type:"idle",target_client_id:"",updated_at:F})}catch(F){console.error("Failed to reset after connect success:",F)}finally{Q({show:!1,message:"",type:"loading"});try{const F=`connectSuccessAt:${t}:${n}`;localStorage.removeItem(F),localStorage.removeItem(`connectingClient:${t}`)}catch{}}},j);return Tt.current=V,()=>{Tt.current&&(window.clearTimeout(Tt.current),Tt.current=null)}},[O,t,n]);const Pt=x.useRef(null);x.useEffect(()=>{let b="";try{b=localStorage.getItem(`instantClient:${t}`)||""}catch{}if(!(b===n)||$.status!=="completed")return;Q({show:!0,message:"Successfully recorded and uploaded to DB",type:"success"});let V=5e3;try{const Y=`instantSuccessAt:${t}:${n}`,B=localStorage.getItem(Y);if(B){const J=Date.now()-new Date(B).getTime();V=Math.max(0,5e3-J)}else localStorage.setItem(Y,new Date().toISOString())}catch{}Pt.current&&(window.clearTimeout(Pt.current),Pt.current=null);const F=window.setTimeout(async()=>{try{const Y=new Date().toISOString(),B=Z(ee,`servers/${t}/mode`);await We(B,{type:"idle",target_client_id:"",duration_sec:0,updated_at:Y});const J=Z(ee,`servers/${t}/active_status`);await We(J,{status:"idle",progress:0,total_files:0,received_files:0,total_size_bytes:0,transferred_bytes:0}),typeof l=="function"&&l({type:"idle",target_client_id:"",updated_at:Y})}catch(Y){console.error("Failed to reset after instant success:",Y)}finally{Q({show:!1,message:"",type:"loading"});try{localStorage.removeItem(`instantSuccessAt:${t}:${n}`),localStorage.removeItem(`instantClient:${t}`)}catch{}}},V);return Pt.current=F,()=>{Pt.current&&(window.clearTimeout(Pt.current),Pt.current=null)}},[$.status,t,n]);const rr=x.useRef(null),Vr=x.useRef("");x.useEffect(()=>{let b="",j="";try{b=localStorage.getItem(`schedulingClient:${t}`)||"",j=localStorage.getItem(`schedulingKey:${t}:${n}`)||""}catch{}if(b!==n||!j)return;const V=M[j];if(!V||V.status!=="scheduled"||Vr.current===j)return;Vr.current=j,Q({show:!0,message:"Successfully Scheduled",type:"success"});let F=5e3;try{const B=`scheduleSuccessAt:${t}:${n}`,J=localStorage.getItem(B);if(J){const be=Date.now()-new Date(J).getTime();F=Math.max(0,5e3-be)}else localStorage.setItem(B,new Date().toISOString())}catch{}const Y=window.setTimeout(async()=>{try{const B=new Date().toISOString(),J=Z(ee,`servers/${t}/mode`);await We(J,{type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:B}),typeof l=="function"&&l({type:"idle",target_client_id:"",updated_at:B})}catch(B){console.error("Failed to reset after schedule success:",B)}finally{Q({show:!1,message:"",type:"loading"}),Vr.current="";try{localStorage.removeItem(`scheduleSuccessAt:${t}:${n}`),localStorage.removeItem(`schedulingClient:${t}`),localStorage.removeItem(`schedulingKey:${t}:${n}`),localStorage.removeItem(`schedulingDuration:${t}:${n}`)}catch{}}},F);rr.current=Y},[M,t,n]);const Oc=x.useRef("");x.useEffect(()=>{let b="",j=null;if(Object.entries(M).forEach(([V,F])=>{F&&F.status==="recording"&&(b=V,j=F)}),b&&j){if(Oc.current===b)return;Oc.current=b,Q({show:!0,message:"Recording",type:"loading"});try{localStorage.setItem(`recordingClient:${t}`,n),localStorage.setItem(`recordingKey:${t}:${n}`,b)}catch{}}},[M,n,t,l]);const $v=x.useRef(null),Mc=x.useRef("");x.useEffect(()=>{let b="",j="";try{b=localStorage.getItem(`recordingClient:${t}`)||"",j=localStorage.getItem(`recordingKey:${t}:${n}`)||""}catch{}if(b!==n||!j)return;const V=M[j];if(!V||V.status!=="ready_to_transmit"||Mc.current===j)return;Mc.current=j,Q({show:!0,message:"Ready to transmit",type:"success"});let F=5e3;try{const B=`transmitReadyAt:${t}:${n}`,J=localStorage.getItem(B);if(J){const be=Date.now()-new Date(J).getTime();F=Math.max(0,5e3-be)}else localStorage.setItem(B,new Date().toISOString())}catch{}const Y=window.setTimeout(async()=>{try{const B=new Date().toISOString(),J=Z(ee,`servers/${t}/mode`);await We(J,{type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:B}),typeof l=="function"&&l({type:"idle",target_client_id:"",updated_at:B})}catch(B){console.error("Failed to reset after transmit ready:",B)}finally{Q({show:!1,message:"",type:"loading"}),Oc.current="",Mc.current="";try{localStorage.removeItem(`transmitReadyAt:${t}:${n}`),localStorage.removeItem(`recordingClient:${t}`),localStorage.removeItem(`recordingKey:${t}:${n}`)}catch{}}},F);$v.current=Y},[M,t,n,l]);const qr=x.useRef(null);x.useEffect(()=>{let b="",j="";try{b=localStorage.getItem(`transmittingClient:${t}`)||"",j=localStorage.getItem(`transmittingKey:${t}:${n}`)||""}catch{}if(b!==n||!$||$.status!=="completed")return;Q({show:!0,message:"Schedule transmission completed",type:"success"});let V=5e3;try{const Y=`transmitSuccessAt:${t}:${n}`,B=localStorage.getItem(Y);if(B){const J=Date.now()-new Date(B).getTime();V=Math.max(0,5e3-J)}else localStorage.setItem(Y,new Date().toISOString())}catch{}qr.current&&(window.clearTimeout(qr.current),qr.current=null);const F=window.setTimeout(async()=>{try{const Y=new Date().toISOString();if(j){const be=Z(ee,`servers/${t}/clients/${n}/scheduled_records/${j}`);await We(be,{status:"completed"})}const B=Z(ee,`servers/${t}/mode`);await We(B,{type:"idle",target_client_id:"",schedule_key:"",duration_sec:0,updated_at:Y});const J=Z(ee,`servers/${t}/active_status`);await We(J,{status:"idle",progress:0,total_files:0,received_files:0,total_size_bytes:0,transferred_bytes:0}),typeof l=="function"&&l({type:"idle",target_client_id:"",updated_at:Y})}catch(Y){console.error("Failed to reset after transmit success:",Y)}finally{Q({show:!1,message:"",type:"loading"});try{localStorage.removeItem(`transmitSuccessAt:${t}:${n}`),localStorage.removeItem(`transmittingClient:${t}`),localStorage.removeItem(`transmittingKey:${t}:${n}`)}catch{}}},V);return qr.current=F,()=>{qr.current&&(window.clearTimeout(qr.current),qr.current=null)}},[$.status,t,n,l]),x.useEffect(()=>Av(t,n,j=>{const V=j||{};V._placeholder&&delete V._placeholder,fe(V)}),[t,n]),x.useEffect(()=>{const b=()=>{_&&v(!1)};return _&&document.addEventListener("click",b),()=>{document.removeEventListener("click",b)}},[_]);const Uv=async()=>{try{const b=new Date().toISOString();Q({show:!0,message:"Connecting...",type:"loading"});try{localStorage.setItem(`connectingClient:${t}`,n)}catch{}typeof l=="function"&&l({type:"connect",target_client_id:n,updated_at:b}),await Cv(t,n)}catch(b){console.error("Failed to send connect command:",b),Q({show:!1,message:"",type:"loading"})}},zv=async()=>{try{const b=new Date().toISOString();Q({show:!0,message:"Getting location...",type:"loading"});try{localStorage.setItem(`locatingClient:${t}`,n);const j={lat:(E==null?void 0:E.lat)??null,long:(E==null?void 0:E.long)??null,location_name:(E==null?void 0:E.location_name)??null};localStorage.setItem(`locationBaseline:${t}:${n}`,JSON.stringify(j))}catch{}typeof l=="function"&&l({type:"client_location",target_client_id:n,updated_at:b}),await Sv(t,n)}catch(b){console.error("Failed to send client location command:",b),Q({show:!1,message:"",type:"loading"})}},Bv=async()=>{const b=parseInt(T);if(isNaN(b)||b<=0){alert("Please enter a valid duration in minutes");return}try{h(!1),R("1");const j=new Date().toISOString(),V=b*60;Q({show:!0,message:"Connecting...",type:"progress"});try{localStorage.setItem(`instantClient:${t}`,n)}catch{}typeof l=="function"&&l({type:"instant",target_client_id:n,duration_sec:V,updated_at:j}),await Ev(t,n,V)}catch(j){console.error("Failed to send instant command:",j),Q({show:!1,message:"",type:"loading"})}},Hv=async()=>{const b=parseInt(I);if(isNaN(b)||b<=0){alert("Please enter a valid duration in minutes");return}if(!re||!ge){alert("Please select both date and time");return}try{const j=`${re}T${ge}:00`,V=b*60;l&&l({type:"schedule",target_client_id:n,duration_sec:V,schedule_key:j,updated_at:new Date().toISOString()}),y(!1),G("5"),ne(""),K(""),kv(t,n,V,j).catch(F=>{console.error("Failed to send schedule command:",F)})}catch(j){console.error("Failed to process schedule:",j)}},Wv=async b=>{try{const j=new Date().toISOString();l&&l({type:"transmit_scheduled",target_client_id:n,schedule_key:b,updated_at:j});try{localStorage.setItem(`transmittingClient:${t}`,n),localStorage.setItem(`transmittingKey:${t}:${n}`,b)}catch{}jv(t,n,b).catch(V=>{console.error("Failed to send transmit command:",V)})}catch(j){console.error("Failed to start transmit:",j)}},Vv=async()=>{if(window.confirm(`Are you sure you want to reset ${r}? This will reset all keys under this client.`))try{const b=new Date().toISOString();jt({type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:b}),typeof l=="function"&&l({type:"idle",target_client_id:"",updated_at:b}),v(!1),Q({show:!1,message:"",type:"loading"}),await Nv(t,n),console.log("Client reset successfully")}catch(b){console.error("Failed to reset client:",b)}},qv=()=>{var b,j;m(((b=E.lat)==null?void 0:b.toString())||"0"),N(((j=E.long)==null?void 0:j.toString())||"0"),k(E.location_name||"Not set"),g(!0)},Gv=async()=>{try{const b=parseFloat(p),j=parseFloat(w);if(isNaN(b)||isNaN(j)){alert("Please enter valid latitude and longitude");return}const V=Z(ee,`servers/${t}/clients/${n}/client_info`);await We(V,{lat:b,long:j,location_name:C||"Not set"}),g(!1),console.log("Location updated successfully")}catch(b){console.error("Failed to update location:",b),alert("Failed to update location")}},Kv=()=>{const b=Oe.map(j=>({folder_id:j.id,name:j.name,timestamp:j.timestamp,date:j.date||"-",time:j.time||"-",fileCount:j.fileCount||0,totalSize:j.totalSize||"-"}));c("/data-history-maximize",{state:{folders:b,clientName:r,serverName:e,serverId:t,clientId:n}})},Qv=()=>{const b=Object.entries(M).filter(([j])=>j!=="_placeholder").map(([j,V])=>{const F=new Date(j);return{scheduleKey:j,date:F.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),time:F.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),duration:Math.floor((V.duration_sec||0)/60),status:V.status||"unknown"}});c("/scheduled-recordings-full",{state:{data:b,clientName:r,serverName:e,serverId:t,clientId:n}})},Yv=Oe.slice(L*Re,(L+1)*Re),aa=Math.ceil(Oe.length/Re),Qf=E.location_name&&E.location_name!=="Not set"?E.location_name:"Location not set",Xv=E.lat&&E.long&&E.lat!==0&&E.long!==0;return o.jsxs("div",{className:"bg-white rounded-lg border border-slate-700 shadow-sm hover:shadow-md transition-shadow overflow-hidden",children:[o.jsx("div",{className:"bg-gradient-to-r from-gray-50 via-gray-100 to-gray-50 px-4 py-3 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-bold text-base text-gray-900",children:r}),o.jsxs("div",{className:"text-gray-600 text-xs flex items-center gap-1",children:[Xv?o.jsx("a",{href:`https://www.google.com/maps?q=${E.lat},${E.long}`,target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-blue-600",children:Qf}):o.jsx("span",{children:Qf}),o.jsx("button",{onClick:b=>{b.stopPropagation(),qv()},className:"ml-1 p-0.5 hover:bg-gray-200 rounded transition-colors",title:"Edit location",children:o.jsx(rx,{className:"w-3 h-3"})})]})]}),(Ae||Ke)&&o.jsx("span",{className:"px-2 py-1 bg-amber-400 text-amber-900 text-xs rounded-full font-medium ml-2",children:"Active"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:b=>{b.preventDefault(),Uv()},disabled:Fe,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${Fe?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-50 text-blue-700 hover:bg-blue-100 border border-blue-200"}`,children:[o.jsx(eS,{className:"w-4 h-4"}),"Connect"]}),o.jsxs("button",{onClick:zv,disabled:Fe,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${Fe?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-purple-50 text-purple-700 hover:bg-purple-100 border border-purple-200"}`,children:[o.jsx(qh,{className:"w-4 h-4"}),"Location"]}),o.jsxs("button",{onClick:()=>h(!0),disabled:Fe,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${Fe?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-green-50 text-green-700 hover:bg-green-100 border border-green-200"}`,children:[o.jsx(nS,{className:"w-4 h-4"}),"Instant"]}),o.jsxs("button",{onClick:()=>y(!0),disabled:Fe,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${Fe?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-orange-50 text-orange-700 hover:bg-orange-100 border border-orange-200"}`,children:[o.jsx(Xb,{className:"w-4 h-4"}),"Schedule"]}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:b=>{b.stopPropagation(),v(!_)},className:"w-8 h-8 rounded-md border border-gray-300 flex items-center justify-center transition-colors hover:bg-gray-200 text-gray-700 hover:text-gray-900",title:"Client options",children:o.jsx(tx,{className:"w-4 h-4"})}),_&&o.jsx("div",{className:"absolute right-0 top-full mt-1 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50 min-w-[150px]",onClick:b=>b.stopPropagation(),children:o.jsx("button",{onClick:b=>{b.stopPropagation(),Vv()},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Reset Client"})})]}),o.jsx("button",{onClick:a,disabled:Fe,className:`w-8 h-8 rounded-md border flex items-center justify-center transition-colors ${Fe?"border-gray-300 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-200 hover:text-red-600"}`,children:o.jsx(Gh,{className:"w-4 h-4"})})]})]})}),o.jsxs("div",{className:"p-4",children:[Le.show&&o.jsx(o.Fragment,{children:Le.type==="progress"?o.jsx("div",{className:"mb-3 px-4 py-4 rounded-lg text-sm bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200",children:o.jsxs("div",{className:"space-y-3",children:[D.type==="instant"&&o.jsxs("div",{className:"flex items-center gap-3",children:[$.status==="idle"||$.status!=="recording"&&$.status!=="transmitting"&&$.status!=="uploading"&&$.status!=="completed"?o.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}):o.jsx(Yr,{className:"w-5 h-5 text-green-600"}),o.jsx("span",{className:"font-medium text-gray-700",children:"Connecting..."})]}),D.type==="instant"&&($.status==="recording"||$.status==="transmitting"||$.status==="uploading"||$.status==="completed")&&o.jsxs("div",{className:"flex items-center gap-3",children:[$.status==="recording"?o.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}):o.jsx(Yr,{className:"w-5 h-5 text-green-600"}),o.jsx("span",{className:"font-medium text-gray-700",children:"Recording"})]}),($.status==="transmitting"||$.status==="uploading"||$.status==="completed"||D.type==="transmit_scheduled"&&$.status==="idle")&&o.jsxs("div",{className:"flex items-center gap-3",children:[$.status==="transmitting"||D.type==="transmit_scheduled"&&$.status==="idle"?o.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}):o.jsx(Yr,{className:"w-5 h-5 text-green-600"}),o.jsx("span",{className:"font-medium text-gray-700",children:"Transmitting"}),D.type==="transmit_scheduled"&&D.schedule_key&&o.jsxs("div",{className:"flex items-center gap-2 ml-auto flex-wrap",children:[o.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-700 rounded-md text-[10px] font-medium border border-blue-400/30",children:D.schedule_key}),o.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-700 rounded-md text-[10px] font-medium border border-indigo-400/30",children:new Date(D.schedule_key).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),o.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-700 rounded-md text-[10px] font-medium border border-purple-400/30",children:new Date(D.schedule_key).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),o.jsxs("span",{className:"px-2 py-0.5 bg-pink-500/20 text-pink-700 rounded-md text-[10px] font-medium border border-pink-400/30",children:[(()=>{const b=M[D.schedule_key];return Math.floor((b&&b.duration_sec||0)/60)})(),"min"]})]}),$.status==="transmitting"&&o.jsxs("div",{className:`flex items-center gap-2 ${D.type==="transmit_scheduled"?"":"ml-auto"}`,children:[o.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium",children:[$.received_files,"/",$.total_files," files"]}),o.jsxs("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-700 rounded text-xs font-medium",children:[u($.transferred_bytes),"/",u($.total_size_bytes)]})]})]}),($.status==="uploading"||$.status==="completed")&&o.jsxs("div",{className:"flex items-center gap-3",children:[$.status==="uploading"?o.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}):o.jsx(Yr,{className:"w-5 h-5 text-green-600"}),o.jsx("span",{className:"font-medium text-gray-700",children:"Uploading to DB"})]}),$.status==="completed"&&o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Yr,{className:"w-5 h-5 text-green-600"}),o.jsx("span",{className:"font-medium text-green-700",children:"Completed"})]}),$.status!=="idle"&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[o.jsx("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:o.jsxs("span",{children:["Progress: ",$.progress,"%"]})}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${$.progress}%`}})})]})]})}):o.jsx("div",{className:`mb-3 px-4 py-3 rounded-lg text-sm font-medium ${Le.type==="loading"?"bg-blue-50 text-blue-700 border border-blue-200":"bg-green-50 text-green-700 border border-green-200"}`,children:o.jsxs("div",{className:"flex items-center gap-3",children:[Le.type==="loading"?o.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}):o.jsx(Yr,{className:"w-5 h-5"}),o.jsx("span",{children:Le.message}),D.type==="schedule"&&D.target_client_id===n&&D.schedule_key&&o.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[o.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-700 rounded-md text-[10px] font-medium border border-blue-400/30",children:new Date(D.schedule_key).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),o.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-700 rounded-md text-[10px] font-medium border border-indigo-400/30",children:new Date(D.schedule_key).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),o.jsxs("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-700 rounded-md text-[10px] font-medium border border-purple-400/30",children:[Math.floor((D.duration_sec||0)/60),"min"]})]}),Ke&&(()=>{let b="";try{b=localStorage.getItem(`recordingKey:${t}:${n}`)||""}catch{}const j=b?M[b]:null;return!b||!j?null:o.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[o.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-700 rounded-md text-[10px] font-medium border border-blue-400/30",children:b}),o.jsx("span",{className:"px-2 py-0.5 bg-indigo-500/20 text-indigo-700 rounded-md text-[10px] font-medium border border-indigo-400/30",children:new Date(b).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),o.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-700 rounded-md text-[10px] font-medium border border-purple-400/30",children:new Date(b).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),o.jsxs("span",{className:"px-2 py-0.5 bg-pink-500/20 text-pink-700 rounded-md text-[10px] font-medium border border-pink-400/30",children:[Math.floor((j.duration_sec||0)/60),"min"]})]})})()]})})}),Object.keys(M).filter(b=>b!=="_placeholder").length>0&&o.jsxs("div",{className:"border-t pt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("button",{onClick:()=>Ns(!$t),className:"flex items-center gap-2 text-xs font-semibold text-slate-700 hover:text-slate-900 transition-colors",children:[$t?o.jsx(dr,{className:"w-4 h-4"}):o.jsx(Yt,{className:"w-4 h-4"}),"Scheduled Recordings"]}),!$t&&o.jsxs("button",{onClick:Qv,className:"flex items-center gap-1 px-2 py-1 text-[10px] bg-emerald-50 text-emerald-700 rounded hover:bg-emerald-100 border border-emerald-200 transition-colors",title:"View all scheduled recordings",children:[o.jsx(bl,{className:"w-3 h-3"}),"Maximize"]})]}),!$t&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-xs border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-slate-100",children:[o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Schedule ID"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Date"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Time"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Duration"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Status"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Action"})]})}),o.jsx("tbody",{children:Object.entries(M).filter(([b])=>b!=="_placeholder").slice(Me*rt,(Me+1)*rt).map(([b,j])=>{const V=new Date(b),F=V.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Y=V.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),B=Math.floor((j.duration_sec||0)/60);return o.jsxs("tr",{className:"hover:bg-slate-50",children:[o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-blue-600 font-bold",children:b}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700",children:F}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700",children:Y}),o.jsxs("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700",children:[B,"min"]}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5",children:o.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-[10px] font-medium ${j.status==="scheduled"?"bg-yellow-100 text-yellow-700":j.status==="recording"?"bg-blue-100 text-blue-700":j.status==="ready_to_transmit"?"bg-green-100 text-green-700":j.status==="transmitting"?"bg-orange-100 text-orange-700":j.status==="completed"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:j.status})}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-center",children:o.jsx("button",{onClick:()=>Wv(b),disabled:j.status!=="ready_to_transmit"||Fe||j.status==="completed",className:`px-2 py-1 rounded text-[10px] ${j.status==="ready_to_transmit"&&!Fe?"bg-blue-600 text-white hover:bg-blue-700 cursor-pointer":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,title:j.status==="completed"?"Completed":j.status==="ready_to_transmit"&&!Fe?"Start Transmit":"Transmit (disabled)",children:"Transmit"})})]},b)})})]})}),(()=>{const b=Object.entries(M).filter(([V])=>V!=="_placeholder"),j=Math.ceil(b.length/rt);return j>1?o.jsxs("div",{className:"flex items-center justify-between mt-2",children:[o.jsxs("div",{className:"text-[10px] text-gray-600",children:["Showing ",Me*rt+1,"-",Math.min((Me+1)*rt,b.length)," of ",b.length]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>xe(Math.max(0,Me-1)),disabled:Me===0,className:"p-1 rounded border border-gray-300 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Previous page",children:o.jsx(vd,{className:"w-3 h-3"})}),o.jsxs("span",{className:"text-[10px] text-gray-600 px-2",children:[Me+1," / ",j]}),o.jsx("button",{onClick:()=>xe(Math.min(j-1,Me+1)),disabled:Me>=j-1,className:"p-1 rounded border border-gray-300 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Next page",children:o.jsx(dr,{className:"w-3 h-3"})})]})]}):null})()]})]}),o.jsxs("div",{className:"border-t pt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("button",{onClick:()=>ji(!An),className:"flex items-center gap-2 text-xs font-semibold text-slate-700 hover:text-slate-900 transition-colors",children:[An?o.jsx(dr,{className:"w-4 h-4"}):o.jsx(Yt,{className:"w-4 h-4"}),"Data History"]}),!An&&o.jsxs("button",{onClick:Kv,disabled:Oe.length===0,className:"flex items-center gap-1 px-2 py-1 text-[10px] bg-emerald-50 text-emerald-700 rounded hover:bg-emerald-100 border border-emerald-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"View all history",children:[o.jsx(bl,{className:"w-3 h-3"}),"Maximize"]})]}),!An&&o.jsx(o.Fragment,{children:Ie?o.jsxs("div",{className:"text-center py-4 text-xs text-gray-500",children:[o.jsx(Ye,{className:"w-5 h-5 animate-spin mx-auto mb-2"}),"Loading folders from Drive..."]}):Oe.length===0?o.jsx("div",{className:"text-center py-4 text-xs text-gray-500",children:"No BAT recording folders found"}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-xs border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-slate-100",children:[o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700 w-8"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Folder Name"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Date"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Time"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Files"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Size"})]})}),o.jsx("tbody",{children:Yv.map((b,j)=>{var V;return o.jsxs(Rg.Fragment,{children:[o.jsxs("tr",{className:"hover:bg-emerald-50 transition-colors",children:[o.jsx("td",{className:"border border-slate-300 px-1 py-1.5 text-center",children:o.jsx("button",{onClick:()=>Wr(b),className:"p-0.5 hover:bg-slate-200 rounded transition-colors",children:W===b.id?o.jsx(Ye,{className:"w-3 h-3 animate-spin text-emerald-600"}):Xe===b.id?o.jsx(Yt,{className:"w-3 h-3 text-slate-600"}):o.jsx(dr,{className:"w-3 h-3 text-slate-600"})})}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-blue-600 font-semibold hover:underline cursor-pointer",onClick:()=>c(`/folder/${e.replace("Server ","")}/${r.replace("Client ","")}/${b.timestamp}`,{state:{folderName:b.name,folderId:b.id}}),children:b.name}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700",children:b.date||"-"}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700",children:b.time||"-"}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700 text-center",children:b.fileCount||0}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700",children:b.totalSize||"0 B"})]}),Xe===b.id&&o.jsx("tr",{children:o.jsx("td",{colSpan:6,className:"border border-slate-300 p-0 bg-slate-50",children:W===b.id?o.jsxs("div",{className:"text-center py-4 text-xs text-gray-500",children:[o.jsx(Ye,{className:"w-4 h-4 animate-spin mx-auto mb-1"}),"Loading bat calls..."]}):((V=je[b.id])==null?void 0:V.length)>0?o.jsx("div",{className:"p-2",children:o.jsxs("table",{className:"w-full text-xs border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-emerald-100",children:[o.jsx("th",{className:"border border-emerald-200 px-2 py-1 text-left font-semibold text-emerald-800",children:"Audio File"}),o.jsx("th",{className:"border border-emerald-200 px-2 py-1 text-left font-semibold text-emerald-800",children:"Top 5 Species"}),o.jsx("th",{className:"border border-emerald-200 px-2 py-1 text-center font-semibold text-emerald-800 w-16",children:"Action"})]})}),o.jsx("tbody",{children:je[b.id].map((F,Y)=>o.jsxs("tr",{className:"hover:bg-emerald-50",children:[o.jsxs("td",{className:"border border-emerald-200 px-2 py-1 text-slate-700",children:[F.file_name,F.from_cache&&o.jsx("span",{className:"ml-1 text-[9px] text-gray-500",children:"(cached)"})]}),o.jsx("td",{className:"border border-emerald-200 px-2 py-1",children:o.jsx("div",{className:"flex flex-wrap gap-1",children:F.processing?o.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-yellow-100 text-yellow-800",children:[o.jsx(Ye,{className:"w-3 h-3 animate-spin mr-1"}),F.predicted_species||"Processing..."]}):F.species&&F.species.length>0?o.jsxs(o.Fragment,{children:[F.species.slice(0,5).map((B,J)=>o.jsxs("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium ${J===0?"bg-emerald-100 text-emerald-800":J===1?"bg-blue-100 text-blue-800":J===2?"bg-purple-100 text-purple-800":J===3?"bg-orange-100 text-orange-800":"bg-pink-100 text-pink-800"}`,children:[B.species," (",B.confidence,"%)"]},J)),F.species.length>5&&o.jsxs("span",{className:"inline-flex items-center justify-center w-5 h-5 bg-gray-200 text-gray-700 rounded-full text-[10px] font-bold",children:["+",F.species.length-5]})]}):F.predicted_species==="Error"?o.jsxs("span",{className:"text-red-500 italic text-[10px]",title:F.error,children:["Processing failed ",F.error&&"(hover for error)"]}):F.predicted_species==="Processing"?o.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-blue-100 text-blue-800",children:[o.jsx(Ye,{className:"w-3 h-3 animate-spin mr-1"}),"Processing..."]}):F.predicted_species==="Waiting"?o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-yellow-100 text-yellow-700",children:"Waiting..."}):o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-gray-100 text-gray-600",children:"Waiting.."})})}),o.jsx("td",{className:"border border-emerald-200 px-1 py-1 text-center",children:!F.processing&&o.jsx("button",{onClick:B=>{B.stopPropagation(),ft(b.id,b.name,Y,F)},className:"p-1 text-blue-600 hover:text-blue-800 rounded-full hover:bg-blue-50 transition-colors",title:"Re-predict species",children:o.jsx(Cl,{className:"w-3 h-3"})})})]},Y))})]})}):o.jsx("div",{className:"text-center py-3 text-xs text-gray-500",children:"No audio files found in this folder"})})})]},`${b.id}-${j}`)})})]})}),aa>1&&o.jsxs("div",{className:"flex items-center justify-between mt-2",children:[o.jsxs("div",{className:"text-[10px] text-gray-600",children:["Showing ",L*Re+1,"-",Math.min((L+1)*Re,Oe.length)," of ",Oe.length]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>he(Math.max(0,L-1)),disabled:L===0,className:"p-1 rounded border border-gray-300 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Previous page",children:o.jsx(vd,{className:"w-3 h-3"})}),o.jsxs("span",{className:"text-[10px] text-gray-600 px-2",children:[L+1," / ",aa]}),o.jsx("button",{onClick:()=>he(Math.min(aa-1,L+1)),disabled:L>=aa-1,className:"p-1 rounded border border-gray-300 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Next page",children:o.jsx(dr,{className:"w-3 h-3"})})]})]})]})})]}),d&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-4",children:"Instant Recording"}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Duration (minutes)"}),o.jsx("input",{type:"number",value:T,onChange:b=>R(b.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",min:"1"})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:Bv,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Start Recording"}),o.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})}),f&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-4",children:"Schedule Recording"}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Date"}),o.jsx("input",{type:"date",value:re,onChange:b=>ne(b.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"})]}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Time"}),o.jsx("input",{type:"time",value:ge,onChange:b=>K(b.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"})]}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Duration (minutes)"}),o.jsx("input",{type:"number",value:I,onChange:b=>G(b.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",min:"1"})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:Hv,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700",children:"Schedule"}),o.jsx("button",{onClick:()=>y(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})}),S&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-4",children:"Edit Client Location"}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Location Name"}),o.jsx("input",{type:"text",value:C,onChange:b=>k(b.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"e.g., Branch Office"})]}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Latitude"}),o.jsx("input",{type:"number",step:"any",value:p,onChange:b=>m(b.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"e.g., 49.2827"})]}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Longitude"}),o.jsx("input",{type:"number",step:"any",value:w,onChange:b=>N(b.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"e.g., -123.1207"})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:Gv,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save"}),o.jsx("button",{onClick:()=>g(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})})]})]})},sP=({isOpen:t,onClose:e,onAdd:n,existingClients:r,serverName:s})=>{const[i,a]=x.useState(1),[l,c]=x.useState(""),[u,d]=x.useState(""),[h,f]=x.useState("");if(!t)return null;const _=(()=>{const w=[];for(let N=1;N<=10;N++)r.includes(`Client ${N}`)||w.push(N);return w})(),v=_.includes(i)?i:_[0]||1,S=()=>{const w=_.indexOf(v);w<_.length-1&&a(_[w+1])},g=()=>{const w=_.indexOf(v);w>0&&a(_[w-1])},p=()=>{const w=parseFloat(u),N=parseFloat(h);l&&!isNaN(w)&&!isNaN(N)?n(v,{lat:w,long:N,name:l}):n(v),e(),c(""),d(""),f("")},m=o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[99999] backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden border border-emerald-100",children:[o.jsx("div",{className:"bg-gradient-to-r from-emerald-700 via-teal-600 to-emerald-700 px-4 py-3 text-white",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-base font-semibold",children:"Add New Client"}),o.jsxs("p",{className:"text-emerald-100 text-xs",children:["Add to ",s]})]}),o.jsx("button",{onClick:e,className:"text-white hover:bg-white/20 rounded-lg p-1.5 transition-colors",children:o.jsx(El,{className:"w-4 h-4"})})]})}),o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Client Number"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50 border border-gray-200 rounded-lg px-4 py-2",children:o.jsxs("span",{className:"font-semibold text-gray-900",children:["Client ",v]})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("button",{onClick:S,disabled:!_.length||_.indexOf(v)>=_.length-1,className:"p-1 text-gray-600 hover:bg-gray-100 rounded disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx(Vh,{className:"w-4 h-4"})}),o.jsx("button",{onClick:g,disabled:!_.length||_.indexOf(v)<=0,className:"p-1 text-gray-600 hover:bg-gray-100 rounded disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx(Yt,{className:"w-4 h-4"})})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Location Name (Optional)"}),o.jsx("input",{type:"text",value:l,onChange:w=>c(w.target.value),placeholder:"e.g., Branch Office",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Latitude (Optional)"}),o.jsx("input",{type:"number",step:"any",value:u,onChange:w=>d(w.target.value),placeholder:"e.g., 49.2827",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Longitude (Optional)"}),o.jsx("input",{type:"number",step:"any",value:h,onChange:w=>f(w.target.value),placeholder:"e.g., -123.1207",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:o.jsx("p",{className:"text-xs text-blue-800",children:" You can edit location later using the edit button next to the location display"})}),o.jsxs("div",{className:"flex gap-2 pt-2",children:[o.jsx("button",{onClick:e,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium text-gray-700",children:"Cancel"}),o.jsx("button",{onClick:p,className:"flex-1 px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm font-medium shadow-sm",children:"Add Client"})]})]})]})});return Ly.createPortal(m,document.body)},Mv=({isOpen:t,onClose:e,onConfirm:n,title:r,message:s,itemName:i,type:a})=>{if(!t)return null;const l=()=>{n(),e()};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999]",children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm mx-4 overflow-hidden",children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:o.jsx(Va,{className:"w-5 h-5 text-orange-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r}),o.jsx("p",{className:"text-sm text-gray-600",children:s})]})]}),o.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:o.jsx("p",{className:"text-sm font-medium text-gray-800",children:i})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:e,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors text-sm font-medium",children:"Cancel"}),o.jsx("button",{onClick:l,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",children:"Delete"})]})]})})})},iP=({serverId:t,serverName:e,onRemove:n})=>{const[r,s]=x.useState(!1),[i,a]=x.useState(!1),[l,c]=x.useState(!1),[u,d]=x.useState(!1),[h,f]=x.useState(""),[y,_]=x.useState(""),[v,S]=x.useState(""),[g,p]=x.useState({isOpen:!1,clientName:"",clientId:""}),[m,w]=x.useState({}),[N,C]=x.useState({}),[k,T]=x.useState({}),[R,I]=x.useState([]),[G,re]=x.useState(""),ne=N.type!=="idle",ge=m.server_location_name&&m.server_location_name!=="Not set"?m.server_location_name:"Location not set",K=m.server_lat&&m.server_long&&m.server_lat!==0&&m.server_long!==0;x.useEffect(()=>Tv(t,U=>{w(U)}),[t]),x.useEffect(()=>{if(m.location_updated===!0){re(`Server location updated: ${m.server_location_name}`);const O=setTimeout(async()=>{re("");try{const{getDatabase:U,ref:$,update:Ne}=await is(async()=>{const{getDatabase:Xe,ref:xt,update:je}=await Promise.resolve().then(()=>Ga);return{getDatabase:Xe,ref:xt,update:je}},[]),Oe=U(),pe=$(Oe,`servers/${t}/mode`);await Ne(pe,{type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:new Date().toISOString()}),C({type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:new Date().toISOString()});const Ie=$(Oe,`servers/${t}/active_status`);await Ne(Ie,{status:"idle",progress:0,total_files:0,received_files:0,total_size_bytes:0,transferred_bytes:0});const Se=$(Oe,`servers/${t}/server_info`);await Ne(Se,{location_updated:!1})}catch(U){console.error("Failed to reset after server location update:",U)}},5e3);return()=>clearTimeout(O)}},[m.location_updated,t,m.server_location_name]),x.useEffect(()=>Bf(t,U=>{C(U)}),[t]),x.useEffect(()=>Xl(t,U=>{T(U)}),[t]),x.useEffect(()=>Rv(t,U=>{const $=Object.keys(U||{});I($)}),[t]),x.useEffect(()=>{const O=U=>{l&&c(!1)};return l&&document.addEventListener("click",O),()=>{document.removeEventListener("click",O)}},[l]);const Le=async()=>{try{const O=new Date().toISOString();C({type:"server_location",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:O}),await bv(t)}catch(O){console.error("Failed to send server location command:",O),C({type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:new Date().toISOString()})}},Q=async()=>{if(window.confirm(`Are you sure you want to reset ${e}? This will reset all keys under this server.`))try{C({type:"idle",target_client_id:"",duration_sec:0,schedule_key:"",updated_at:new Date().toISOString()}),c(!1),await xv(t),console.log("Server reset successfully")}catch(O){console.error("Failed to reset server:",O)}},E=()=>{var O,U;f(((O=m.server_lat)==null?void 0:O.toString())||"0"),_(((U=m.server_long)==null?void 0:U.toString())||"0"),S(m.server_location_name||"Not set"),d(!0)},H=async()=>{try{const O=parseFloat(h),U=parseFloat(y);if(isNaN(O)||isNaN(U)){alert("Please enter valid latitude and longitude");return}const{getDatabase:$,ref:Ne,update:Oe}=await is(async()=>{const{getDatabase:Se,ref:Xe,update:xt}=await Promise.resolve().then(()=>Ga);return{getDatabase:Se,ref:Xe,update:xt}},void 0),pe=$(),Ie=Ne(pe,`servers/${t}/server_info`);await Oe(Ie,{server_lat:O,server_long:U,server_location_name:v||"Not set",location_updated:!0}),d(!1),console.log("Location updated successfully")}catch(O){console.error("Failed to update location:",O),alert("Failed to update location")}},M=async(O,U)=>{const $=`client${O}`;try{if(await vv(t,$),U){const{getDatabase:Ne,ref:Oe,update:pe}=await is(async()=>{const{getDatabase:Xe,ref:xt,update:je}=await Promise.resolve().then(()=>Ga);return{getDatabase:Xe,ref:xt,update:je}},void 0),Ie=Ne(),Se=Oe(Ie,`servers/${t}/clients/${$}/client_info`);await pe(Se,{lat:U.lat,long:U.long,location_name:U.name})}console.log("Client added successfully")}catch(Ne){console.error("Error adding client:",Ne)}a(!1)},fe=O=>{const U=O.replace(/^\w/,$=>$.toUpperCase()).replace(/(\d+)/," $1");p({isOpen:!0,clientName:U,clientId:O})},D=()=>{wv(t,g.clientId).then(()=>{console.log("Client removed successfully")}).catch(O=>console.error("Error removing client:",O)),p({isOpen:!1,clientName:"",clientId:""})};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`bg-white rounded-xl border overflow-hidden shadow-sm transition-all duration-300 ${ne?"border-amber-500 ring-2 ring-amber-200":"border-gray-200"}`,children:[o.jsx("div",{className:"bg-gradient-to-r from-slate-700 via-slate-600 to-slate-700 px-4 py-4 text-white cursor-pointer hover:from-slate-800 hover:via-slate-700 hover:to-slate-800 transition-all",onClick:()=>s(!r),children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[r?o.jsx(Yt,{className:"w-4 h-4"}):o.jsx(dr,{className:"w-4 h-4"}),o.jsx("div",{className:"p-1.5 bg-slate-500/30 rounded-lg",children:o.jsx(Nd,{className:"w-5 h-5"})})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"font-bold text-base",children:e}),o.jsxs("div",{className:"flex items-center gap-2 text-slate-200 text-xs",children:[K?o.jsx("a",{href:`https://www.google.com/maps?q=${m.server_lat},${m.server_long}`,target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-white",onClick:O=>O.stopPropagation(),children:ge}):o.jsx("span",{children:ge}),o.jsx("button",{onClick:O=>{O.stopPropagation(),E()},className:"ml-1 p-0.5 hover:bg-slate-500/30 rounded transition-colors",title:"Edit location",children:o.jsx(rx,{className:"w-3 h-3"})})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:O=>{O.stopPropagation(),Le()},disabled:ne,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${ne?"bg-slate-500/30 text-slate-300 cursor-not-allowed":"bg-teal-500/20 text-teal-100 hover:bg-teal-500/30 border border-teal-400/30"}`,children:[o.jsx(qh,{className:"w-4 h-4"}),"Server Location"]}),(ne||G||R.some(O=>{try{return localStorage.getItem(`recordingClient:${t}`)===O}catch{return!1}}))&&o.jsxs("span",{className:"px-3 py-1.5 bg-amber-500/30 text-amber-100 rounded-lg text-xs font-medium border border-amber-400/30",children:[G?"Location updated":N.type==="server_location"&&"Getting Location...",N.type==="client_location"&&`Location: ${N.target_client_id||""}`,N.type==="connect"&&`Connecting: ${N.target_client_id||""}`,N.type==="instant"&&`Instant: ${N.target_client_id||""}`,N.type==="schedule"&&`Schedule: ${N.target_client_id||""}`,(()=>{for(const O of R)try{if(localStorage.getItem(`recordingClient:${t}`)===O)return`Schedule_Rec: ${O}`}catch{}return""})(),N.type==="transmit_scheduled"&&`Schedule_TX: ${N.target_client_id||""}`]}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:O=>{O.stopPropagation(),c(!l)},className:"w-8 h-8 rounded-md border border-slate-400/30 flex items-center justify-center transition-colors hover:bg-slate-500/30 text-slate-200 hover:text-white",title:"Server options",children:o.jsx(tx,{className:"w-4 h-4"})}),l&&o.jsx("div",{className:"absolute right-0 top-full mt-1 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50 min-w-[150px]",onClick:O=>O.stopPropagation(),children:o.jsx("button",{onClick:O=>{O.stopPropagation(),Q()},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Reset Server"})})]}),o.jsx("button",{onClick:O=>{O.stopPropagation(),n()},disabled:ne,className:`w-8 h-8 rounded-md border flex items-center justify-center transition-colors ${ne?"border-slate-400/30 text-slate-400 cursor-not-allowed":"border-slate-400/30 text-slate-200 hover:bg-slate-500/30 hover:text-red-300"}`,children:o.jsx(Gh,{className:"w-4 h-4"})})]})]})}),!1,r&&o.jsxs("div",{className:"p-5 bg-slate-50",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"font-semibold text-gray-800 text-sm",children:["Connected Clients (",R.length,")"]}),o.jsx("button",{onClick:()=>a(!0),disabled:ne,className:`w-8 h-8 rounded-full flex items-center justify-center transition-all ${ne?"bg-gray-300 cursor-not-allowed":"bg-emerald-600 text-white hover:bg-emerald-700"}`,children:o.jsx(Sl,{className:"w-4 h-4"})})]}),o.jsx("div",{className:"grid gap-3",children:R.map(O=>{const U=O.replace(/^\w/,$=>$.toUpperCase()).replace(/(\d+)/," $1");return o.jsx(rP,{serverId:t,serverName:e,clientId:O,clientName:U,isServerBusy:ne,currentTargetClient:N.target_client_id||"",onOptimisticModeChange:$=>{C({type:$.type,target_client_id:$.target_client_id,duration_sec:$.duration_sec??0,schedule_key:$.schedule_key??"",updated_at:$.updated_at})},onRemove:()=>fe(O)},O)})})]})]}),o.jsx(sP,{isOpen:i,onClose:()=>a(!1),onAdd:M,existingClients:R.map(O=>O.replace(/^\w/,U=>U.toUpperCase()).replace(/(\d+)/," $1")),serverName:e}),o.jsx(Mv,{isOpen:g.isOpen,onClose:()=>p({isOpen:!1,clientName:"",clientId:""}),onConfirm:D,title:"Delete Client?",message:"Are you sure you want to delete this client?",itemName:g.clientName,type:"client"}),u&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[o.jsx("h3",{className:"text-lg font-bold mb-4",children:"Edit Server Location"}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Location Name"}),o.jsx("input",{type:"text",value:v,onChange:O=>S(O.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"e.g., Main Office"})]}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Latitude"}),o.jsx("input",{type:"number",step:"any",value:h,onChange:O=>f(O.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"e.g., 49.2827"})]}),o.jsxs("label",{className:"block mb-4",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Longitude"}),o.jsx("input",{type:"number",step:"any",value:y,onChange:O=>_(O.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"e.g., -123.1207"})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:H,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save"}),o.jsx("button",{onClick:()=>d(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})})]})},oP=({isOpen:t,onClose:e,onAdd:n,existingServers:r})=>{const[s,i]=x.useState(1),[a,l]=x.useState(""),[c,u]=x.useState(""),[d,h]=x.useState("");if(!t)return null;const y=(()=>{const p=[];for(let m=1;m<=10;m++)r.includes(`Server ${m}`)||p.push(m);return p})(),_=y.includes(s)?s:y[0]||1,v=()=>{const p=y.indexOf(_);p<y.length-1&&i(y[p+1])},S=()=>{const p=y.indexOf(_);p>0&&i(y[p-1])},g=()=>{const p=parseFloat(c),m=parseFloat(d);a&&!isNaN(p)&&!isNaN(m)?n(_,{lat:p,long:m,name:a}):n(_),e(),l(""),u(""),h("")};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[9999] backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden border border-emerald-100",children:[o.jsx("div",{className:"bg-gradient-to-r from-emerald-700 via-teal-600 to-emerald-700 px-4 py-3 text-white",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-base font-semibold",children:"Add New Server"}),o.jsx("p",{className:"text-emerald-100 text-xs",children:"Select Server Number"})]}),o.jsx("button",{onClick:e,className:"text-white hover:bg-white/20 rounded-lg p-1.5 transition-colors",children:o.jsx(El,{className:"w-4 h-4"})})]})}),o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Server Number"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50 border border-gray-200 rounded-lg px-4 py-2",children:o.jsxs("span",{className:"font-semibold text-gray-900",children:["Server ",_]})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("button",{onClick:v,disabled:!y.length||y.indexOf(_)>=y.length-1,className:"p-1 text-gray-600 hover:bg-gray-100 rounded disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx(Vh,{className:"w-4 h-4"})}),o.jsx("button",{onClick:S,disabled:!y.length||y.indexOf(_)<=0,className:"p-1 text-gray-600 hover:bg-gray-100 rounded disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx(Yt,{className:"w-4 h-4"})})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Location Name (Optional)"}),o.jsx("input",{type:"text",value:a,onChange:p=>l(p.target.value),placeholder:"e.g., Main Office",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Latitude (Optional)"}),o.jsx("input",{type:"number",step:"any",value:c,onChange:p=>u(p.target.value),placeholder:"e.g., 49.2827",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Longitude (Optional)"}),o.jsx("input",{type:"number",step:"any",value:d,onChange:p=>h(p.target.value),placeholder:"e.g., -123.1207",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:o.jsx("p",{className:"text-xs text-blue-800",children:" You can edit location later using the edit button next to the location display"})}),o.jsxs("div",{className:"flex gap-2 pt-2",children:[o.jsx("button",{onClick:e,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium text-gray-700",children:"Cancel"}),o.jsx("button",{onClick:g,className:"flex-1 px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm font-medium shadow-sm",children:"Add Server"})]})]})]})})},Fv=x.createContext(void 0),ws=()=>{const t=x.useContext(Fv);if(t===void 0)throw new Error("useMenu must be used within a MenuProvider");return t},aP=({children:t})=>{const[e,n]=x.useState(!1),r=()=>{n(!e)};return o.jsx(Fv.Provider,{value:{isExpanded:e,setIsExpanded:n,toggleMenu:r},children:t})};function lP(){const{isExpanded:t}=ws(),[e,n]=x.useState([]),[r,s]=x.useState(!1),[i,a]=x.useState({isOpen:!1,itemName:"",onConfirm:()=>{}});x.useEffect(()=>{console.log(" Setting up Firebase listener for servers...");const d=_v(h=>{console.log(" Firebase servers update received:",h);const f=Object.keys(h).map((y,_)=>({id:y,name:y.replace(/^\w/,v=>v.toUpperCase()).replace(/(\d+)/," $1")}));console.log("Setting servers from Firebase:",f),n(f)});return()=>{console.log(" Cleaning up Firebase listener for servers"),d()}},[]);const l=async(d,h)=>{const f=`server${d}`;try{if(await gv(f),h){const{getDatabase:y,ref:_,update:v}=await is(async()=>{const{getDatabase:p,ref:m,update:w}=await Promise.resolve().then(()=>Ga);return{getDatabase:p,ref:m,update:w}},void 0),S=y(),g=_(S,`servers/${f}/server_info`);await v(g,{server_lat:h.lat,server_long:h.long,server_location_name:h.name})}console.log("Server created successfully in Firebase:",f)}catch(y){console.error("Error creating server in Firebase:",y)}},c=d=>{const h=e.find(f=>f.id===d);h&&a({isOpen:!0,itemName:h.name,onConfirm:()=>{yv(d).then(()=>{console.log("Server deleted successfully")}).catch(f=>console.error("Error deleting server:",f))}})},u=e.length;return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50/80 to-blue-50/30 relative",children:[o.jsxs("div",{className:`relative bg-gradient-to-r from-emerald-800 via-teal-700 to-emerald-800 shadow-lg overflow-hidden transition-all duration-300 ${t?"ml-64":"ml-16"}`,children:[o.jsxs("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover opacity-85",style:{objectPosition:"center 60%"},children:[o.jsx("source",{src:"/vid1.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-800/30 via-teal-700/30 to-emerald-800/30"}),o.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 py-4",children:[o.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[o.jsx("div",{className:"bg-white/20 p-4 rounded-xl",children:o.jsx(sS,{className:"w-8 h-8 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Wildlife Monitoring System"}),o.jsx("p",{className:"text-emerald-100 text-base",children:"Bat Conservation India Trust"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 pb-4",children:[o.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-5 border border-white/20 transition-all duration-300 hover:bg-white/15 hover:scale-105",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"bg-purple-500/20 p-3 rounded-lg",children:o.jsx(Nd,{className:"w-6 h-6 text-purple-200"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-white",children:u}),o.jsx("div",{className:"text-emerald-100 text-sm",children:"Total Servers"})]})]})}),o.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-5 border border-white/20 transition-all duration-300 hover:bg-white/15 hover:scale-105",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"bg-blue-500/20 p-3 rounded-lg",children:o.jsx(iS,{className:"w-6 h-6 text-blue-200"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-white",children:"-"}),o.jsx("div",{className:"text-emerald-100 text-sm",children:"Total Clients"})]})]})}),o.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-5 border border-white/20 transition-all duration-300 hover:bg-white/15 hover:scale-105",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"bg-green-500/20 p-3 rounded-lg",children:o.jsx(Yb,{className:"w-6 h-6 text-green-200"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-2xl font-bold text-white",children:"Live"}),o.jsx("div",{className:"text-emerald-100 text-sm",children:"System Status"})]})]})})]})]})]}),o.jsxs("div",{className:`max-w-7xl mx-auto px-4 py-6 transition-all duration-300 ${t?"ml-64":"ml-16"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Client - Server Network"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Manage your bat detection Recording Stations"})]}),o.jsxs("button",{onClick:()=>s(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-all shadow-lg hover:shadow-xl text-sm",children:[o.jsx(Sl,{className:"w-5 h-5"}),"Add Server"]})]}),o.jsx("div",{className:"space-y-6",children:e.sort((d,h)=>{const f=parseInt(d.name.replace("Server ","")),y=parseInt(h.name.replace("Server ",""));return f-y}).map(d=>o.jsx(iP,{serverId:d.id,serverName:d.name,onRemove:()=>c(d.id)},d.id))}),e.length===0&&o.jsxs("div",{className:"text-center py-16",children:[o.jsx("div",{className:"bg-gray-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Nd,{className:"w-10 h-10 text-gray-400"})}),o.jsx("h3",{className:"text-base font-medium text-gray-900 mb-2",children:"No Servers Available"}),o.jsx("p",{className:"text-gray-500 mb-6 text-sm",children:"Add your first monitoring server to get started"}),o.jsx("button",{onClick:()=>s(!0),className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm",children:"Add Server"})]})]}),o.jsx(oP,{isOpen:r,onClose:()=>s(!1),onAdd:l,existingServers:e.map(d=>d.name)}),o.jsx(Mv,{isOpen:i.isOpen,onClose:()=>a(d=>({...d,isOpen:!1})),onConfirm:i.onConfirm,title:"Delete Server?",message:"Are you sure you want to delete this server?",itemName:i.itemName,type:"server"})]})}const Vn=()=>{const{isExpanded:t,toggleMenu:e}=ws(),n=Br(),[r,s]=x.useState(!1),[i,a]=x.useState(!1),[l,c]=x.useState({type:"new_species",threshold:"",clientId:"all",emailNotification:!0,message:""}),[u,d]=x.useState({downloadType:"preset",dataSource:"all_servers",clientId:"all",dateRange:"30_days",startDate:"",endDate:"",includeEnvironmental:!0,includeAudio:!1}),[h,f]=x.useState([{id:1,type:"New Species Detected",message:"Rhinolophus detected at Forest Station Alpha",time:"2 hours ago",status:"active"},{id:2,type:"Client Down",message:"Wetland Monitor Beta offline",time:"5 hours ago",status:"critical"},{id:3,type:"High Call Activity",message:"150+ calls in last hour at Cave Detection Gamma",time:"1 day ago",status:"info"}]),y=()=>{const m={id:Date.now(),type:l.type.replace("_"," ").replace(/\b\w/g,w=>w.toUpperCase()),message:l.message||`Alert for ${l.type}`,time:"Just now",status:"active"};f([m,...h]),c({type:"new_species",threshold:"",clientId:"all",emailNotification:!0,message:""})},_=()=>{const m={type:u.downloadType,source:u.dataSource,client:u.clientId,dateRange:u.dateRange,startDate:u.startDate,endDate:u.endDate,environmental:u.includeEnvironmental,audio:u.includeAudio};console.log("Download request:",m),a(!1)},v=m=>{f(h.filter(w=>w.id!==m))},S=m=>{switch(m){case"critical":return o.jsx(Es,{className:"w-4 h-4 text-red-500"});case"info":return o.jsx(Zb,{className:"w-4 h-4 text-blue-500"});default:return o.jsx(Yr,{className:"w-4 h-4 text-green-500"})}},g=()=>o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Va,{className:"w-6 h-6 text-orange-600"}),o.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Alert Management"})]}),o.jsx("button",{onClick:()=>s(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(El,{className:"w-5 h-5 text-gray-600"})})]}),o.jsxs("div",{className:"flex flex-col lg:flex-row max-h-[calc(90vh-80px)]",children:[o.jsxs("div",{className:"lg:w-1/2 p-6 border-r border-gray-200",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center space-x-2",children:[o.jsx(Sl,{className:"w-5 h-5 text-green-600"}),o.jsx("span",{children:"Create New Alert"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alert Type"}),o.jsxs("select",{value:l.type,onChange:m=>c({...l,type:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[o.jsx("option",{value:"new_species",children:"New Species Detected"}),o.jsx("option",{value:"call_threshold",children:"Call Count Threshold"}),o.jsx("option",{value:"client_down",children:"Client/Server Down"}),o.jsx("option",{value:"frequency_anomaly",children:"Frequency Anomaly"}),o.jsx("option",{value:"environmental_change",children:"Environmental Change"}),o.jsx("option",{value:"low_activity",children:"Low Activity Alert"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Threshold/Parameters"}),o.jsx("input",{type:"text",value:l.threshold,onChange:m=>c({...l,threshold:m.target.value}),placeholder:"e.g., >100 calls/hour, <20kHz frequency",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Client"}),o.jsxs("select",{value:l.clientId,onChange:m=>c({...l,clientId:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[o.jsx("option",{value:"all",children:"All Clients"}),o.jsx("option",{value:"1",children:"Client-1"}),o.jsx("option",{value:"2",children:"Client-2"}),o.jsx("option",{value:"3",children:"Client-3"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Message"}),o.jsx("textarea",{value:l.message,onChange:m=>c({...l,message:m.target.value}),placeholder:"Custom alert message (optional)",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",id:"emailNotification",checked:l.emailNotification,onChange:m=>c({...l,emailNotification:m.target.checked}),className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),o.jsxs("label",{htmlFor:"emailNotification",className:"text-sm text-gray-700 flex items-center space-x-2",children:[o.jsx(tS,{className:"w-4 h-4"}),o.jsx("span",{children:"Send email notifications"})]})]}),o.jsxs("button",{onClick:y,className:"w-full bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors duration-300 flex items-center justify-center space-x-2",children:[o.jsx(Sl,{className:"w-4 h-4"}),o.jsx("span",{children:"Create Alert"})]})]})]}),o.jsxs("div",{className:"lg:w-1/2 p-6 overflow-y-auto",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center space-x-2",children:[o.jsx(dm,{className:"w-5 h-5 text-red-600"}),o.jsxs("span",{children:["Active Alerts (",h.length,")"]})]}),o.jsxs("div",{className:"space-y-3",children:[h.map(m=>o.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-start space-x-3",children:[S(m.status),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-gray-800",children:m.type}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:m.message}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:m.time})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:o.jsx(Jb,{className:"w-4 h-4 text-gray-600"})}),o.jsx("button",{onClick:()=>v(m.id),className:"p-1 hover:bg-red-50 rounded transition-colors",children:o.jsx(Gh,{className:"w-4 h-4 text-red-500"})})]})]})},m.id)),h.length===0&&o.jsxs("div",{className:"text-center py-8",children:[o.jsx(dm,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-500",children:"No active alerts"})]})]})]})]})]})}),p=()=>o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Gi,{className:"w-6 h-6 text-blue-600"}),o.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Download Data"})]}),o.jsx("button",{onClick:()=>a(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(El,{className:"w-5 h-5 text-gray-600"})})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Download Type"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"radio",name:"downloadType",value:"preset",checked:u.downloadType==="preset",onChange:m=>d({...u,downloadType:m.target.value}),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),o.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Quick Download (Preset Options)"})]}),o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"radio",name:"downloadType",value:"custom",checked:u.downloadType==="custom",onChange:m=>d({...u,downloadType:m.target.value}),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),o.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Custom Download (Advanced Options)"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Source"}),o.jsxs("select",{value:u.dataSource,onChange:m=>d({...u,dataSource:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"all_servers",children:"All Servers"}),o.jsx("option",{value:"single_server",children:"Single Server"}),o.jsx("option",{value:"single_client",children:"Single Client"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Client"}),o.jsxs("select",{value:u.clientId,onChange:m=>d({...u,clientId:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"all",children:"All Clients"}),o.jsx("option",{value:"1",children:"Client-1"}),o.jsx("option",{value:"2",children:"Client-2"}),o.jsx("option",{value:"3",children:"Client-3"})]})]}),u.downloadType==="custom"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),o.jsxs("select",{value:u.dateRange,onChange:m=>d({...u,dateRange:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"7_days",children:"Last 7 Days"}),o.jsx("option",{value:"30_days",children:"Last 30 Days"}),o.jsx("option",{value:"90_days",children:"Last 90 Days"}),o.jsx("option",{value:"custom",children:"Custom Range"})]})]}),u.dateRange==="custom"&&o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Date"}),o.jsx("input",{type:"date",value:u.startDate,onChange:m=>d({...u,startDate:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Date"}),o.jsx("input",{type:"date",value:u.endDate,onChange:m=>d({...u,endDate:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Include Parameters"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:u.includeEnvironmental,onChange:m=>d({...u,includeEnvironmental:m.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),o.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Environmental Data"})]}),o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:u.includeAudio,onChange:m=>d({...u,includeAudio:m.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),o.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Audio Files"})]})]})]})]}),o.jsxs("button",{onClick:_,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors duration-300 flex items-center justify-center space-x-2",children:[o.jsx(Gi,{className:"w-4 h-4"}),o.jsx("span",{children:"Download Data"})]})]})]})});return o.jsxs(o.Fragment,{children:[!t&&o.jsxs("aside",{className:"fixed top-0 left-0 h-full w-16 bg-white shadow-2xl z-40 border-r border-gray-200 flex flex-col",children:[o.jsx("div",{className:"flex items-center justify-center p-4 border-b border-gray-200 h-16",children:o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(dr,{className:"w-5 h-5 text-gray-600"})})}),o.jsxs("nav",{className:"p-2 space-y-2",children:[o.jsx("button",{onClick:()=>n("/"),className:"flex justify-center p-2 hover:bg-gray-100 rounded transition-colors w-full",title:"Home",children:o.jsx(fm,{className:"w-5 h-5 text-gray-600"})}),o.jsx("button",{onClick:()=>s(!0),className:"flex justify-center p-2 hover:bg-gray-100 rounded transition-colors w-full",children:o.jsx(Va,{className:"w-5 h-5 text-orange-600"})}),o.jsx("button",{onClick:()=>a(!0),className:"flex justify-center p-2 hover:bg-gray-100 rounded transition-colors w-full",children:o.jsx(Gi,{className:"w-5 h-5 text-blue-600"})})]})]}),t&&o.jsxs("aside",{className:"fixed top-0 left-0 h-full w-64 bg-white shadow-2xl z-40 border-r border-gray-200 flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 h-16",children:[o.jsx("h2",{className:"text-lg font-semibold",children:"Menu"}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o.jsx(vd,{className:"w-5 h-5 text-gray-600"})})]}),o.jsxs("nav",{className:"p-4 space-y-2",children:[o.jsxs("button",{onClick:()=>n("/"),className:"flex items-center space-x-3 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors duration-300 w-full text-left",children:[o.jsx(fm,{className:"w-5 h-5 text-gray-600"}),o.jsx("span",{children:"Home"})]}),o.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-3 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors duration-300 w-full text-left",children:[o.jsx(Va,{className:"w-5 h-5 text-orange-600"}),o.jsx("span",{children:"Alerts"}),o.jsx("div",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:h.length})]}),o.jsxs("button",{onClick:()=>a(!0),className:"flex items-center space-x-3 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors duration-300 w-full text-left",children:[o.jsx(Gi,{className:"w-5 h-5 text-blue-600"}),o.jsx("span",{children:"Downloads"})]})]})]}),r&&o.jsx(g,{}),i&&o.jsx(p,{})]})},oa="https://bat-admin-backend.onrender.com/api";console.log(" API Configuration:",{API_BASE_URL:oa,VITE_API_URL:"https://bat-admin-backend.onrender.com/api",NODE_ENV:"production"});const cP=async(t,e,n)=>{try{const r=await fetch(`${oa}/bat/${t}/files?server=${e}&client=${n}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){return console.error("Error fetching bat files:",r),{success:!1,message:r instanceof Error?r.message:"Unknown error occurred"}}},Ta=(t,e)=>`${oa}/file/${t}?name=${encodeURIComponent(e)}`,uP=async(t,e,n)=>{try{const r=t.replace(/^BAT/i,""),s=`${oa}/predict/${r}?server=${e}&client=${n}`;console.log(" Calling predict endpoint:",s);const i=await fetch(s);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const a=await i.json();return console.log(" Prediction response:",a),a}catch(r){return console.error("Error predicting species:",r),{success:!1,message:r instanceof Error?r.message:"Unknown error occurred"}}},Pa=t=>{const e=`${oa}/species-image/${encodeURIComponent(t)}`;return console.log(" Species image URL:",e),e},dP=()=>{var Oe;console.log(" BatDetailsPage COMPONENT MOUNTED/RENDERED");const{batId:t,serverNum:e,clientNum:n}=qy(),r=Br(),s=nn(),{isExpanded:i}=ws();console.log("BatDetailsPage mounted with params:",{batId:t,serverNum:e,clientNum:n,pathname:s.pathname});const a=s.state,[l,c]=x.useState(!0),[u,d]=x.useState(null),[h,f]=x.useState(!1),[y,_]=x.useState(null),[v,S]=x.useState(null),[g,p]=x.useState(0),[m,w]=x.useState(null),[N,C]=x.useState(!1),[k,T]=x.useState(null),[R,I]=x.useState(null),[G,re]=x.useState(null),[ne,ge]=x.useState(null),[K,Le]=x.useState(null),[Q,E]=x.useState([]),[H,M]=x.useState(100),[fe,D]=x.useState(100),[jt,O]=x.useState(100),[U,$]=x.useState(null);x.useEffect(()=>{console.log("BatDetailsPage useEffect running on mount"),(async()=>{var Xe,xt,je,le;console.log("BatDetailsPage: Starting loadBatFiles"),console.log("batId:",t),console.log("serverNum:",e),console.log("clientNum:",n),console.log("Current location:",s.pathname),c(!0),d(null),_(null),I(null),re(null),ge(null);const Ie=e||(a==null?void 0:a.serverNum)||"1",Se=n||(a==null?void 0:a.clientNum)||"1";if(!t){console.log("Missing batId"),c(!1);return}try{c(!0),console.log("Calling fetchBatFiles with:",{batId:t,serverNum:Ie,clientNum:Se});const W=await cP(t,Ie,Se);if(console.log("fetchBatFiles response:",W),!W.success){console.error("fetchBatFiles failed:",W.message),_("Failed to load BAT files: "+(W.message||"Unknown error")),c(!1);return}if((Xe=W.files)!=null&&Xe.spectrogram&&I(Ta(W.files.spectrogram.id,W.files.spectrogram.name)),(xt=W.files)!=null&&xt.camera&&re(Ta(W.files.camera.id,W.files.camera.name)),(je=W.files)!=null&&je.audio&&ge(Ta(W.files.audio.id,W.files.audio.name)),(le=W.files)!=null&&le.sensor){f(!0);try{const L=await(await fetch(Ta(W.files.sensor.id,W.files.sensor.name))).text();console.log("Raw sensor.txt content:",L);const he=L.split(`
`),se={};he.forEach(ce=>{var Re,_t,Me,xe;if(console.log("Parsing line:",ce),ce.includes("Temp:")||ce.includes("temperature:")){const rt=(Re=ce.split(/.*[Tt]emp:/)[1])==null?void 0:Re.trim().replace(/?C|celsius/gi,"").trim();se.temperature=parseFloat(rt||"0"),console.log("Parsed temperature:",se.temperature)}else if(ce.includes("Humidity:")||ce.includes("humidity:")){const rt=(_t=ce.split(/[Hh]umidity:/)[1])==null?void 0:_t.trim().replace(/%/g,"").trim();se.humidity=parseFloat(rt||"0"),console.log("Parsed humidity:",se.humidity)}else if(ce.includes("Pressure:")||ce.includes("pressure:")){const rt=(Me=ce.split(/[Pp]ressure:/)[1])==null?void 0:Me.trim().replace(/hPa|Pa|pascal/gi,"").trim();se.pressure=parseFloat(rt||"0"),console.log("Parsed pressure:",se.pressure)}else if(ce.includes("Light:")||ce.includes("light:")){const rt=(xe=ce.split(/[Ll]ight:/)[1])==null?void 0:xe.trim().replace(/lux|lx/gi,"").trim();se.lightLevel=parseFloat(rt||"0"),console.log("Parsed light level:",se.lightLevel)}}),console.log("Final parsed sensor data:",se),d(se)}catch(q){_("Failed to parse sensor data"),console.error("Sensor parsing error:",q)}finally{f(!1)}}}catch(W){console.error("Error loading BAT files:",W)}finally{console.log("Setting loading to false"),c(!1)}})()},[]),x.useEffect(()=>{if(!t||!e||!n||l)return;(async()=>{const Ie=`bat_prediction_${e}_${n}_${t}`;localStorage.removeItem(Ie),C(!0),T(null);try{const Se=`server${e}`,Xe=`client${n}`,{getPrediction:xt}=await is(async()=>{const{getPrediction:W}=await Promise.resolve().then(()=>wg);return{getPrediction:W}},void 0);console.log(" Checking Firebase for existing prediction...");const je=await xt(Se,Xe,t);if(je&&je.species){console.log(" Found in Firebase:",je.species),S(je.species),p(je.confidence||0),w(Pa(je.species)),C(!1);return}console.log(" Starting species prediction for BAT",t);const le=await uP(t,e,n);if(le.success&&le.species){console.log(" Prediction successful:",le.species,`(${le.confidence}%)`),console.log(" Full prediction result:",le),S(le.species),p(le.confidence||0),le.all_species&&le.all_species.length>0&&(console.log(" Multiple species detected:",le.all_species),E(le.all_species)),le.call_parameters?(console.log(" Call parameters received:",le.call_parameters),Le(le.call_parameters)):console.log(" No call parameters in response"),le.metadata?(console.log(" Metadata received:",le.metadata),$(le.metadata)):console.log(" No metadata in response");const W=Pa(le.species);w(W),console.log(" Species image URL set:",W);const{savePrediction:q}=await is(async()=>{const{savePrediction:se}=await Promise.resolve().then(()=>wg);return{savePrediction:se}},void 0);await q(Se,Xe,t,le.species,le.confidence||0,"15/08/2024","45 kHz",le.all_species)}else console.warn(" Prediction failed:",le.message),T(le.message||"Failed to predict species"),S("Unknown species"),w(Pa("Unknown_species"))}catch(Se){console.error(" Error during prediction:",Se),T(Se instanceof Error?Se.message:"Prediction error occurred"),S("Unknown species"),w(Pa("Unknown_species"))}finally{C(!1)}})()},[t,e,n,l]),console.log("BatDetailsPage - Rendering with:",{batId:t,loading:l,navigationState:a,isExpanded:i,sensorData:u,spectrogramUrl:R,cameraUrl:G,predictedSpecies:v,speciesImageUrl:m});const Ne={id:t?`BAT${t}`:"BAT001",species:v||"Pipistrellus pipistrellus",location:"Kolar",date:"15/08/2024"};return l?o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50/80 to-blue-50/30 relative",children:[o.jsx(Vn,{}),o.jsx("div",{className:`bg-gradient-to-r from-emerald-700 via-teal-600 to-emerald-700 shadow-lg transition-all duration-300 ${i?"ml-64":"ml-16"}`,children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 h-16 flex items-center",children:[o.jsx("button",{onClick:()=>r(-1),className:"p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors mr-4",children:o.jsx(ii,{className:"w-6 h-6 text-white"})}),o.jsxs("h1",{className:"text-lg font-semibold text-white",children:["BAT ID: ",Ne.id]})]})}),o.jsx("div",{className:`max-w-7xl mx-auto px-4 py-8 transition-all duration-300 ${i?"ml-64":"ml-16"}`,children:o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Ye,{className:"w-8 h-8 animate-spin text-emerald-500"}),o.jsx("span",{className:"text-lg text-gray-600",children:"Loading BAT data..."})]})})})]}):o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50/80 to-blue-50/30 relative",children:[o.jsx(Vn,{}),o.jsx("div",{className:`bg-gradient-to-r from-emerald-700 via-teal-600 to-emerald-700 shadow-lg transition-all duration-300 ${i?"ml-64":"ml-16"}`,children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 h-16 flex items-center",children:[o.jsx("button",{onClick:()=>r(-1),className:"p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors mr-4",children:o.jsx(ii,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-lg font-semibold text-white",children:["BAT ID: ",Ne.id]}),a&&o.jsxs("p",{className:"text-sm text-emerald-100",children:[a.serverName,"  ",a.clientName]})]})]})}),o.jsxs("div",{className:`max-w-7xl mx-auto px-4 py-8 transition-all duration-300 ${i?"ml-64":"ml-16"}`,children:[o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 min-h-64 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 hover:scale-[1.02]",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-base font-semibold text-emerald-600",children:"Basic Information"}),N&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ye,{className:"w-4 h-4 animate-spin text-emerald-500"}),o.jsx("span",{className:"text-xs text-emerald-600",children:"Predicting..."})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Species:"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-gray-900 font-medium",children:v||"Loading..."}),v&&g>0&&o.jsxs("span",{className:"text-xs bg-emerald-100 text-emerald-700 px-2 py-1 rounded",children:[g.toFixed(1),"%"]})]})]}),k&&o.jsxs("div",{className:"flex items-start gap-2 text-xs text-orange-600 bg-orange-50 p-2 rounded",children:[o.jsx(Es,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),o.jsx("span",{children:k})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Scientific Name:"}),o.jsx("span",{className:"text-sm text-gray-900 italic",children:v||"Unknown"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"BAT ID:"}),o.jsx("span",{className:"text-sm text-blue-600 font-mono",children:Ne.id})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Location:"}),o.jsx("span",{className:"text-sm text-gray-900",children:U!=null&&U.latitude&&(U!=null&&U.longitude)?`${U.latitude}, ${U.longitude}`:Ne.location})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Date:"}),o.jsx("span",{className:"text-sm text-gray-900",children:(U==null?void 0:U.timestamp)||Ne.date})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Frequency:"}),o.jsx("span",{className:"text-sm text-gray-900",children:K!=null&&K.peak_frequency?`${K.peak_frequency} kHz`:"N/A"})]}),K&&Object.keys(K).length>0?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"border-t pt-2 mt-2",children:o.jsx("h4",{className:"text-xs font-semibold text-emerald-600 mb-2",children:"Call Parameters"})}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Start Frequency:"}),o.jsxs("span",{className:"text-xs text-gray-900",children:[K.start_frequency," kHz"]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"End Frequency:"}),o.jsxs("span",{className:"text-xs text-gray-900",children:[K.end_frequency," kHz"]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Peak Frequency:"}),o.jsxs("span",{className:"text-xs text-gray-900",children:[K.peak_frequency," kHz"]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Bandwidth:"}),o.jsxs("span",{className:"text-xs text-gray-900",children:[K.bandwidth," kHz"]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Call Duration:"}),o.jsxs("span",{className:"text-xs text-gray-900",children:[K.pulse_duration," ms"]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Pulse Count:"}),o.jsx("span",{className:"text-xs text-gray-900",children:K.pulse_count})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Sonotype:"}),o.jsx("span",{className:"text-xs text-gray-900 uppercase",children:K.shape})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Intensity:"}),o.jsxs("span",{className:"text-xs text-gray-900",children:[((Oe=K.intensity)==null?void 0:Oe.toFixed(1))||0," dB"]})]})]}):o.jsx("div",{className:"border-t pt-2 mt-2",children:o.jsx("p",{className:"text-xs text-gray-500 italic",children:"Call parameters not available"})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 min-h-96 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 hover:scale-[1.02]",children:[o.jsx("h3",{className:"text-base font-semibold mb-3 text-emerald-600",children:"Species Photo"}),o.jsxs("div",{className:"h-80 bg-gray-100 rounded-lg flex flex-col items-center justify-center overflow-hidden",children:[m?o.jsx("img",{src:m,alt:v||"Species",className:"w-full h-full object-contain rounded-lg",onError:pe=>{pe.target.style.display="none";const Ie=pe.target.nextElementSibling;Ie&&Ie.classList.remove("hidden")}}):o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx(Ye,{className:"w-8 h-8 animate-spin text-emerald-500 mb-2"}),o.jsx("span",{className:"text-sm text-gray-600",children:"Loading species image..."})]}),o.jsxs("div",{className:"hidden flex-col items-center",children:[o.jsx("span",{className:"text-4xl mb-1",children:""}),o.jsx("p",{className:"text-sm text-center text-gray-600",children:v||"Unknown species"}),o.jsx("p",{className:"text-xs text-center text-gray-500 mt-1",children:"Species photo not available"})]})]})]})]}),Q&&Q.length>0&&o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-lg hover:border-emerald-300 transition-all duration-300",children:[o.jsxs("h3",{className:"text-base font-semibold mb-3 text-emerald-600",children:["Detected Species (",Q.length,")"]}),o.jsx("div",{className:"space-y-4",children:Q.map((pe,Ie)=>{var Se;return o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-emerald-300 transition-colors",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"flex items-center justify-center w-8 h-8 bg-emerald-100 text-emerald-700 rounded-full text-sm font-bold",children:Ie+1}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:pe.species}),o.jsxs("p",{className:"text-xs text-gray-500",children:["Rank ",pe.rank]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("span",{className:"text-lg font-bold text-emerald-600",children:[pe.confidence.toFixed(1),"%"]}),o.jsx("p",{className:"text-xs text-gray-500",children:"Confidence"})]})]}),K&&Ie===0&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[o.jsx("h5",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Call Parameters"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Start Freq:"}),o.jsxs("span",{className:"ml-1 font-medium",children:[K.start_frequency," kHz"]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"End Freq:"}),o.jsxs("span",{className:"ml-1 font-medium",children:[K.end_frequency," kHz"]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Peak Freq:"}),o.jsxs("span",{className:"ml-1 font-medium",children:[K.peak_frequency," kHz"]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Bandwidth:"}),o.jsxs("span",{className:"ml-1 font-medium",children:[K.bandwidth," kHz"]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Duration:"}),o.jsxs("span",{className:"ml-1 font-medium",children:[K.pulse_duration," ms"]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Pulses:"}),o.jsx("span",{className:"ml-1 font-medium",children:K.pulse_count})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Sonotype:"}),o.jsx("span",{className:"ml-1 font-medium uppercase",children:K.shape})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-600",children:"Intensity:"}),o.jsxs("span",{className:"ml-1 font-medium",children:[((Se=K.intensity)==null?void 0:Se.toFixed(1))||0," dB"]})]})]})]})]},Ie)})})]})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 hover:scale-[1.02] flex flex-col h-[480px]",children:[o.jsx("h3",{className:"text-base font-semibold mb-3 text-emerald-600",children:"Camera Image"}),o.jsxs("div",{className:"flex-1 bg-gray-100 rounded-lg flex flex-col items-center justify-center overflow-hidden",children:[G?o.jsx("img",{src:G,alt:"Camera Image",className:"w-full h-full object-contain rounded-lg",onError:pe=>{pe.target.style.display="none",pe.target.nextElementSibling.classList.remove("hidden")}}):o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("span",{className:"text-4xl mb-1",children:""}),o.jsx("p",{className:"text-sm text-center text-gray-600",children:"No camera image available"})]}),o.jsxs("div",{className:"hidden flex-col items-center",children:[o.jsx("span",{className:"text-4xl mb-1",children:""}),o.jsx("p",{className:"text-sm text-center text-gray-600",children:"Failed to load camera image"})]})]})]}),o.jsxs("div",{className:"flex flex-col gap-3 h-[480px]",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 flex-1 flex flex-col min-h-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"text-sm font-semibold text-emerald-600",children:"Spectrogram"}),o.jsx("div",{className:"flex items-center gap-1",children:o.jsx(rS,{className:"w-3 h-3 text-gray-500"})})]}),o.jsxs("div",{className:"flex-1 bg-gray-900 rounded-lg flex items-center justify-center overflow-hidden mb-2 min-h-0",children:[R?o.jsx("img",{src:R,alt:"Spectrogram",className:"w-full h-full object-contain rounded-lg",style:{filter:`brightness(${H}%) contrast(${fe}%) saturate(${jt}%)`,transition:"filter 0.2s ease"},onError:pe=>{pe.target.style.display="none",pe.target.nextElementSibling.classList.remove("hidden")}}):o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("span",{className:"text-3xl mb-1",children:""}),o.jsx("p",{className:"text-xs text-center text-gray-400",children:"Spectrogram not available"})]}),o.jsxs("div",{className:"hidden flex-col items-center",children:[o.jsx("span",{className:"text-3xl mb-1",children:""}),o.jsx("p",{className:"text-xs text-center text-gray-400",children:"Not available"})]})]}),R&&o.jsxs("div",{className:"space-y-1 flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-[10px] text-gray-500 w-12",children:"Bright"}),o.jsx("input",{type:"range",min:"50",max:"200",value:H,onChange:pe=>M(Number(pe.target.value)),className:"flex-1 h-1"}),o.jsxs("span",{className:"text-[10px] text-gray-500 w-6",children:[H,"%"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-[10px] text-gray-500 w-12",children:"Contrast"}),o.jsx("input",{type:"range",min:"50",max:"200",value:fe,onChange:pe=>D(Number(pe.target.value)),className:"flex-1 h-1"}),o.jsxs("span",{className:"text-[10px] text-gray-500 w-6",children:[fe,"%"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-[10px] text-gray-500 w-12",children:"Saturate"}),o.jsx("input",{type:"range",min:"0",max:"200",value:jt,onChange:pe=>O(Number(pe.target.value)),className:"flex-1 h-1"}),o.jsxs("span",{className:"text-[10px] text-gray-500 w-6",children:[jt,"%"]})]}),o.jsx("button",{onClick:()=>{M(100),D(100),O(100)},className:"text-[10px] text-emerald-600 hover:text-emerald-700",children:"Reset"})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 flex-shrink-0 h-[100px]",children:[o.jsx("h3",{className:"text-sm font-semibold mb-2 text-emerald-600",children:"Audio"}),ne?o.jsxs("div",{className:"space-y-2",children:[o.jsx("audio",{controls:!0,className:"w-full h-8",preload:"metadata",children:o.jsx("source",{src:ne,type:"audio/wav"})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("a",{href:ne,download:"audio.wav",className:"flex-1 bg-emerald-600 text-white px-2 py-1.5 rounded text-[10px] font-medium hover:bg-emerald-700 flex items-center justify-center gap-1",children:[o.jsx(oS,{className:"w-3 h-3"})," Download"]}),o.jsxs("div",{className:"text-[10px] text-gray-500 flex items-center gap-2",children:[o.jsx("span",{children:"384kHz"}),o.jsx("span",{children:"WAV"})]})]})]}):o.jsx("div",{className:"flex items-center justify-center h-12",children:o.jsx("p",{className:"text-xs text-gray-500",children:"No audio available"})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 hover:scale-[1.02] flex flex-col h-[480px]",children:[o.jsx("h3",{className:"text-base font-semibold mb-4 text-emerald-600",children:"Environmental Data"}),h?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ye,{className:"w-4 h-4 animate-spin text-emerald-500"}),o.jsx("span",{className:"text-sm text-gray-600",children:"Loading..."})]})}):y?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Es,{className:"w-4 h-4 text-red-500"}),o.jsx("span",{className:"text-sm text-gray-600",children:y})]})}):u?o.jsxs("div",{className:"flex-1 flex flex-col justify-center space-y-4",children:[o.jsx("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 p-3 rounded-lg border border-red-100",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Temperature"})]}),o.jsx("span",{className:"text-lg font-bold text-red-600",children:u.temperature>0?`${u.temperature}C`:"N/A"})]})}),o.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 p-3 rounded-lg border border-blue-100",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Humidity"})]}),o.jsx("span",{className:"text-lg font-bold text-blue-600",children:u.humidity>0?`${u.humidity}%`:"N/A"})]})}),o.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 p-3 rounded-lg border border-purple-100",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Pressure"})]}),o.jsx("span",{className:"text-lg font-bold text-purple-600",children:u.pressure>0?`${u.pressure} hPa`:"N/A"})]})}),o.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 p-3 rounded-lg border border-yellow-100",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Light Level"})]}),o.jsx("span",{className:"text-lg font-bold text-amber-600",children:u.lightLevel>0?`${u.lightLevel} lux`:"N/A"})]})})]}):o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx(Es,{className:"w-8 h-8 text-gray-400 mb-2"}),o.jsx("span",{className:"text-sm text-gray-600",children:"No environmental data available"})]})})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 hover:scale-[1.02]",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-6 text-emerald-600 flex items-center gap-2",children:[o.jsx("span",{className:"text-xl",children:""}),"Guano Metadata"]}),U&&Object.keys(U).length>0?o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"border-l-4 border-blue-400 pl-4",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"GUANO Version"}),o.jsx("span",{className:"text-sm text-gray-900 font-mono font-semibold",children:U.guano_version||U["GUANO|Version"]||"N/A"})]})}),o.jsx("div",{className:"border-l-4 border-green-400 pl-4",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Species"}),o.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:U.species||v||"N/A"})]})}),o.jsx("div",{className:"border-l-4 border-purple-400 pl-4",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Location"}),o.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:U.latitude&&U.longitude?`${U.latitude}, ${U.longitude}`:Ne.location})]})}),o.jsx("div",{className:"border-l-4 border-teal-400 pl-4",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Temperature"}),o.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:U.temperature||u!=null&&u.temperature?`${(u==null?void 0:u.temperature)||U.temperature}C`:"N/A"})]})})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"border-l-4 border-orange-400 pl-4",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Timestamp"}),o.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:U.timestamp||Ne.date})]})}),o.jsx("div",{className:"border-l-4 border-red-400 pl-4",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Filter HP"}),o.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:U.filter_hp||"N/A"})]})}),o.jsx("div",{className:"border-l-4 border-indigo-400 pl-4",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Sample Rate"}),o.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:U.sample_rate||"384kHz"})]})}),o.jsx("div",{className:"border-l-4 border-pink-400 pl-4",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Make/Model"}),o.jsx("span",{className:"text-sm text-gray-900 font-semibold",children:U.make||U.model?`${U.make||""} ${U.model||""}`.trim():"N/A"})]})})]})]}):o.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-500",children:[o.jsx(Es,{className:"w-8 h-8 mb-2 text-gray-400"}),o.jsx("p",{className:"text-sm",children:"No metadata available"}),o.jsx("p",{className:"text-xs mt-1",children:"GUANO metadata not found in audio file"})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 hover:scale-[1.02]",children:[o.jsx("h3",{className:"text-base font-semibold mb-4 text-emerald-600",children:"Spectrogram Analysis"}),K&&Object.keys(K).length>0?o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"relative mb-2",children:[o.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-1",children:o.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-white text-xs font-bold",children:""})})}),o.jsx("div",{className:"text-lg font-bold text-blue-600",children:g>0?`${g.toFixed(0)}%`:"N/A"})]}),o.jsx("div",{className:"text-xs text-gray-600",children:"Species Confidence"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"relative mb-2",children:[o.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-1",children:o.jsx("div",{className:"w-5 h-5 bg-purple-500 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-white text-xs font-bold",children:""})})}),o.jsx("div",{className:"text-lg font-bold text-purple-600",children:K.peak_frequency?`${K.peak_frequency}kHz`:"N/A"})]}),o.jsx("div",{className:"text-xs text-gray-600",children:"Peak Frequency"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"relative mb-2",children:[o.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-1",children:o.jsx("div",{className:"w-5 h-5 bg-orange-500 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-white text-xs font-bold",children:""})})}),o.jsx("div",{className:"text-lg font-bold text-orange-600",children:K.pulse_duration?`${K.pulse_duration}ms`:"N/A"})]}),o.jsx("div",{className:"text-xs text-gray-600",children:"Call Duration"})]})]}):o.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-gray-500",children:[o.jsx(Es,{className:"w-8 h-8 mb-2 text-gray-400"}),o.jsx("p",{className:"text-sm",children:"No call parameters"}),o.jsx("p",{className:"text-xs mt-1",children:"Audio analysis data not available"})]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-end space-y-3 sm:space-y-0 sm:space-x-3",children:[o.jsx("button",{className:"w-full sm:w-auto px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-gray-700 transition-colors",children:"Export Data"}),o.jsx("button",{className:"w-full sm:w-auto px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors",children:"Generate Report"})]})]})]})},hP=()=>{const{folderTimestamp:t,serverNum:e,clientNum:n}=qy(),r=Br(),{isExpanded:s}=ws(),[i,a]=x.useState(!0),[l,c]=x.useState([]),[u,d]=x.useState(null),[h,f]=x.useState(null),[y,_]=x.useState(!1),[v,S]=x.useState(null),[g,p]=x.useState(""),[m,w]=x.useState(""),[N,C]=x.useState({species:!0,metadata:!0,call_params:!0,map:!1}),[k,T]=x.useState(null),R=x.useRef(null),I=x.useRef(null),[G,re]=x.useState(40),[ne,ge]=x.useState(35),[K,Le]=x.useState(25),[Q,E]=x.useState(null),H=x.useRef(null),[M,fe]=x.useState(1),[D,jt]=x.useState(100),[O,U]=x.useState(100),[$,Ne]=x.useState(100),Oe=L=>{C(he=>({...he,[L]:!he[L]}))},pe=x.useCallback(L=>{E(L)},[]),Ie=x.useCallback(L=>{if(!Q||!H.current)return;const he=H.current.getBoundingClientRect(),se=he.width,Re=(L.clientX-he.left)/se*100;if(Q==="left"){const _t=Math.min(Math.max(Re,15),60),Me=100-_t-K-1;Me>=20&&(re(_t),ge(Me))}else if(Q==="right"){const _t=100-Re,Me=Math.min(Math.max(_t,10),40),xe=100-G-Me-1;xe>=20&&(Le(Me),ge(xe))}},[Q,G,K]),Se=x.useCallback(()=>{E(null)},[]);x.useEffect(()=>(Q?(document.addEventListener("mousemove",Ie),document.addEventListener("mouseup",Se),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",Ie),document.removeEventListener("mouseup",Se),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",Ie),document.removeEventListener("mouseup",Se),document.body.style.cursor="",document.body.style.userSelect=""}),[Q,Ie,Se]),x.useEffect(()=>{const he=(async()=>{if(!t||!e||!n){S("Missing required parameters"),a(!1);return}try{a(!0),S(null);const se=`server${e}_client${n}_${t}`;p(se),console.log(" Loading folder data:",{serverNum:e,clientNum:n,folderTimestamp:t}),w("Loading predictions and files...");const{entries:ce,timestamp:Re,serverNum:_t,clientNum:Me}=await Lc({serverId:e,clientId:n,folderName:se});c(ce);const xe=ce.filter(Ke=>Ke.from_cache).length,rt=ce.filter(Ke=>Ke.needs_prediction).length;console.log(` [BatFolderDetailPage] Loaded ${ce.length} files: ${xe} cached, ${rt} need prediction`),ce.length>0&&(d(ce[0]),Xe(ce[0])),a(!1);const $t=ce.map((Ke,Ae)=>({entry:Ke,index:Ae})).filter(({entry:Ke})=>Ke.needs_prediction);if($t.length>0){console.log(` [BatFolderDetailPage] Starting SEQUENTIAL predictions for ${$t.length} files`),I.current=new AbortController;const Ke=I.current.signal;(async()=>{for(const{entry:Ae,index:Fe}of $t){if(Ke.aborted){console.log(" [BatFolderDetailPage] Predictions cancelled");break}try{console.log(` [BatFolderDetailPage] Predicting ${Fe+1}/${$t.length}: ${Ae.file_name}`),c(Tt=>{const Pt=[...Tt],rr=Tt.findIndex(Vr=>Vr.file_id===Ae.file_id);return rr!==-1&&(Pt[rr]={...Pt[rr],processing:!0,predicted_species:"Processing..."}),Pt});const{predictSingleAudio:ft}=await is(async()=>{const{predictSingleAudio:Tt}=await Promise.resolve().then(()=>nP);return{predictSingleAudio:Tt}},void 0),bs=e!=null&&e.toLowerCase().startsWith("server")?e.toLowerCase():`server${e}`,Wr=n!=null&&n.toLowerCase().startsWith("client")?n.toLowerCase():`client${n}`,Ut=await ft({serverId:bs,clientId:Wr,serverNum:_t,clientNum:Me,timestamp:Re,audio:Ae,signal:Ke});c(Tt=>{const Pt=[...Tt],rr=Tt.findIndex(Vr=>Vr.file_id===Ae.file_id);return rr!==-1&&(Pt[rr]=Ut),Pt}),console.log(` [BatFolderDetailPage] Completed ${Fe+1}/${$t.length}: ${Ae.file_name}`)}catch(ft){if(ft instanceof Error&&ft.name==="AbortError"){console.log(` [BatFolderDetailPage] Prediction cancelled for ${Ae.file_name}`);break}console.error(` [BatFolderDetailPage] Prediction error for ${Ae.file_name}:`,ft),c(bs=>{const Wr=[...bs],Ut=bs.findIndex(Tt=>Tt.file_id===Ae.file_id);return Ut!==-1&&(Wr[Ut]={...Wr[Ut],processing:!1,predicted_species:"Error",error:ft instanceof Error?ft.message:"Unknown error"}),Wr})}}console.log(" [BatFolderDetailPage] All predictions completed")})()}console.log(" Setting up Firebase prediction listener...");const Ns=e.toLowerCase().startsWith("server")?e.toLowerCase():`server${e}`,An=n.toLowerCase().startsWith("client")?n.toLowerCase():`client${n}`,ji=ia(Ns,An,Ke=>{if(console.log(" Received Firebase prediction update"),c(Ae=>Ae.map(Fe=>{const ft=Ke[Fe.file_name];return ft&&ft.allSpecies&&ft.allSpecies.length>0?{...Fe,species:ft.allSpecies,predicted_species:ft.species,confidence:ft.confidence,from_cache:!0,needs_prediction:!1}:Fe})),u){const Ae=Ke[u.file_name];Ae&&Ae.allSpecies&&Ae.allSpecies.length>0&&f(Fe=>Fe?{...Fe,species:Ae.allSpecies,species_count:Ae.allSpecies.length}:null)}});return()=>{console.log(" Cleaning up Firebase listener"),ji()}}catch(se){console.error(" Error loading folder:",se),S(se instanceof Error?se.message:"Unknown error"),a(!1)}})();return()=>{I.current&&(console.log(" [BatFolderDetailPage] Component unmounting - cancelling predictions"),I.current.abort()),he instanceof Promise&&he.then(se=>se&&se())}},[t,e,n]);const Xe=async(L,he=!1)=>{var se,ce;if(L){_(!0),f(null),T(null),I.current&&I.current.abort(),I.current=new AbortController;try{const Re=L.from_cache&&!he,Me=await fetch("https://bat-admin-backend.onrender.com/api/api/audio/predict",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_id:L.file_id,file_name:L.file_name,server_num:e,client_num:n,folder_timestamp:t,skip_prediction:Re}),signal:I.current.signal});if(Me.ok){const xe=await Me.json();if(console.log(" API Response for",L.file_name,":",{metadata:xe.metadata,call_parameters:xe.call_parameters,spectrogram_url:xe.spectrogram_url,audio_url:xe.audio_url}),Re&&((se=L.species)==null?void 0:se.length)>0&&(xe.species=L.species,xe.species_count=L.species.length),f(xe),!Re&&xe.success&&xe.species&&xe.species.length>0){const rt=L.file_name.match(/bat_(\d+)/i),$t=rt?rt[1]:L.file_name.replace(".wav",""),Ns=e!=null&&e.toLowerCase().startsWith("server")?e.toLowerCase():`server${e}`,An=n!=null&&n.toLowerCase().startsWith("client")?n.toLowerCase():`client${n}`;console.log(` [BatFolderDetailPage] Saving prediction to Firebase: ${Ns}/${An}/${t}/${$t}`);try{await Hf(Ns,An,$t,xe.species[0].species,xe.species[0].confidence,new Date().toISOString(),((ce=xe.call_parameters)==null?void 0:ce.peak_freq)||"",xe.species,t),console.log(` [BatFolderDetailPage] Saved prediction for ${L.file_name}`)}catch(Ke){console.error("[BatFolderDetailPage] Firebase save error:",Ke)}const ji={...L,species:xe.species,predicted_species:xe.species[0].species,confidence:xe.species[0].confidence,from_cache:!0,needs_prediction:!1,processing:!1};c(Ke=>Ke.map(Ae=>Ae.file_id===L.file_id?ji:Ae))}xe.audio_url&&T(xe.audio_url)}}catch(Re){if(Re instanceof Error&&Re.name==="AbortError"){console.log(" [BatFolderDetailPage] Fetch cancelled");return}console.error("Error fetching details:",Re)}finally{_(!1)}}},xt=L=>{d(L),Xe(L,!1)},je=()=>{u&&Xe(u,!0)},le=L=>{if(!L)return"-";const he=L/1024;return he>=1024?`${(he/1024).toFixed(1)} MB`:`${he.toFixed(1)} KB`};if(i)return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx(Vn,{}),o.jsx("div",{className:"flex items-center justify-center h-screen",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Ye,{className:"w-8 h-8 animate-spin mx-auto mb-2 text-blue-600"}),o.jsx("p",{className:"text-sm text-gray-600",children:m||"Loading..."})]})})]});if(v)return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx(Vn,{}),o.jsx("div",{className:"flex items-center justify-center h-screen",children:o.jsxs("div",{className:"text-center bg-white p-6 rounded-lg shadow-md",children:[o.jsxs("p",{className:"text-red-500 mb-3",children:[" ",v]}),o.jsx("button",{onClick:()=>r(-1),className:"px-4 py-1.5 bg-blue-600 text-white rounded text-sm",children:"Go Back"})]})})]});const W=(h==null?void 0:h.metadata)||{},q=(h==null?void 0:h.call_parameters)||{};return o.jsxs("div",{className:"h-screen bg-gray-100 text-xs overflow-hidden",children:[o.jsx(Vn,{}),o.jsxs("main",{className:`transition-all duration-300 ${s?"ml-64":"ml-20"} p-2 h-full overflow-hidden`,children:[o.jsx("div",{className:"mb-2 bg-white rounded px-3 py-2 border border-gray-200 flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("button",{onClick:()=>r(-1),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[o.jsx(ii,{className:"w-3 h-3"}),o.jsx("span",{children:"Back"})]}),o.jsx("span",{className:"text-gray-400",children:"|"}),o.jsx("span",{className:"font-semibold text-gray-800",children:g}),o.jsxs("span",{className:"text-gray-500",children:["(",l.length," files)"]})]})}),o.jsxs("div",{ref:H,className:"flex gap-0 h-full",style:{height:"calc(100vh - 80px)"},children:[o.jsxs("div",{className:"bg-white rounded border border-gray-200 overflow-hidden flex flex-col h-full",style:{width:`${G}%`,minWidth:"150px"},children:[o.jsxs("div",{className:"bg-gray-50 px-3 py-2 border-b border-gray-200 font-semibold text-gray-700 text-sm flex items-center justify-between h-10 flex-shrink-0",children:[o.jsx("span",{children:"Recordings"}),o.jsx("span",{className:"text-gray-400 font-normal text-xs",children:l.length})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:l.map(L=>o.jsxs("div",{onClick:()=>xt(L),className:`px-2 py-1.5 border-b border-gray-100 cursor-pointer transition ${(u==null?void 0:u.file_id)===L.file_id?"bg-blue-50 border-l-2 border-l-blue-500":"hover:bg-gray-50 border-l-2 border-l-transparent"}`,children:[o.jsxs("div",{className:"flex items-center justify-between gap-1.5 mb-1",children:[o.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[o.jsx(wd,{className:"w-3 h-3 text-blue-500 flex-shrink-0"}),o.jsx("span",{className:"font-medium text-gray-800 truncate",children:L.file_name})]}),o.jsx("button",{onClick:he=>{he.stopPropagation(),Xe(L)},className:"p-0.5 rounded hover:bg-gray-200 text-gray-500 transition flex-shrink-0",title:"Re-predict",children:o.jsx(Cl,{className:"w-3 h-3"})})]}),o.jsxs("div",{className:"text-[10px] text-gray-500 flex flex-wrap gap-x-2 gap-y-0.5 ml-4 mb-1",children:[o.jsxs("span",{children:["Size: ",le(L.size)]}),L.confidence>0&&o.jsxs("span",{className:L.confidence>=80?"text-green-600 font-medium":L.confidence>=50?"text-yellow-600":"text-red-500",children:["Conf: ",L.confidence.toFixed(0),"%"]}),L.from_cache&&o.jsx("span",{className:"text-emerald-600",children:""})]}),L.species&&L.species.length>0?o.jsx("div",{className:"flex flex-wrap gap-0.5 ml-4",children:L.species.map((he,se)=>{var ce,Re;return o.jsxs("span",{className:`px-1 py-0 rounded text-[9px] font-medium ${se===0?"bg-green-100 text-green-700":se===1?"bg-blue-100 text-blue-700":se===2?"bg-purple-100 text-purple-700":se===3?"bg-orange-100 text-orange-700":"bg-pink-100 text-pink-700"}`,children:[(ce=he.species)==null?void 0:ce.replace(/_/g," ")," (",(Re=he.confidence)==null?void 0:Re.toFixed(0),"%)"]},se)})}):L.predicted_species==="Processing"?o.jsxs("div",{className:"text-[9px] text-blue-600 ml-4 flex items-center gap-1",children:[o.jsx(Ye,{className:"w-2 h-2 animate-spin"}),"Processing..."]}):L.predicted_species==="Waiting"?o.jsx("div",{className:"text-[9px] text-yellow-600 ml-4",children:"Waiting..."}):o.jsx("div",{className:"text-[9px] text-gray-400 ml-4",children:"No species detected"})]},L.file_id))})]}),o.jsx("div",{className:`w-2 flex-shrink-0 cursor-col-resize flex items-center justify-center group hover:bg-blue-100 transition-colors ${Q==="left"?"bg-blue-200":"bg-gray-200"}`,onMouseDown:()=>pe("left"),children:o.jsx("div",{className:"w-1 h-16 bg-gray-400 rounded group-hover:bg-blue-500 transition-colors flex items-center justify-center",children:o.jsx(hm,{className:"w-3 h-3 text-gray-600 group-hover:text-blue-700"})})}),o.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden h-full",style:{width:`${ne}%`,minWidth:"200px"},children:[o.jsxs("div",{className:"bg-white rounded border border-gray-200 flex-1 flex flex-col overflow-hidden min-h-0",children:[o.jsxs("div",{className:"bg-gray-50 px-3 py-2 border-b border-gray-200 font-semibold text-gray-700 text-sm flex items-center justify-between h-10 flex-shrink-0",children:[o.jsx("span",{children:"Spectrogram & Audio"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>fe(L=>Math.max(.5,L-.25)),className:"p-1 hover:bg-gray-200 rounded transition-colors",title:"Zoom Out",children:o.jsx(lS,{className:"w-3 h-3 text-gray-600"})}),o.jsxs("span",{className:"text-[10px] text-gray-500 min-w-[40px] text-center",children:[Math.round(M*100),"%"]}),o.jsx("button",{onClick:()=>fe(L=>Math.min(3,L+.25)),className:"p-1 hover:bg-gray-200 rounded transition-colors",title:"Zoom In",children:o.jsx(aS,{className:"w-3 h-3 text-gray-600"})}),o.jsx("button",{onClick:()=>fe(1),className:"p-1 hover:bg-gray-200 rounded transition-colors ml-1",title:"Reset Zoom",children:o.jsx(bl,{className:"w-3 h-3 text-gray-600"})})]})]}),o.jsx("div",{className:"flex-1 bg-gray-900 flex items-center justify-center p-2 overflow-auto min-h-0",children:y?o.jsx(Ye,{className:"w-6 h-6 animate-spin text-cyan-400"}):h!=null&&h.spectrogram_url?o.jsx("img",{src:h.spectrogram_url,alt:"Spectrogram",className:"object-contain transition-all duration-200 w-full h-full",style:{transform:`scale(${M})`,transformOrigin:"center center",maxWidth:M>1?"none":"100%",maxHeight:M>1?"none":"100%",filter:`brightness(${D}%) contrast(${O}%) saturate(${$}%)`},onError:L=>{console.error("Spectrogram load error:",h.spectrogram_url),L.target.style.display="none"}}):o.jsxs("div",{className:"text-gray-500 text-center",children:[o.jsx("p",{children:"No spectrogram"}),o.jsx("p",{className:"text-[10px] mt-1",children:"Select a recording to view"})]})}),o.jsxs("div",{className:"bg-gray-800 px-3 py-1.5 flex-shrink-0 space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-400",children:[o.jsx("span",{className:"w-14",children:"Bright"}),o.jsx("input",{type:"range",min:"50",max:"200",value:D,onChange:L=>jt(Number(L.target.value)),className:"flex-1 h-1 accent-emerald-500"}),o.jsxs("span",{className:"w-10 text-right",children:[D,"%"]})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-400",children:[o.jsx("span",{className:"w-14",children:"Contrast"}),o.jsx("input",{type:"range",min:"50",max:"200",value:O,onChange:L=>U(Number(L.target.value)),className:"flex-1 h-1 accent-emerald-500"}),o.jsxs("span",{className:"w-10 text-right",children:[O,"%"]})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-400",children:[o.jsx("span",{className:"w-14",children:"Saturate"}),o.jsx("input",{type:"range",min:"0",max:"200",value:$,onChange:L=>Ne(Number(L.target.value)),className:"flex-1 h-1 accent-emerald-500"}),o.jsxs("span",{className:"w-10 text-right",children:[$,"%"]})]})]})]}),o.jsxs("div",{className:"bg-white rounded border border-gray-200 px-3 py-2 flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("span",{className:"font-semibold text-gray-600 text-[11px]",children:"Audio Player"}),o.jsx("button",{onClick:je,disabled:y||!u,className:"p-1 rounded hover:bg-gray-200 text-gray-500 transition",title:"Re-predict",children:o.jsx(Cl,{className:`w-3 h-3 ${y?"animate-spin":""}`})})]}),o.jsx("div",{className:"text-[10px] text-gray-500 mb-1 truncate",children:(u==null?void 0:u.file_name)||"No file selected"}),k?o.jsx("audio",{ref:R,src:k,controls:!0,className:"w-full h-8"}):o.jsx("div",{className:"text-center text-gray-400 text-[10px] py-2 bg-gray-50 rounded",children:u?"Loading audio...":"No audio selected"})]})]}),o.jsx("div",{className:`w-2 flex-shrink-0 cursor-col-resize flex items-center justify-center group hover:bg-blue-100 transition-colors ${Q==="right"?"bg-blue-200":"bg-gray-200"}`,onMouseDown:()=>pe("right"),children:o.jsx("div",{className:"w-1 h-16 bg-gray-400 rounded group-hover:bg-blue-500 transition-colors flex items-center justify-center",children:o.jsx(hm,{className:"w-3 h-3 text-gray-600 group-hover:text-blue-700"})})}),o.jsxs("div",{className:"bg-white rounded border border-gray-200 overflow-hidden flex flex-col h-full",style:{width:`${K}%`,minWidth:"180px"},children:[o.jsx("div",{className:"bg-gray-50 px-3 py-2 border-b border-gray-200 font-semibold text-gray-700 text-sm h-10 flex items-center flex-shrink-0",children:"Details"}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:y?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx(Ye,{className:"w-5 h-5 animate-spin text-blue-500"})}):u?o.jsxs("div",{className:"divide-y divide-gray-200",children:[o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>Oe("species"),className:"w-full flex items-center justify-between px-2 py-1.5 hover:bg-gray-50 transition",children:[o.jsx("span",{className:"font-medium text-gray-700 text-[11px]",children:"Species"}),o.jsx(Yt,{className:`w-3 h-3 text-gray-500 transition-transform ${N.species?"rotate-180":""}`})]}),N.species&&o.jsx("div",{className:"px-2 pb-2 space-y-1",children:h!=null&&h.species&&h.species.length>0?h.species.map((L,he)=>{var se,ce;return o.jsxs("div",{className:`flex justify-between items-center p-1.5 rounded ${he===0?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-100"}`,children:[o.jsxs("span",{className:`font-medium text-[10px] ${he===0?"text-green-700":"text-gray-700"}`,children:[he+1,". ",(se=L.species)==null?void 0:se.replace(/_/g," ")]}),o.jsxs("span",{className:`font-bold text-[10px] ${L.confidence>=80?"text-green-600":L.confidence>=50?"text-yellow-600":"text-red-500"}`,children:[(ce=L.confidence)==null?void 0:ce.toFixed(1),"%"]})]},he)}):u.species&&u.species.length>0?u.species.map((L,he)=>{var se,ce;return o.jsxs("div",{className:`flex justify-between items-center p-1.5 rounded ${he===0?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-100"}`,children:[o.jsxs("span",{className:`font-medium text-[10px] ${he===0?"text-green-700":"text-gray-700"}`,children:[he+1,". ",(se=L.species)==null?void 0:se.replace(/_/g," ")]}),o.jsxs("span",{className:`font-bold text-[10px] ${L.confidence>=80?"text-green-600":L.confidence>=50?"text-yellow-600":"text-red-500"}`,children:[(ce=L.confidence)==null?void 0:ce.toFixed(1),"%"]})]},he)}):o.jsx("div",{className:"text-gray-400 text-center py-2 text-[10px]",children:"No species detected"})})]}),o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>Oe("metadata"),className:"w-full flex items-center justify-between px-2 py-1.5 hover:bg-gray-50 transition",children:[o.jsx("span",{className:"font-medium text-gray-700 text-[11px]",children:"Metadata"}),o.jsx(Yt,{className:`w-3 h-3 text-gray-500 transition-transform ${N.metadata?"rotate-180":""}`})]}),N.metadata&&o.jsxs("div",{className:"px-2 pb-2 space-y-0.5 text-[10px]",children:[W.timestamp&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Time"}),o.jsx("span",{className:"text-gray-700",children:W.timestamp})]}),W.latitude&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Lat"}),o.jsx("span",{className:"text-gray-700",children:W.latitude})]}),W.longitude&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Long"}),o.jsx("span",{className:"text-gray-700",children:W.longitude})]}),W.length&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Length"}),o.jsx("span",{className:"text-gray-700",children:W.length})]}),W.sample_rate&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Sample Rate"}),o.jsx("span",{className:"text-gray-700",children:W.sample_rate})]}),W.temperature&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Temp"}),o.jsx("span",{className:"text-gray-700",children:W.temperature})]}),W.humidity&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Humidity"}),o.jsx("span",{className:"text-gray-700",children:W.humidity})]}),W.make&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Make"}),o.jsx("span",{className:"text-gray-700",children:W.make})]}),W.model&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Model"}),o.jsx("span",{className:"text-gray-700",children:W.model})]}),W.filter_hp&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"HP Filter"}),o.jsx("span",{className:"text-gray-700",children:W.filter_hp})]}),W.filter_lp&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"LP Filter"}),o.jsx("span",{className:"text-gray-700",children:W.filter_lp})]}),W.note&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Note"}),o.jsx("span",{className:"text-gray-700 text-right max-w-[60%]",children:W.note})]}),Object.keys(W).length===0&&o.jsx("div",{className:"text-gray-400 text-center py-2",children:"No metadata available"})]})]}),o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>Oe("call_params"),className:"w-full flex items-center justify-between px-2 py-1.5 hover:bg-gray-50 transition",children:[o.jsx("span",{className:"font-medium text-gray-700 text-[11px]",children:"Call Parameters"}),o.jsx(Yt,{className:`w-3 h-3 text-gray-500 transition-transform ${N.call_params?"rotate-180":""}`})]}),N.call_params&&o.jsxs("div",{className:"px-2 pb-2 space-y-0.5 text-[10px]",children:[q.start_frequency&&q.start_frequency>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Start Freq"}),o.jsxs("span",{className:"text-blue-600",children:[q.start_frequency.toFixed(2)," kHz"]})]}),q.end_frequency&&q.end_frequency>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"End Freq"}),o.jsxs("span",{className:"text-blue-600",children:[q.end_frequency.toFixed(2)," kHz"]})]}),q.minimum_frequency&&q.minimum_frequency>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Min Freq"}),o.jsxs("span",{className:"text-blue-600",children:[q.minimum_frequency.toFixed(2)," kHz"]})]}),q.maximum_frequency&&q.maximum_frequency>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Max Freq"}),o.jsxs("span",{className:"text-blue-600",children:[q.maximum_frequency.toFixed(2)," kHz"]})]}),q.peak_frequency&&q.peak_frequency>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Peak Freq"}),o.jsxs("span",{className:"text-blue-600",children:[q.peak_frequency.toFixed(2)," kHz"]})]}),q.bandwidth&&q.bandwidth>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Bandwidth"}),o.jsxs("span",{className:"text-blue-600",children:[q.bandwidth.toFixed(2)," kHz"]})]}),(q.call_length||q.pulse_duration)&&(q.call_length>0||q.pulse_duration>0)&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Call Length"}),o.jsxs("span",{className:"text-blue-600",children:[(q.call_length||q.pulse_duration).toFixed(2)," ms"]})]}),q.call_distance&&q.call_distance>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Call Dist"}),o.jsxs("span",{className:"text-blue-600",children:[q.call_distance.toFixed(2)," ms"]})]}),q.pulse_count&&q.pulse_count>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Pulses"}),o.jsx("span",{className:"text-blue-600",children:q.pulse_count})]}),q.intensity&&q.intensity!==0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Intensity"}),o.jsxs("span",{className:"text-blue-600",children:[q.intensity.toFixed(2)," dB"]})]}),(q.sonotype||q.shape)&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Sonotype"}),o.jsx("span",{className:"text-blue-600",children:q.sonotype||q.shape})]}),(q.frequency_modulation_rate||q.fm_rate)&&(q.frequency_modulation_rate>0||q.fm_rate>0)&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"FM Rate"}),o.jsxs("span",{className:"text-blue-600",children:[(q.frequency_modulation_rate||q.fm_rate).toFixed(2)," kHz/ms"]})]}),q.characteristic_frequency&&q.characteristic_frequency>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Char Freq"}),o.jsxs("span",{className:"text-blue-600",children:[q.characteristic_frequency.toFixed(2)," kHz"]})]}),q.knee_frequency&&q.knee_frequency>0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Knee Freq"}),o.jsxs("span",{className:"text-blue-600",children:[q.knee_frequency.toFixed(2)," kHz"]})]}),q.slope&&q.slope!==0&&o.jsxs("div",{className:"flex justify-between py-0.5",children:[o.jsx("span",{className:"text-gray-400",children:"Slope"}),o.jsx("span",{className:"text-blue-600",children:q.slope.toFixed(2)})]}),Object.keys(q).length===0&&o.jsx("div",{className:"text-gray-400 text-center py-2",children:"No call parameters"})]})]}),o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>Oe("map"),className:"w-full flex items-center justify-between px-2 py-1.5 hover:bg-gray-50 transition",children:[o.jsx("span",{className:"font-medium text-gray-700 text-[11px]",children:"Map"}),o.jsx(Yt,{className:`w-3 h-3 text-gray-500 transition-transform ${N.map?"rotate-180":""}`})]}),N.map&&o.jsx("div",{className:"px-2 pb-2",children:W.latitude&&W.longitude?o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"aspect-square bg-gray-100 rounded overflow-hidden border border-gray-200",children:o.jsx("iframe",{width:"100%",height:"100%",frameBorder:"0",style:{border:0},src:`https://www.openstreetmap.org/export/embed.html?bbox=${parseFloat(W.longitude)-.01},${parseFloat(W.latitude)-.01},${parseFloat(W.longitude)+.01},${parseFloat(W.latitude)+.01}&layer=mapnik&marker=${W.latitude},${W.longitude}`,allowFullScreen:!0})}),o.jsxs("div",{className:"text-[10px] space-y-0.5",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-400",children:"Lat"}),o.jsx("span",{className:"font-medium",children:W.latitude})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-400",children:"Long"}),o.jsx("span",{className:"font-medium",children:W.longitude})]})]})]}):o.jsxs("div",{className:"text-center text-gray-400 py-4",children:[o.jsx(qh,{className:"w-6 h-6 mx-auto mb-1 opacity-30"}),o.jsx("p",{className:"text-[10px]",children:"No GPS coordinates"})]})})]})]}):o.jsxs("div",{className:"text-center text-gray-400 py-4 px-2",children:[o.jsx(wd,{className:"w-6 h-6 mx-auto mb-1 opacity-30"}),o.jsx("p",{className:"text-[10px]",children:"Select a recording to view details"})]})})]})]})]})]})};function fP(){const t=nn(),e=Br(),{isExpanded:n}=ws(),r=t.state;console.log(" DataHistoryFullPage loaded"),console.log(" Location state:",r),console.log(" Full location:",t);const[s,i]=x.useState([]),[a,l]=x.useState(!0),[c,u]=x.useState(""),[d,h]=x.useState({});x.useEffect(()=>{window.scrollTo(0,0)},[]),x.useEffect(()=>{if(console.log(" useEffect triggered, state:",r),!r){console.warn(" No state found, redirecting to home"),e("/");return}if(console.log(" State exists, loading folders..."),f(),r.serverId&&r.clientId){const g=r.serverName.replace("Server ",""),p=r.clientName.replace("Client ","");console.log(" Setting up Firebase prediction listener...");const m=ia(`server${g}`,`client${p}`,w=>{console.log(" Received Firebase prediction update:",Object.keys(w).length,"predictions"),h(N=>{const C={...N};return Object.keys(C).forEach(k=>{var T;C[k].audioFiles&&(C[k]={...C[k],audioFiles:(T=C[k].audioFiles)==null?void 0:T.map(R=>{var G;const I=w[R.file_name];return I?{...R,top_species:I.allSpecies||[],species_count:((G=I.allSpecies)==null?void 0:G.length)||0,predicted_species:I.species,confidence:I.confidence,from_cache:!0}:R})})}),C})});return()=>{console.log(" Cleaning up Firebase listener"),m()}}},[r,e]);const f=async()=>{var g;if(r)try{l(!0);const p=r.serverName.replace("Server ",""),m=r.clientName.replace("Client ",""),w=`https://bat-admin-backend.onrender.com/api/api/folders/${p}/${m}`;console.log(" Fetching folders from:",w),console.log(" Request params:",{serverNum:p,clientNum:m,serverName:r.serverName,clientName:r.clientName});const N=await fetch(w);if(console.log(" Response status:",N.status,N.ok),!N.ok){const k=await N.text();throw console.error(" API Error:",k),new Error("Failed to fetch folders")}const C=await N.json();console.log(" Received data:",C),C.success?(console.log(" Setting folders:",((g=C.folders)==null?void 0:g.length)||0,"folders"),i(C.folders||[])):console.warn(" API returned success=false")}catch(p){console.error("Error loading folders:",p),i([])}finally{l(!1)}},y=async g=>{const p=s.find(w=>w.folder_id===g);if(!p)return;const m=d[g];if(m!=null&&m.isExpanded){h(w=>({...w,[g]:{...w[g],isExpanded:!1}}));return}if(m!=null&&m.audioFiles){h(w=>({...w,[g]:{...w[g],isExpanded:!0}}));return}h(w=>({...w,[g]:{isExpanded:!0,isLoading:!0}}));try{const w=r.serverName.replace("Server ",""),N=r.clientName.replace("Client ","");console.log(` Loading predictions from Firebase for ${p.timestamp}...`);const C=await Wf(`server${w}`,`client${N}`,p.timestamp),k=Object.keys(C).length;console.log(` Found ${k} cached predictions in Firebase`);const R=await fetch("https://bat-admin-backend.onrender.com/api/api/folder/files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_num:w,client_num:N,folder_timestamp:p.timestamp})});if(!R.ok)throw new Error(`Failed to list files: ${R.status}`);const I=await R.json();if(I.success&&I.files&&I.files.length>0){let G=!1;const re=I.files.map(ne=>{const ge=C[ne.file_name];return ge&&ge.allSpecies&&ge.allSpecies.length>0?{file_id:ne.file_id,file_name:ne.file_name,top_species:ge.allSpecies,species_count:ge.allSpecies.length,predicted_species:ge.species,confidence:ge.confidence,from_cache:!0}:G?{file_id:ne.file_id,file_name:ne.file_name,top_species:[],species_count:0,predicted_species:"Waiting",confidence:0,from_cache:!1}:(G=!0,{file_id:ne.file_id,file_name:ne.file_name,top_species:[],species_count:0,predicted_species:"Processing",confidence:0,from_cache:!1})});h(ne=>({...ne,[g]:{isExpanded:!0,isLoading:!1,audioFiles:re}}))}else h(G=>({...G,[g]:{isExpanded:!1,isLoading:!1}}))}catch(w){console.error("Error processing folder:",w),h(N=>({...N,[g]:{isExpanded:!1,isLoading:!1}}))}},_=g=>{var w;const p=((w=g.top_species)==null?void 0:w.slice(0,5))||[],m=(g.species_count||0)-5;return o.jsxs("div",{className:"flex flex-wrap gap-2",children:[p.map((N,C)=>o.jsxs("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-xs font-semibold",children:[N.species," ",N.confidence.toFixed(1),"%"]},C)),m>0&&o.jsxs("span",{className:"w-8 h-8 bg-emerald-600 text-white rounded-full flex items-center justify-center text-xs font-bold",children:["+",m]})]})},v=()=>{const g=s.map(p=>{const m=d[p.folder_id];return{folder_id:p.folder_id,name:p.name,timestamp:p.timestamp,date:p.date,time:p.time,audioFiles:(m==null?void 0:m.audioFiles)||[],isLoading:(m==null?void 0:m.isLoading)||!1}});e("/data-history-maximize",{state:{folders:g,clientName:r==null?void 0:r.clientName,serverName:r==null?void 0:r.serverName,serverId:r==null?void 0:r.serverId,clientId:r==null?void 0:r.clientId}})};if(!r)return null;const S=s.filter(g=>{const p=c.toLowerCase();return g.name.toLowerCase().includes(p)||g.date.includes(p)||g.time.includes(p)});return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50/80 to-blue-50/30",children:[o.jsx(Vn,{}),o.jsxs("main",{className:`transition-all duration-300 ${n?"ml-64":"ml-16"} p-8`,children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-emerald-700 hover:text-emerald-800 mb-4 transition",children:[o.jsx(ii,{className:"w-5 h-5"}),"Back to Dashboard"]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:[r.serverName," - ",r.clientName," - Recording Folders"]}),o.jsxs("p",{className:"text-gray-600 mt-2",children:[s.length," folder",s.length!==1?"s":""," found"]})]}),o.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition font-semibold",children:[o.jsx(bl,{className:"w-5 h-5"}),"Maximize View"]})]})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"relative",children:[o.jsx(nx,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:"text",placeholder:"Search folders by name, date...",value:c,onChange:g=>u(g.target.value),className:"w-full pl-12 pr-4 py-3 bg-white border-2 border-gray-200 rounded-xl focus:border-emerald-500 focus:outline-none"})]})}),a&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Ye,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-emerald-600"}),o.jsx("p",{className:"text-gray-600",children:"Loading folders..."})]}),!a&&o.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Folder Name"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Date"}),o.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Time"}),o.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:S.map(g=>{const p=d[g.folder_id],m=(p==null?void 0:p.isExpanded)||!1,w=(p==null?void 0:p.isLoading)||!1,N=(p==null?void 0:p.audioFiles)||[];return o.jsxs(o.Fragment,{children:[o.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"font-medium text-gray-900",children:g.name})}),o.jsx("td",{className:"px-6 py-4 text-gray-600",children:g.date}),o.jsx("td",{className:"px-6 py-4 text-gray-600",children:g.time}),o.jsx("td",{className:"px-6 py-4 text-center",children:o.jsx("button",{onClick:()=>y(g.folder_id),disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 disabled:bg-gray-400 text-white rounded-lg font-semibold transition",children:w?o.jsxs(o.Fragment,{children:[o.jsx(Ye,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):m?o.jsxs(o.Fragment,{children:[o.jsx(Vh,{className:"w-4 h-4"}),"Hide Calls"]}):o.jsxs(o.Fragment,{children:[o.jsx(Yt,{className:"w-4 h-4"}),"Show Calls"]})})})]},g.folder_id),m&&o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-6 py-0 bg-gray-50",children:o.jsx("div",{className:"py-4",children:w?o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx(Ye,{className:"w-8 h-8 animate-spin text-emerald-600 mr-3"}),o.jsx("span",{className:"text-gray-600",children:"Loading audio files..."})]}):N.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"No audio files found in this folder"}):o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-100",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Audio File"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Top 3 Species"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Peak Frequency"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Duration"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:N.map(C=>{var k;return o.jsxs("tr",{className:"hover:bg-white transition",children:[o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(wd,{className:"w-4 h-4 text-emerald-600"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:C.file_name})]})}),o.jsx("td",{className:"px-4 py-3",children:C.top_species&&C.top_species.length>0?_(C):C.predicted_species==="Processing"?o.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-semibold inline-flex items-center gap-1",children:[o.jsx(Ye,{className:"w-3 h-3 animate-spin"}),"Processing..."]}):C.predicted_species==="Waiting"?o.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-semibold",children:"Waiting..."}):o.jsx("span",{className:"text-xs text-gray-400",children:"No prediction"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"text-sm font-semibold text-emerald-600",children:(k=C.call_parameters)!=null&&k.peak_frequency?`${C.call_parameters.peak_frequency.toFixed(1)} kHz`:"N/A"})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("span",{className:"text-sm text-gray-700",children:[C.duration?C.duration.toFixed(2):"0.00","s"]})})]},C.file_id)})})]})})})})]})})})]}),S.length===0&&!a&&o.jsxs("div",{className:"text-center py-12 text-gray-500",children:["No folders found",c?" matching your search":""]})]})]})]})}const pP=()=>{const t=nn(),e=Br(),{isExpanded:n}=ws(),r=t.state;if(x.useEffect(()=>{window.scrollTo(0,0)},[]),x.useEffect(()=>{r!=null&&r.folders||e("/")},[r,e]),!(r!=null&&r.folders))return null;const{folders:s,clientName:i,serverName:a,serverId:l,clientId:c}=r;x.useEffect(()=>{console.log(" DataHistoryMaximizePage - All folders:",s.map((N,C)=>({id:N.id,folder_id:N.folder_id,ts:N.timestamp,name:N.name,idx:C})))},[s]),x.useEffect(()=>{console.log(" [DataHistoryMaximizePage] Setting up Firebase prediction listener...");const N=ia(l,c,C=>{console.log(" [DataHistoryMaximizePage] Received Firebase prediction update"),_(k=>{const T={...k};return Object.keys(T).forEach(R=>{T[R]=T[R].map(I=>{var re,ne;const G=C[I.file_name];return G&&G.allSpecies&&G.allSpecies.length>0?{...I,species:G.allSpecies,predicted_species:((re=G.allSpecies[0])==null?void 0:re.species)||"Unknown",confidence:((ne=G.allSpecies[0])==null?void 0:ne.confidence)||0,from_cache:!0,needs_prediction:!1}:I})}),T})});return()=>{console.log(" [DataHistoryMaximizePage] Cleaning up Firebase listener"),N()}},[l,c]),x.useEffect(()=>()=>{v.current&&(console.log(" [DataHistoryMaximizePage] Component unmounting - cancelling all predictions"),v.current.abort())},[]);const[u,d]=x.useState(null),[h,f]=x.useState(null),[y,_]=x.useState({}),v=x.useRef(null),S=(N,C)=>N.id||N.folder_id||N.timestamp||`${N.name}-${C??""}`,g=()=>e("/"),p=async(N,C,k=!1)=>{if(!k&&y[N]&&y[N].length>0){const T=y[N].some(I=>I.processing),R=y[N].some(I=>I.needs_prediction&&!I.processing);if(T){console.log(` [DataHistoryMaximizePage] Folder ${C} is being processed, skipping reload`);return}if(!R){console.log(` [DataHistoryMaximizePage] All files predicted for ${C}, using cache`);return}console.log(` [DataHistoryMaximizePage] Found ${y[N].filter(I=>I.needs_prediction).length} files still need prediction`)}try{console.log(` [DataHistoryMaximizePage] Loading folder: ${C} (forceRepredict: ${k})`);const{timestamp:T,entries:R,serverNum:I,clientNum:G}=await Lc({serverId:l,clientId:c,folderName:C});_(K=>({...K,[N]:R}));const re=R.filter(K=>K.from_cache).length,ne=R.filter(K=>K.needs_prediction).length;console.log(` [DataHistoryMaximizePage] Loaded ${R.length} files: ${re} cached, ${ne} need prediction`);const ge=R.map((K,Le)=>({entry:K,index:Le})).filter(({entry:K})=>K.needs_prediction);if(ge.length>0){console.log(` [DataHistoryMaximizePage] Starting SEQUENTIAL predictions for ${ge.length} files`),v.current=new AbortController;const K=v.current.signal;(async()=>{for(const{entry:Le,index:Q}of ge){if(K.aborted){console.log(` [DataHistoryMaximizePage] Predictions cancelled - stopping at ${Le.file_name}`);break}try{console.log(` [DataHistoryMaximizePage] Predicting ${Q+1}/${ge.length}: ${Le.file_name}`),_(H=>{const M=[...H[N]||[]];return M[Q]&&(M[Q]={...M[Q],processing:!0,predicted_species:"Processing..."}),{...H,[N]:M}});const E=await $o({serverId:l,clientId:c,serverNum:I,clientNum:G,timestamp:T,audio:Le,signal:K});_(H=>{const M=[...H[N]||[]];return M[Q]&&(M[Q]=E),{...H,[N]:M}}),console.log(` [DataHistoryMaximizePage] Completed ${Q+1}/${ge.length}: ${Le.file_name}`)}catch(E){if(E instanceof Error&&E.name==="AbortError"){console.log(` [DataHistoryMaximizePage] Prediction cancelled for ${Le.file_name}`);break}console.error("[DataHistoryMaximizePage] Prediction error:",E),_(H=>{const M=[...H[N]||[]];return M[Q]&&(M[Q]={...M[Q],processing:!1,predicted_species:"Error",error:E instanceof Error?E.message:"Unknown error"}),{...H,[N]:M}})}}console.log(` [DataHistoryMaximizePage] All predictions completed for ${C}`)})()}}catch(T){console.error(" Error loading folder:",T),_(R=>({...R,[N]:[]}))}},m=async N=>{const C=S(N);if(console.log(" Toggle clicked:",{clickedId:C,clickedName:N.name,currentExpandedId:u,willExpand:u!==C}),u===C)d(null),console.log(" Collapsed folder");else if(d(C),console.log(" Expanded folder:",C),!y[C]||y[C].length===0){f(C);try{await p(C,N.name)}finally{f(null)}}},w=async(N,C,k,T)=>{const I=C.toLowerCase().split("_").slice(2).join("_");_(G=>{const re=[...G[N]||[]];return re[k]&&(re[k]={...re[k],processing:!0,predicted_species:"Processing..."}),{...G,[N]:re}});try{const G=a.replace("Server ",""),re=i.replace("Client ",""),ne=await $o({serverId:l,clientId:c,serverNum:G,clientNum:re,timestamp:I,audio:T});_(ge=>{const K=[...ge[N]||[]];return K[k]&&(K[k]=ne),{...ge,[N]:K}})}catch(G){console.error("Error re-predicting:",G),_(re=>{const ne=[...re[N]||[]];return ne[k]&&(ne[k]={...ne[k],predicted_species:"Error",processing:!1}),{...re,[N]:ne}})}};return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50/80 to-blue-50/30 relative",children:[o.jsx(Vn,{}),o.jsx("div",{className:`bg-gradient-to-r from-emerald-700 via-teal-600 to-emerald-700 shadow-lg transition-all duration-300 ${n?"ml-64":"ml-16"}`,children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4 border-b border-emerald-600/20 h-16 flex items-center",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("button",{onClick:g,className:"p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors",children:o.jsx(ii,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-semibold text-white",children:"Data History - Full View"}),o.jsxs("p",{className:"text-sm text-emerald-100",children:[a," - ",i]})]})]})})}),o.jsx("div",{className:`max-w-7xl mx-auto px-4 py-8 transition-all duration-300 ${n?"ml-64":"ml-16"}`,children:o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto p-4",children:s.length===0?o.jsx("div",{className:"text-center py-4 text-xs text-gray-500",children:"No BAT recording folders found"}):o.jsxs("table",{className:"w-full text-xs border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-slate-100",children:[o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700 w-8"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Folder Name"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Date"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Time"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Files"}),o.jsx("th",{className:"border border-slate-300 px-2 py-1.5 text-left font-semibold text-slate-700",children:"Size"})]})}),o.jsx("tbody",{children:s.map((N,C)=>{var T;const k=S(N,C);return o.jsxs(Rg.Fragment,{children:[o.jsxs("tr",{className:"hover:bg-emerald-50 transition-colors",children:[o.jsx("td",{className:"border border-slate-300 px-1 py-1.5 text-center",children:o.jsx("button",{onClick:()=>m({...N,id:k}),className:"p-0.5 hover:bg-slate-200 rounded transition-colors",children:h===k?o.jsx(Ye,{className:"w-3 h-3 animate-spin text-emerald-600"}):u===k?o.jsx(Yt,{className:"w-3 h-3 text-slate-600"}):o.jsx(dr,{className:"w-3 h-3 text-slate-600"})})}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-blue-600 font-semibold hover:underline cursor-pointer",onClick:()=>e(`/folder/${a.replace("Server ","")}/${i.replace("Client ","")}/${N.timestamp}`,{state:{folderName:N.name,folderId:k}}),children:N.name}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700",children:N.date||"-"}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700",children:N.time||"-"}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700 text-center",children:N.fileCount||0}),o.jsx("td",{className:"border border-slate-300 px-2 py-1.5 text-slate-700",children:N.totalSize||"0 B"})]}),u===k&&o.jsx("tr",{children:o.jsx("td",{colSpan:6,className:"border border-slate-300 p-0 bg-slate-50",children:h===k?o.jsxs("div",{className:"text-center py-4 text-xs text-gray-500",children:[o.jsx(Ye,{className:"w-4 h-4 animate-spin mx-auto mb-1"}),"Loading bat calls..."]}):((T=y[k])==null?void 0:T.length)>0?o.jsx("div",{className:"p-2",children:o.jsxs("table",{className:"w-full text-xs border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-emerald-100",children:[o.jsx("th",{className:"border border-emerald-200 px-2 py-1 text-left font-semibold text-emerald-800",children:"Audio File"}),o.jsx("th",{className:"border border-emerald-200 px-2 py-1 text-left font-semibold text-emerald-800",children:"Top 5 Species"}),o.jsx("th",{className:"border border-emerald-200 px-2 py-1 text-center font-semibold text-emerald-800 w-16",children:"Action"})]})}),o.jsx("tbody",{children:y[k].map((R,I)=>o.jsxs("tr",{className:"hover:bg-emerald-50",children:[o.jsxs("td",{className:"border border-emerald-200 px-2 py-1 text-slate-700",children:[R.file_name,R.from_cache&&o.jsx("span",{className:"ml-1 text-[9px] text-gray-500",children:"(cached)"})]}),o.jsx("td",{className:"border border-emerald-200 px-2 py-1",children:o.jsx("div",{className:"flex flex-wrap gap-1",children:R.processing?o.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-yellow-100 text-yellow-800",children:[o.jsx(Ye,{className:"w-3 h-3 animate-spin mr-1"}),R.predicted_species||"Processing..."]}):R.species&&R.species.length>0?o.jsxs(o.Fragment,{children:[R.species.slice(0,5).map((G,re)=>o.jsxs("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium ${re===0?"bg-emerald-100 text-emerald-800":re===1?"bg-blue-100 text-blue-800":re===2?"bg-purple-100 text-purple-800":re===3?"bg-orange-100 text-orange-800":"bg-pink-100 text-pink-800"}`,children:[G.species," (",G.confidence,"%)"]},re)),R.species.length>5&&o.jsxs("span",{className:"inline-flex items-center justify-center w-5 h-5 bg-gray-200 text-gray-700 rounded-full text-[10px] font-bold",children:["+",R.species.length-5]})]}):R.predicted_species==="Error"?o.jsxs("span",{className:"text-red-500 italic text-[10px]",title:R.error,children:["Processing failed ",R.error&&"(hover for error)"]}):R.predicted_species==="Processing"?o.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-blue-100 text-blue-800",children:[o.jsx(Ye,{className:"w-3 h-3 animate-spin mr-1"}),"Processing..."]}):R.predicted_species==="Waiting"?o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-yellow-100 text-yellow-700",children:"Waiting..."}):o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-gray-100 text-gray-600",children:"Waiting..."})})}),o.jsx("td",{className:"border border-emerald-200 px-1 py-1 text-center",children:!R.processing&&o.jsx("button",{onClick:G=>{G.stopPropagation(),w(k,N.name,I,R)},className:"p-1 text-blue-600 hover:text-blue-800 rounded-full hover:bg-blue-50 transition-colors",title:"Re-predict species",children:o.jsx(Cl,{className:"w-3 h-3"})})})]},I))})]})}):o.jsx("div",{className:"text-center py-3 text-xs text-gray-500",children:"No audio files found in this folder"})})})]},k)})})]})})})})]})},mP=()=>{const t=nn(),e=Br(),{isExpanded:n}=ws(),r=t.state;if(x.useEffect(()=>{window.scrollTo(0,0)},[]),x.useEffect(()=>{r!=null&&r.data||e("/")},[r,e]),!(r!=null&&r.data))return null;const{data:s,clientName:i,serverName:a}=r,[l,c]=x.useState(""),[u,d]=x.useState({key:null,direction:"asc"}),h=()=>e("/"),f=g=>{let p="asc";u.key===g&&u.direction==="asc"&&(p="desc"),d({key:g,direction:p})},y=g=>{c(g)},v=[...s.filter(g=>{const p=l.toLowerCase();return g.scheduleKey.toLowerCase().includes(p)||g.date.toLowerCase().includes(p)||g.time.toLowerCase().includes(p)||g.duration.toString().includes(p)||g.status.toLowerCase().includes(p)})].sort((g,p)=>{if(!u.key)return 0;const m=g[u.key],w=p[u.key];return typeof m=="string"&&typeof w=="string"?u.direction==="asc"?m.localeCompare(w):w.localeCompare(m):typeof m=="number"&&typeof w=="number"?u.direction==="asc"?m-w:w-m:0}),S=v;return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50/80 to-blue-50/30 relative",children:[o.jsx(Vn,{}),o.jsx("div",{className:`bg-gradient-to-r from-emerald-700 via-teal-600 to-emerald-700 shadow-lg transition-all duration-300 ${n?"ml-64":"ml-16"}`,children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 border-b border-emerald-600/20 h-16 flex items-center",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("button",{onClick:h,className:"p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors",children:o.jsx(ii,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-semibold text-white",children:"Scheduled Recordings - Full View"}),o.jsxs("p",{className:"text-sm text-emerald-100",children:[a," - ",i]})]})]}),o.jsx("div",{className:"ml-auto"})]})}),o.jsx("div",{className:`max-w-7xl mx-auto px-4 py-8 transition-all duration-300 ${n?"ml-64":"ml-16"}`,children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-lg hover:border-emerald-300 transition-all duration-300 overflow-hidden",children:[o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx("input",{type:"text",placeholder:"Search Schedule ID, Date, Time, Status...",value:l,onChange:g=>y(g.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 pl-9"}),o.jsx(nx,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"})]}),o.jsxs("div",{className:"text-sm text-gray-600 whitespace-nowrap",children:[v.length," of ",s.length," records"]})]})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full table-fixed divide-y divide-gray-200",children:[o.jsxs("colgroup",{children:[o.jsx("col",{className:"w-[30%]"}),o.jsx("col",{className:"w-[25%]"}),o.jsx("col",{className:"w-[20%]"}),o.jsx("col",{className:"w-[15%]"}),o.jsx("col",{className:"w-[10%]"})]}),o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-1.5 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>f("scheduleKey"),children:o.jsxs("div",{className:"flex items-center gap-2",children:["Schedule ID",o.jsx(Fi,{className:"w-3 h-3"})]})}),o.jsx("th",{className:"px-3 py-1.5 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>f("date"),children:o.jsxs("div",{className:"flex items-center gap-2",children:["Date",o.jsx(Fi,{className:"w-3 h-3"})]})}),o.jsx("th",{className:"px-3 py-1.5 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>f("time"),children:o.jsxs("div",{className:"flex items-center gap-2",children:["Time",o.jsx(Fi,{className:"w-3 h-3"})]})}),o.jsx("th",{className:"px-3 py-1.5 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>f("duration"),children:o.jsxs("div",{className:"flex items-center gap-2",children:["Duration",o.jsx(Fi,{className:"w-3 h-3"})]})}),o.jsx("th",{className:"px-3 py-1.5 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>f("status"),children:o.jsxs("div",{className:"flex items-center gap-2",children:["Status",o.jsx(Fi,{className:"w-3 h-3"})]})})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-3 py-8 text-center text-sm text-gray-500",children:"No scheduled recordings found"})}):S.map((g,p)=>o.jsxs("tr",{className:"hover:bg-emerald-50/40 transition-colors duration-200",children:[o.jsx("td",{className:"px-3 py-1 whitespace-nowrap text-xs font-medium text-blue-600",children:g.scheduleKey}),o.jsx("td",{className:"px-3 py-1 whitespace-nowrap text-xs text-gray-700",children:g.date}),o.jsx("td",{className:"px-3 py-1 whitespace-nowrap text-xs text-gray-700",children:g.time}),o.jsxs("td",{className:"px-3 py-1 whitespace-nowrap text-xs text-gray-700",children:[g.duration,"min"]}),o.jsx("td",{className:"px-3 py-1 whitespace-nowrap text-xs",children:o.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-[10px] font-medium ${g.status==="scheduled"?"bg-yellow-100 text-yellow-700":g.status==="recording"?"bg-blue-100 text-blue-700":g.status==="ready_to_transmit"?"bg-green-100 text-green-700":g.status==="transmitting"?"bg-orange-100 text-orange-700":g.status==="completed"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:g.status})})]},`${g.scheduleKey}-${p}`))})]})}),o.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-200 flex justify-end",children:o.jsxs("button",{onClick:()=>{const p=[["Schedule ID","Date","Time","Duration (min)","Status"].join(",")];S.forEach(T=>{const I=[`"${T.scheduleKey.replace(/"/g,'""')}"`,T.date,T.time,T.duration,T.status];p.push(I.join(","))});const w="\uFEFF"+p.join(`
`),N=new Blob([w],{type:"text/csv;charset=utf-8;"}),C=document.createElement("a"),k=URL.createObjectURL(N);C.setAttribute("href",k),C.setAttribute("download",`scheduled_recordings_${a.replace(/\s+/g,"_")}_${i.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.csv`),C.style.visibility="hidden",document.body.appendChild(C),C.click(),document.body.removeChild(C)},className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm font-medium",children:[o.jsx(Gi,{className:"w-4 h-4"}),"Export to Excel"]})})]})})]})},gP=()=>{const t=nn();return console.log(" Route changed to:",t.pathname,t),null};Oy(document.getElementById("root")).render(o.jsx(x.StrictMode,{children:o.jsx(aP,{children:o.jsxs(Ob,{children:[o.jsx(gP,{}),o.jsx(Vn,{}),o.jsxs(fb,{children:[o.jsx(Qr,{path:"/",element:o.jsx(lP,{})}),o.jsx(Qr,{path:"/bat/:serverNum/:clientNum/:batId",element:o.jsx(dP,{})}),o.jsx(Qr,{path:"/folder/:serverNum/:clientNum/:folderTimestamp",element:o.jsx(hP,{})}),o.jsx(Qr,{path:"/data-history-full",element:o.jsx(fP,{})}),o.jsx(Qr,{path:"/data-history-maximize",element:o.jsx(pP,{})}),o.jsx(Qr,{path:"/scheduled-recordings-full",element:o.jsx(mP,{})})]})]})})}));
